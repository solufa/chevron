(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[610],{9636:function(t,e,r){"use strict";r.d(e,{Z:function(){return sl}});var n=r(7294),i=r(4720),o=r.n(i);let s=1,a=1;class u{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:r=Number.POSITIVE_INFINITY,rate:n=1,repeat:i=1}=t,o=s++,a={time:0,delay:e,duration:r,rate:n,repeat:i};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(t){this.channels.delete(t);for(const[e,r]of this.animations)r.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const n of e)this._setChannelTime(n,this.time);const r=this.animations.values();for(const n of r){const{animation:t,channel:e}=n;t.setTime(this.getTime(e))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const r=a++;return this.animations.set(r,{animation:t,channel:e}),t.setTime(this.getTime(e)),r}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const r=e-t.delay;r>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,r)%t.duration,t.time*=t.rate)}}const c="Awaiting state",l="Matched. State transferred from previous layer",h="Initialized",f="Discarded. Awaiting garbage collection",d="No longer matched. Awaiting garbage collection",p="Finalized! Awaiting garbage collection",g={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")};var m=r(4942),y=r(4155);function v(t){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof y&&"object"===typeof y.versions&&Boolean(y.versions.electron))return!0;const e="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,r=t||e;return!!(r&&r.indexOf("Electron")>=0)}var b=r(4155);function _(){return!("object"===typeof b&&"[object process]"===String(b)&&!1)||v()}const w="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source";_();class x{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";(0,m.Z)(this,"storage",void 0),(0,m.Z)(this,"id",void 0),(0,m.Z)(this,"config",{}),this.storage=function(t){try{const e=window[t],r="__storage_test__";return e.setItem(r,r),e.removeItem(r),e}catch(e){return null}}(r),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function E(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>n&&(r=Math.min(r,n/t.width));const o=t.width*r,s=t.height*r,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let P;function M(t){return"string"===typeof t?P[t.toUpperCase()]||P.WHITE:t}function S(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(P||(P={}));var O=r(4155);const A={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof r.g&&r.g,document:"undefined"!==typeof document&&document,process:"object"===typeof O&&O},T=globalThis,k=A.window||A.self||A.global,C=A.process||{};console;function j(){let t;var e,r;if(_&&"performance"in k)t=null===k||void 0===k||null===(e=k.performance)||void 0===e||null===(r=e.now)||void 0===r?void 0:r.call(e);else if("hrtime"in C){var n;const e=null===C||void 0===C||null===(n=C.hrtime)||void 0===n?void 0:n.call(C);t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const I={debug:_&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},R={enabled:!0,level:0};function L(){}const D={},F={once:!0};class N{constructor(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};(0,m.Z)(this,"id",void 0),(0,m.Z)(this,"VERSION",w),(0,m.Z)(this,"_startTs",j()),(0,m.Z)(this,"_deltaTs",j()),(0,m.Z)(this,"_storage",void 0),(0,m.Z)(this,"userData",{}),(0,m.Z)(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this._storage=new x("__probe-".concat(this.id,"__"),R),this.userData={},this.timeStamp("".concat(this.id," started")),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const r=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(r);for(const i of n)"function"===typeof t[i]&&(e.find((t=>i===t))||(t[i]=t[i].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((j()-this._startTs).toPrecision(10))}getDelta(){return Number((j()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){S(t,e)}warn(t){return this._getLogFunction(0,t,I.warn,arguments,F)}error(t){return this._getLogFunction(0,t,I.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,I.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,I.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return this._getLogFunction(t,e,I.debug||I.info,arguments,F)}table(t,e,r){return e?this._getLogFunction(t,e,console.table||L,r&&[r],{tag:U(e)}):L}image(t){let{logLevel:e,priority:n,image:i,message:o="",scale:s=1}=t;return this._shouldLog(e||n)?_?function(t){let{image:e,message:r="",scale:n=1}=t;if("string"===typeof e){const t=new Image;return t.onload=()=>{const e=E(t,r,n);console.log(...e)},t.src=e,L}const i=e.nodeName||"";if("img"===i.toLowerCase())return console.log(...E(e,r,n)),L;if("canvas"===i.toLowerCase()){const t=new Image;return t.onload=()=>console.log(...E(t,r,n)),t.src=e.toDataURL(),L}return L}({image:i,message:o,scale:s}):function(t){let{image:e,message:n="",scale:i=1}=t,o=null;try{o=r(9214)}catch(s){}if(o)return()=>o(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then((t=>console.log(t)));return L}({image:i,message:o,scale:s}):L}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||L)}group(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const n=z({logLevel:t,message:e,opts:r}),{collapsed:i}=r;return n.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},r,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||L)}withGroup(t,e,r){this.group(t,e)();try{r()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=B(t)}_getLogFunction(t,e,r,n,i){if(this._shouldLog(t)){i=z({logLevel:t,message:e,args:n,opts:i}),S(r=r||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=j();const o=i.tag||i.message;if(i.once){if(D[o])return L;D[o]=j()}return e=function(t,e,r){if("string"===typeof e){const s=r.time?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const r=Math.max(e-t.length,0);return"".concat(" ".repeat(r)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(r.total)):"";e=r.time?"".concat(t,": ").concat(s,"  ").concat(e):"".concat(t,": ").concat(e),n=e,i=r.color,o=r.background,_||"string"!==typeof n||(i&&(i=M(i),n="\x1b[".concat(i,"m").concat(n,"\x1b[39m")),o&&(i=M(o),n="\x1b[".concat(o+10,"m").concat(n,"\x1b[49m"))),e=n}var n,i,o;return e}(this.id,i.message,i),r.bind(console,e,...i.args)}return L}}function B(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return S(Number.isFinite(e)&&e>=0),e}function z(t){const{logLevel:e,message:r}=t;t.logLevel=B(e);const n=t.args?Array.from(t.args):[];for(;n.length&&n.shift()!==r;);switch(typeof e){case"string":case"function":void 0!==r&&n.unshift(r),t.message=e;break;case"object":Object.assign(t,e)}"function"===typeof t.message&&(t.message=t.message());const i=typeof t.message;return S("string"===i||"object"===i),Object.assign(t,{args:n},t.opts)}function U(t){for(const e in t)for(const r in t[e])return r||"untitled";return"empty"}(0,m.Z)(N,"VERSION",w);var V=new N({id:"deck"});let G={};function W(t){V.level>0&&G[t]&&G[t].call(...arguments)}function Z(t,e=(()=>!0)){return Array.isArray(t)?$(t,e,[]):e(t)?[t]:[]}function $(t,e,r){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?$(i,e,r):e(i)&&r.push(i)}return r}function X({target:t,source:e,start:r=0,count:n=1}){const i=e.length,o=n*i;let s=0;for(let a=r;s<i;s++)t[a++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(r+s,r,r+s),s*=2):(t.copyWithin(r+s,r,r+o-s),s=o);return t}var Y=r(4155);function H(){let t;if("undefined"!==typeof window&&window.performance)t=window.performance.now();else if("undefined"!==typeof Y&&Y.hrtime){const e=Y.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class q{constructor(t,e){(0,m.Z)(this,"name",void 0),(0,m.Z)(this,"type",void 0),(0,m.Z)(this,"sampleSize",1),(0,m.Z)(this,"time",void 0),(0,m.Z)(this,"count",void 0),(0,m.Z)(this,"samples",void 0),(0,m.Z)(this,"lastTiming",void 0),(0,m.Z)(this,"lastSampleTime",void 0),(0,m.Z)(this,"lastSampleCount",void 0),(0,m.Z)(this,"_count",0),(0,m.Z)(this,"_time",0),(0,m.Z)(this,"_samples",0),(0,m.Z)(this,"_startTime",0),(0,m.Z)(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=H(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(H()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class K{constructor(t){(0,m.Z)(this,"id",void 0),(0,m.Z)(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:r}=t;return this.stats[e]||(this.stats[e]=t instanceof q?t:new q(e,r)),this.stats[e]}}const Q=t=>"boolean"===typeof t,J=t=>"function"===typeof t,tt=t=>null!==t&&"object"===typeof t,et=t=>tt(t)&&t.constructor==={}.constructor,rt=t=>"undefined"!==typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,nt=t=>"undefined"!==typeof Blob&&t instanceof Blob,it=t=>(t=>"undefined"!==typeof ReadableStream&&t instanceof ReadableStream||tt(t)&&J(t.tee)&&J(t.cancel)&&J(t.getReader))(t)||(t=>tt(t)&&J(t.read)&&J(t.pipe)&&Q(t.readable))(t);function ot(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function st(t){var e;if(!t)return!1;Array.isArray(t)&&(t=t[0]);return Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions)}function at(t){var e,r;let n;return ot(t,"null loader"),ot(st(t),"invalid loader"),Array.isArray(t)&&(n=t[1],t=t[0],t={...t,options:{...t.options,...n}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(r=t)&&void 0!==r&&r.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}let ut="";const ct={};const lt=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,ht=/^([-\w.]+\/[-\w.+]+)/;function ft(t){const e=ht.exec(t);return e?e[1]:t}function dt(t){const e=lt.exec(t);return e?e[1]:""}const pt=/\?.*/;function gt(t){if(rt(t)){const e=mt(t.url||"");return{url:e,type:ft(t.headers.get("content-type")||"")||dt(e)}}return nt(t)?{url:mt(t.name||""),type:t.type||""}:"string"===typeof t?{url:mt(t),type:dt(t)}:{url:"",type:""}}function mt(t){return t.replace(pt,"")}async function yt(t){if(rt(t))return t;const e={},r=function(t){return rt(t)?t.headers["content-length"]||-1:nt(t)?t.size:"string"===typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);r>=0&&(e["content-length"]=String(r));const{url:n,type:i}=gt(t);i&&(e["content-type"]=i);const o=await async function(t){const e=5;if("string"===typeof t)return"data:,".concat(t.slice(0,e));if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const r=new FileReader;r.onload=e=>{var r;return t(null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.result)},r.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){const r=function(t){let e="";const r=new Uint8Array(t);for(let n=0;n<r.byteLength;n++)e+=String.fromCharCode(r[n]);return btoa(e)}(t.slice(0,e));return"data:base64,".concat(r)}return null}(t);o&&(e["x-first-bytes"]=o),"string"===typeof t&&(t=(new TextEncoder).encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:n}),s}async function vt(t,e){if("string"===typeof t){t=function(t){for(const e in ct)if(t.startsWith(e)){const r=ct[e];t=t.replace(e,r)}return t.startsWith("http://")||t.startsWith("https://")||(t="".concat(ut).concat(t)),t}(t);let r=e;return null!==e&&void 0!==e&&e.fetch&&"function"!==typeof(null===e||void 0===e?void 0:e.fetch)&&(r=e.fetch),await fetch(t,r)}return await yt(t)}const bt=new N({id:"loaders.gl"});class _t{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const wt={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){(0,m.Z)(this,"console",void 0),this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},xt={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Et(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const Pt=()=>{const t=Et();return t.globalOptions=t.globalOptions||{...wt},t.globalOptions};function Mt(t,e,r,n){return r=r||[],function(t,e){Ot(t,null,wt,xt,e);for(const r of e){const n=t&&t[r.id]||{},i=r.options&&r.options[r.id]||{},o=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};Ot(n,r.id,i,o,e)}}(t,r=Array.isArray(r)?r:[r]),Tt(e,t,n)}function St(t,e){const r=Pt(),n=t||r;return"function"===typeof n.fetch?n.fetch:tt(n.fetch)?t=>vt(t,n):null!==e&&void 0!==e&&e.fetch?null===e||void 0===e?void 0:e.fetch:vt}function Ot(t,e,r,n,i){const o=e||"Top level",s=e?"".concat(e,"."):"";for(const a in t){const u=!e&&tt(t[a]),c="baseUri"===a&&!e,l="workerUrl"===a&&e;if(!(a in r)&&!c&&!l)if(a in n)bt.warn("".concat(o," loader option '").concat(s).concat(a,"' no longer supported, use '").concat(n[a],"'"))();else if(!u){const t=At(a,i);bt.warn("".concat(o," loader option '").concat(s).concat(a,"' not recognized. ").concat(t))()}}}function At(t,e){const r=t.toLowerCase();let n="";for(const i of e)for(const e in i.options){if(t===e)return"Did you mean '".concat(i.id,".").concat(e,"'?");const o=e.toLowerCase();(r.startsWith(o)||o.startsWith(r))&&(n=n||"Did you mean '".concat(i.id,".").concat(e,"'?"))}return n}function Tt(t,e,r){const n={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(n,r),null===n.log&&(n.log=new _t),kt(n,Pt()),kt(n,e),n}function kt(t,e){for(const r in e)if(r in e){const n=e[r];et(n)&&et(t[r])?t[r]={...t[r],...e[r]}:t[r]=e[r]}}function Ct(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}var jt=r(4155);"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof r.g&&r.g,"undefined"!==typeof document&&document,"object"!==typeof jt||String(jt);const It="undefined"!==typeof window&&"undefined"!==typeof window.orientation,Rt="undefined"!==typeof jt&&jt.version&&/v([0-9]*)/.exec(jt.version),Lt=(Rt&&parseFloat(Rt[1]),new Map);function Dt(t){Ct(t.source&&!t.url||!t.source&&t.url);let e=Lt.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Ft((e=t,"try {\n  importScripts('".concat(e,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var e}(t.url),Lt.set(t.url,e)),t.source&&(e=Ft(t.source),Lt.set(t.source,e))),Ct(e),e}function Ft(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Nt(t,e=!0,r){const n=r||new Set;if(t){if(Bt(t))n.add(t);else if(Bt(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"===typeof t)for(const i in t)Nt(t[i],e,n)}else;return void 0===r?Array.from(n):[]}function Bt(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&t instanceof MessagePort||("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}const zt=()=>{};class Ut{static isSupported(){return"undefined"!==typeof Worker}constructor(t){(0,m.Z)(this,"name",void 0),(0,m.Z)(this,"source",void 0),(0,m.Z)(this,"url",void 0),(0,m.Z)(this,"terminated",!1),(0,m.Z)(this,"worker",void 0),(0,m.Z)(this,"onMessage",void 0),(0,m.Z)(this,"onError",void 0),(0,m.Z)(this,"_loadableURL","");const{name:e,source:r,url:n}=t;Ct(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=zt,this.onError=t=>console.log(t),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=zt,this.onError=zt,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||Nt(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=Dt({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}}class Vt{constructor(t,e){(0,m.Z)(this,"name",void 0),(0,m.Z)(this,"workerThread",void 0),(0,m.Z)(this,"isRunning",void 0),(0,m.Z)(this,"result",void 0),(0,m.Z)(this,"_resolve",void 0),(0,m.Z)(this,"_reject",void 0),this.name=t,this.workerThread=e,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){Ct(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Ct(this.isRunning),this.isRunning=!1,this._reject(t)}}class Gt{constructor(t){(0,m.Z)(this,"name","unnamed"),(0,m.Z)(this,"source",void 0),(0,m.Z)(this,"url",void 0),(0,m.Z)(this,"maxConcurrency",1),(0,m.Z)(this,"maxMobileConcurrency",1),(0,m.Z)(this,"onDebug",(()=>{})),(0,m.Z)(this,"reuseWorkers",!0),(0,m.Z)(this,"props",{}),(0,m.Z)(this,"jobQueue",[]),(0,m.Z)(this,"idleQueue",[]),(0,m.Z)(this,"count",0),(0,m.Z)(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e=((t,e,r)=>t.done(r)),r=((t,e)=>t.error(e))){const n=new Promise((n=>(this.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),this)));return this._startQueuedJob(),await n}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const r=new Vt(e.name,t);t.onMessage=t=>e.onMessage(r,t.type,t.payload),t.onError=t=>e.onError(r,t),e.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Ut({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return It?this.maxMobileConcurrency:this.maxConcurrency}}const Wt={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class Zt{static isSupported(){return Ut.isSupported()}static getWorkerFarm(t={}){return Zt._workerFarm=Zt._workerFarm||new Zt({}),Zt._workerFarm.setProps(t),Zt._workerFarm}constructor(t){(0,m.Z)(this,"props",void 0),(0,m.Z)(this,"workerPools",new Map),this.props={...Wt},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy()}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:r,url:n}=t;let i=this.workerPools.get(e);return i||(i=new Gt({name:e,source:r,url:n}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(0,m.Z)(Zt,"_workerFarm",void 0);async function $t(t,e,r,n,i){const o=t.id,s=function(t,e={}){const r=e[t.id]||{},n="".concat(t.id,"-worker.js");let i=r.workerUrl;if(i||"compression"!==t.id||(i=e.workerUrl),"test"===e._workerType&&(i="modules/".concat(t.module,"/dist/").concat(n)),!i){let e=t.version;"latest"===e&&(e="latest");const r=e?"@".concat(e):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(r,"/dist/").concat(n)}return Ct(i),i}(t,r),a=Zt.getWorkerFarm(r).getWorkerPool({name:o,url:s});r=JSON.parse(JSON.stringify(r));const u=await a.startJob("process-on-worker",Xt.bind(null,i));u.postMessage("process",{input:e,options:r});const c=await u.result;return await c.result}async function Xt(t,e,r,n){switch(r){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:o,input:s,options:a}=n;try{const r=await t(s,a);e.postMessage("done",{id:o,result:r})}catch(i){const t=i instanceof Error?i.message:"unknown error";e.postMessage("error",{id:o,error:t})}break;default:console.warn("parse-with-worker unknown message ".concat(r))}}r(9521);function Yt(t){return t&&"object"===typeof t&&t.isBuffer}function Ht(t){if(Yt(t))return function(t){if(Yt(t))return new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer;return t}(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"===typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"===typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}async function qt(t){const e=[];for await(const r of t)e.push(r);return function(...t){const e=t.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),r=e.reduce(((t,e)=>t+e.byteLength),0),n=new Uint8Array(r);let i=0;for(const o of e)n.set(o,i),i+=o.byteLength;return n.buffer}(...e)}const Kt=262144;var Qt=r(4155);"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof r.g&&r.g,"undefined"!==typeof document&&document;const Jt=Boolean("object"!==typeof Qt||"[object process]"!==String(Qt)||!0),te="undefined"!==typeof Qt&&Qt.version&&/v([0-9]*)/.exec(Qt.version);te&&parseFloat(te[1]);function ee(t,e){return Jt?async function*(t,e){const r=t.getReader();let n;try{for(;;){const t=n||r.read();null!==e&&void 0!==e&&e._streamReadAhead&&(n=r.read());const{done:i,value:o}=await t;if(i)return;yield Ht(o)}}catch(i){r.releaseLock()}}(t,e):async function*(t,e){for await(const r of t)yield Ht(r)}(t)}function re(t,e){if("string"===typeof t)return function*(t,e){const r=(null===e||void 0===e?void 0:e.chunkSize)||262144;let n=0;const i=new TextEncoder;for(;n<t.length;){const e=Math.min(t.length-n,r),o=t.slice(n,n+e);n+=e,yield i.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function*(t,e={}){const{chunkSize:r=Kt}=e;let n=0;for(;n<t.byteLength;){const e=Math.min(t.byteLength-n,r),i=new ArrayBuffer(e),o=new Uint8Array(t,n,e);new Uint8Array(i).set(o),n+=e,yield i}}(t,e);if(nt(t))return async function*(t,e){const r=(null===e||void 0===e?void 0:e.chunkSize)||1048576;let n=0;for(;n<t.size;){const e=n+r,i=await t.slice(n,e).arrayBuffer();n=e,yield i}}(t,e);if(it(t))return ee(t,e);if(rt(t)){return ee(t.body,e)}throw new Error("makeIterator")}const ne="Cannot convert supplied data type";async function ie(t,e,r){const n=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"===typeof t||n)return function(t,e,r){if(e.text&&"string"===typeof t)return t;var n;if((n=t)&&"object"===typeof n&&n.isBuffer&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const n=t.byteLength||t.length;return 0===t.byteOffset&&n===r.byteLength||(r=r.slice(t.byteOffset,t.byteOffset+n)),r}throw new Error(ne)}(t,e);if(nt(t)&&(t=await yt(t)),rt(t)){const r=t;return await async function(t){if(!t.ok){const e=await async function(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const r=t.headers.get("Content-Type");let n=t.statusText;r.includes("application/json")&&(n+=" ".concat(await t.text())),e+=n,e=e.length>60?"".concat(e.slice(60),"..."):e}catch(r){}return e}(t);throw new Error(e)}}(r),e.binary?await r.arrayBuffer():await r.text()}if(it(t)&&(t=re(t,r)),(i=t)&&"function"===typeof i[Symbol.iterator]||(t=>t&&"function"===typeof t[Symbol.asyncIterator])(t))return qt(t);var i;throw new Error(ne)}const oe=()=>{const t=Et();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};const se=/\.([^.]+)$/;function ae(t,e=[],r,n){if(!ue(t))return null;if(e&&!Array.isArray(e))return at(e);let i=[];e&&(i=i.concat(e)),null!==r&&void 0!==r&&r.ignoreRegisteredLoaders||i.push(...oe()),function(t){for(const e of t)at(e)}(i);const o=function(t,e,r,n){const{url:i,type:o}=gt(t),s=i||(null===n||void 0===n?void 0:n.url);let a=null;null!==r&&void 0!==r&&r.mimeType&&(a=le(e,null===r||void 0===r?void 0:r.mimeType));return a=a||function(t,e){const r=e&&se.exec(e),n=r&&r[1];return n?function(t,e){e=e.toLowerCase();for(const r of t)for(const t of r.extensions)if(t.toLowerCase()===e)return r;return null}(t,n):null}(e,s),a=a||le(e,o),a=a||function(t,e){if(!e)return null;for(const r of t)if("string"===typeof e){if(he(e,r))return r}else if(ArrayBuffer.isView(e)){if(fe(e.buffer,e.byteOffset,r))return r}else if(e instanceof ArrayBuffer){if(fe(e,0,r))return r}return null}(e,t),a=a||le(e,null===r||void 0===r?void 0:r.fallbackMimeType),a}(t,i,r,n);if(!o&&(null===r||void 0===r||!r.nothrow))throw new Error(ce(t));return o}function ue(t){return!(t instanceof Response&&204===t.status)}function ce(t){const{url:e,type:r}=gt(t);let n="No valid loader found (";n+=e?"".concat(function(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}(e),", "):"no url provided, ",n+="MIME type: ".concat(r?'"'.concat(r,'"'):"not provided",", ");const i=t?function(t,e=5){if("string"===typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return de(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){return de(t,0,e)}return""}(t):"";return n+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",n+=")",n}function le(t,e){for(const r of t){if(r.mimeTypes&&r.mimeTypes.includes(e))return r;if(e==="application/x.".concat(r.id))return r}return null}function he(t,e){if(e.testText)return e.testText(t);return(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function fe(t,e,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some((n=>function(t,e,r,n){if(n instanceof ArrayBuffer)return function(t,e,r){if(r=r||t.byteLength,t.byteLength<r||e.byteLength<r)return!1;const n=new Uint8Array(t),i=new Uint8Array(e);for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(n,t,n.byteLength);switch(typeof n){case"function":return n(t,r);case"string":return n===de(t,e,n.length);default:return!1}}(t,e,r,n)))}function de(t,e,r){if(t.byteLength<e+r)return"";const n=new DataView(t);let i="";for(let o=0;o<r;o++)i+=String.fromCharCode(n.getUint8(e+o));return i}async function pe(t,e,r,n){Ct(!n||"object"===typeof n),!e||Array.isArray(e)||st(e)||(n=void 0,r=e,e=void 0),t=await t,r=r||{};const{url:i}=gt(t),o=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let r;if(t&&(r=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];r=r?[...r,...t]:t}return r&&r.length?r:null}(e,n),s=await async function(t,e=[],r,n){if(!ue(t))return null;let i=ae(t,e,{...r,nothrow:!0},n);if(i)return i;if(nt(t)&&(i=ae(t=await t.slice(0,10).arrayBuffer(),e,r,n)),!i&&(null===r||void 0===r||!r.nothrow))throw new Error(ce(t));return i}(t,o,r);return s?(n=function(t,e,r=null){if(r)return r;const n={fetch:St(e,t),...t};return Array.isArray(n.loaders)||(n.loaders=null),n}({url:i,parse:pe,loaders:o},r=Mt(r,s,o,i),n),await async function(t,e,r,n){if(function(t,e="3.1.4"){Ct(t,"no worker provided");const r=t.version}(t),e=await ie(e,t,r),t.parseTextSync&&"string"===typeof e)return r.dataType="text",t.parseTextSync(e,r,n,t);if(function(t,e){return!!Zt.isSupported()&&t.worker&&(null===e||void 0===e?void 0:e.worker)}(t,r))return await $t(t,e,r,0,pe);if(t.parseText&&"string"===typeof e)return await t.parseText(e,r,n,t);if(t.parse)return await t.parse(e,r,n,t);throw Ct(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}(s,t,r,n)):null}async function ge(t,e,r,n){Array.isArray(e)||st(e)||(void 0,r=e,e=void 0);const i=St(r);let o=t;return"string"===typeof t&&(o=await i(t)),nt(t)&&(o=await i(t)),await pe(o,e,r)}class me{constructor(t,e,r){this.id=t,this.context=r,this._loadCount=0,this._subscribers=new Set,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const r=++this._loadCount;let n=t;"string"===typeof t&&(n=ge(t)),n instanceof Promise?(this.isLoaded=!1,this._loader=n.then((t=>{this._loadCount===r&&(this.isLoaded=!0,this._error=null,this._content=t)})).catch((t=>{this._loadCount===r&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=null,this._content=t);for(const i of this._subscribers)i.onChange(this.getData())}}class ye{constructor({gl:t,protocol:e}){this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:r=!1,persistent:n=!0}){let i=this._resources[t];i?i.setData(e,r):(i=new me(t,e,this._context),this._resources[t]=i),i.persistent=n}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const r=e[t];r.resource&&r.resource.unsubscribe(r)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:r,requestId:n="default"}){const{_resources:i,protocol:o}=this;t.startsWith(o)&&(i[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=i[t];if(this._track(r,n,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,r,n){const i=this._consumers,o=i[t]=i[t]||{},s=o[e]||{};s.resource&&(s.resource.unsubscribe(s),s.resource=null,this.prune()),r&&(o[e]=s,s.onChange=n,s.resource=r,r.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}var ve=new class{constructor(t){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(t)}setProps(t){Object.assign(this.props,t)}allocate(t,e,{size:r=1,type:n,padding:i=0,copy:o=!1,initialize:s=!1,maxCount:a}){const u=n||t&&t.constructor||Float32Array,c=e*r+i;if(ArrayBuffer.isView(t)){if(c<=t.length)return t;if(c*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new u(t.buffer,0,c)}let l;a&&(l=a*r+i);const h=this._allocate(u,c,s,l);return t&&o?h.set(t):s||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,r,n){let i=Math.max(Math.ceil(e*this.props.overAlloc),1);i>n&&(i=n);const o=this._pool,s=t.BYTES_PER_ELEMENT*i,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,i);return r&&e.fill(0),e}return new t(i)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:r}=t,{byteLength:n}=r,i=e.findIndex((t=>t.byteLength>=n));i<0?e.push(r):(i>0||e.length<this.props.poolSize)&&e.splice(i,0,r),e.length>this.props.poolSize&&e.shift()}};Math.PI,Math.PI;const be={};function _e(t,{precision:e=be.precision||4}={}){return t=function(t){return Math.round(t/be.EPSILON)*be.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function we(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function xe(t,e,r){if(we(t)){r=r||((n=t).clone?n.clone():new Array(n.length));for(let n=0;n<r.length&&n<t.length;++n)r[n]=e(t[n],n,r);return r}var n;return e(t)}function Ee(t,e,r){return xe(t,(t=>Math.max(e,Math.min(r,t))))}function Pe(t,e,r){return we(t)?t.map(((t,n)=>Pe(t,e[n],r))):r*e+(1-r)*t}function Me(t,e,r){const n=be.EPSILON;r&&(be.EPSILON=r);try{if(t===e)return!0;if(we(t)&&we(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!Me(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=be.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{be.EPSILON=n}}function Se(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}be.EPSILON=1e-12,be.debug=!1,be.precision=4,be.printTypes=!1,be.printDegrees=!1,be.printRowMajor=!0;class Oe extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return Se(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=t[r+e];return this.check()}to(t){return t===this?this:we(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let r=0;r<this.ELEMENTS;++r)t[e+r]=this[r];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(be)}formatString(t){let e="";for(let r=0;r<this.ELEMENTS;++r)e+=(r>0?", ":"")+_e(this[r],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!Me(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,r){void 0===r&&(r=e,e=t,t=this);for(let n=0;n<this.ELEMENTS;++n){const i=t[n];this[n]=i+r*(e[n]-i)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],t[r]),e[r]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(be.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}function Ae(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Te(t,e,r=""){if(be.debug&&!function(t,e){if(t.length!==e)return!1;for(let r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(r," some fields set to invalid numbers'"));return t}const ke={};function Ce(t,e){ke[t]||(ke[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}class je extends Oe{get ELEMENTS(){return Se(!1),0}copy(t){return Se(!1),this}get x(){return this[0]}set x(t){this[0]=Ae(t)}get y(){return this[1]}set y(t){this[1]=Ae(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let r=0;r<this.ELEMENTS;++r){const n=this[r]-t[r];e+=n*n}return Ae(e)}dot(t){let e=0;for(let r=0;r<this.ELEMENTS;++r)e+=this[r]*t[r];return Ae(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Se(t>=0&&t<this.ELEMENTS,"index is out of range"),Ae(this[t])}setComponent(t,e){return Se(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var Ie=1e-6,Re="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function Le(t,e,r){var n=e[0],i=e[1],o=e[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});!function(){var t=function(){var t=new Re(3);return Re!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function De(t,e,r){const n=e[0],i=e[1],o=e[2],s=r[3]*n+r[7]*i+r[11]*o||1;return t[0]=(r[0]*n+r[4]*i+r[8]*o)/s,t[1]=(r[1]*n+r[5]*i+r[9]*o)/s,t[2]=(r[2]*n+r[6]*i+r[10]*o)/s,t}const Fe=[0,0,0],Ne={};class Be extends je{static get ZERO(){return Ne.ZERO=Ne.ZERO||Object.freeze(new Be(0,0,0,0))}constructor(t=0,e=0,r=0){super(-0,-0,-0),1===arguments.length&&we(t)?this.copy(t):(be.debug&&(Ae(t),Ae(e),Ae(r)),this[0]=t,this[1]=e,this[2]=r)}set(t,e,r){return this[0]=t,this[1]=e,this[2]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return be.debug&&(Ae(t.x),Ae(t.y),Ae(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Ae(t)}angle(t){return function(t,e){var r=t[0],n=t[1],i=t[2],o=e[0],s=e[1],a=e[2],u=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(o*o+s*s+a*a),c=u&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}(this,t)}cross(t){return function(t,e,r){var n=e[0],i=e[1],o=e[2],s=r[0],a=r[1],u=r[2];t[0]=i*u-o*a,t[1]=o*s-n*u,t[2]=n*a-i*s}(this,this,t),this.check()}rotateX({radians:t,origin:e=Fe}){return function(t,e,r,n){var i=[],o=[];i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2]}(this,this,e,t),this.check()}rotateY({radians:t,origin:e=Fe}){return function(t,e,r,n){var i=[],o=[];i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2]}(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=Fe}){return function(t,e,r,n){var i=[],o=[];i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2]}(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Le(this,this,t),this.check()}transformAsVector(t){return De(this,this,t),this.check()}transformByMatrix3(t){return function(t,e,r){var n=e[0],i=e[1],o=e[2];t[0]=n*r[0]+i*r[3]+o*r[6],t[1]=n*r[1]+i*r[4]+o*r[7],t[2]=n*r[2]+i*r[5]+o*r[8]}(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,r){const n=e[0],i=e[1];t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return function(t,e,r){var n=r[0],i=r[1],o=r[2],s=r[3],a=e[0],u=e[1],c=e[2],l=i*c-o*u,h=o*a-n*c,f=n*u-i*a,d=i*f-o*h,p=o*l-n*f,g=n*h-i*l,m=2*s;l*=m,h*=m,f*=m,d*=2,p*=2,g*=2,t[0]=a+l+d,t[1]=u+h+p,t[2]=c+f+g}(this,this,t),this.check()}}const ze=new Be;function Ue(t,e,r,n){ze.set(t,e,r);const i=ze.len();return{distance:n/i,normal:new Be(-t/i,-e/i,-r/i)}}let Ve;function Ge(t,{size:e=1,startIndex:r=0,endIndex:n}){Number.isFinite(n)||(n=t.length);const i=(n-r)/e;Ve=ve.allocate(Ve,i,{type:Float32Array,size:2*e});let o=r,s=0;for(;o<n;){for(let r=0;r<e;r++){const n=t[o++];Ve[s+r]=n,Ve[s+r+e]=(a=n)-Math.fround(a)}s+=2*e}var a;return Ve.subarray(0,i*e*2)}class We extends Oe{get ELEMENTS(){return Se(!1),0}get RANK(){return Se(!1),0}toString(){let t="[";if(be.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let r=0;r<this.RANK;++r)t+=" ".concat(this[r*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,r){return this[e*this.RANK+t]=Ae(r),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const r=t*this.RANK;for(let n=0;n<this.RANK;++n)e[n]=this[r+n];return e}setColumn(t,e){const r=t*this.RANK;for(let n=0;n<this.RANK;++n)this[r+n]=e[n];return this}}function Ze(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],b=r[0],_=r[1],w=r[2],x=r[3];return t[0]=b*n+_*a+w*h+x*g,t[1]=b*i+_*u+w*f+x*m,t[2]=b*o+_*c+w*d+x*y,t[3]=b*s+_*l+w*p+x*v,b=r[4],_=r[5],w=r[6],x=r[7],t[4]=b*n+_*a+w*h+x*g,t[5]=b*i+_*u+w*f+x*m,t[6]=b*o+_*c+w*d+x*y,t[7]=b*s+_*l+w*p+x*v,b=r[8],_=r[9],w=r[10],x=r[11],t[8]=b*n+_*a+w*h+x*g,t[9]=b*i+_*u+w*f+x*m,t[10]=b*o+_*c+w*d+x*y,t[11]=b*s+_*l+w*p+x*v,b=r[12],_=r[13],w=r[14],x=r[15],t[12]=b*n+_*a+w*h+x*g,t[13]=b*i+_*u+w*f+x*m,t[14]=b*o+_*c+w*d+x*y,t[15]=b*s+_*l+w*p+x*v,t}function $e(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}!function(){var t=function(){var t=new Re(2);return Re!=Float32Array&&(t[0]=0,t[1]=0),t}()}();!function(){var t=function(){var t=new Re(4);return Re!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();const Xe=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Ye=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),He=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),qe={};class Ke extends We{static get IDENTITY(){return qe.IDENTITY=qe.IDENTITY||Object.freeze(new Ke(Xe)),qe.IDENTITY}static get ZERO(){return qe.ZERO=qe.ZERO||Object.freeze(new Ke(Ye)),qe.ZERO}get INDICES(){return He}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,r,n,i,o,s,a,u,c,l,h,f,d,p,g){return this[0]=t,this[1]=e,this[2]=r,this[3]=n,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=u,this[9]=c,this[10]=l,this[11]=h,this[12]=f,this[13]=d,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,r,n,i,o,s,a,u,c,l,h,f,d,p,g){return this[0]=t,this[1]=i,this[2]=u,this[3]=f,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=r,this[9]=s,this[10]=l,this[11]=p,this[12]=n,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(Xe)}fromQuaternion(t){return function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=r+r,a=n+n,u=i+i,c=r*s,l=n*s,h=n*a,f=i*s,d=i*a,p=i*u,g=o*s,m=o*a,y=o*u;t[0]=1-h-p,t[1]=l+y,t[2]=f-m,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=d+g,t[7]=0,t[8]=f+m,t[9]=d-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum({left:t,right:e,bottom:r,top:n,near:i,far:o}){return o===1/0?Ke._computeInfinitePerspectiveOffCenter(this,t,e,r,n,i):function(t,e,r,n,i,o,s){var a=1/(r-e),u=1/(i-n),c=1/(o-s);t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(i+n)*u,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0}(this,t,e,r,n,i,o),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,r,n,i,o){const s=2*o/(r-e),a=2*o/(i-n),u=(r+e)/(r-e),c=(i+n)/(i-n),l=-2*o;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0,t}lookAt(t,e,r){return 1===arguments.length&&({eye:t,center:e,up:r}=t),function(t,e,r,n){var i,o,s,a,u,c,l,h,f,d,p=e[0],g=e[1],m=e[2],y=n[0],v=n[1],b=n[2],_=r[0],w=r[1],x=r[2];Math.abs(p-_)<Ie&&Math.abs(g-w)<Ie&&Math.abs(m-x)<Ie?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(l=p-_,h=g-w,f=m-x,i=v*(f*=d=1/Math.hypot(l,h,f))-b*(h*=d),o=b*(l*=d)-y*f,s=y*h-v*l,(d=Math.hypot(i,o,s))?(i*=d=1/d,o*=d,s*=d):(i=0,o=0,s=0),a=h*s-f*o,u=f*i-l*s,c=l*o-h*i,(d=Math.hypot(a,u,c))?(a*=d=1/d,u*=d,c*=d):(a=0,u=0,c=0),t[0]=i,t[1]=a,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=h,t[7]=0,t[8]=s,t[9]=c,t[10]=f,t[11]=0,t[12]=-(i*p+o*g+s*m),t[13]=-(a*p+u*g+c*m),t[14]=-(l*p+h*g+f*m),t[15]=1)}(this,t,e=e||[0,0,0],r=r||[0,1,0]),this.check()}ortho({left:t,right:e,bottom:r,top:n,near:i=.1,far:o=500}){return function(t,e,r,n,i,o,s){var a=1/(e-r),u=1/(n-i),c=1/(o-s);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*a,t[13]=(i+n)*u,t[14]=(s+o)*c,t[15]=1}(this,t,e,r,n,i,o),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:r=1,near:n=.1,far:i=500}){if(t>2*Math.PI)throw Error("radians");const o=t/2,s=r*Math.tan(o),a=s*e;return(new Ke).ortho({left:-a,right:a,bottom:-s,top:s,near:n,far:i})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:r=1,near:n=.1,far:i=500}={}){if((t=t||e)>2*Math.PI)throw Error("radians");return function(t,e,r,n,i){var o,s=1/Math.tan(e/2);t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(n-i),t[10]=(i+n)*o,t[14]=2*i*n*o):(t[10]=-1,t[14]=-2*n)}(this,t,r,n,i),this.check()}determinant(){return function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],d=t[12],p=t[13],g=t[14],m=t[15];return(e*s-r*o)*(h*m-f*g)-(e*a-n*o)*(l*m-f*p)+(e*u-i*o)*(l*g-h*p)+(r*a-n*s)*(c*m-f*d)-(r*u-i*s)*(c*g-h*d)+(n*u-i*a)*(c*p-l*d)}(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const r=this.getScale(e||[-0,-0,-0]),n=1/r[0],i=1/r[1],o=1/r[2];return t[0]=this[0]*n,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*n,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*n,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const r=this.getScale(e||[-0,-0,-0]),n=1/r[0],i=1/r[1],o=1/r[2];return t[0]=this[0]*n,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*n,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*n,t[7]=this[9]*i,t[8]=this[10]*o,t}transpose(){return function(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=r*a-n*s,b=r*u-i*s,_=r*c-o*s,w=n*u-i*a,x=n*c-o*a,E=i*c-o*u,P=l*g-h*p,M=l*m-f*p,S=l*y-d*p,O=h*m-f*g,A=h*y-d*g,T=f*y-d*m,k=v*T-b*A+_*O+w*S-x*M+E*P;k&&(k=1/k,t[0]=(a*T-u*A+c*O)*k,t[1]=(i*A-n*T-o*O)*k,t[2]=(g*E-m*x+y*w)*k,t[3]=(f*x-h*E-d*w)*k,t[4]=(u*S-s*T-c*M)*k,t[5]=(r*T-i*S+o*M)*k,t[6]=(m*_-p*E-y*b)*k,t[7]=(l*E-f*_+d*b)*k,t[8]=(s*A-a*S+c*P)*k,t[9]=(n*S-r*A-o*P)*k,t[10]=(p*x-g*_+y*v)*k,t[11]=(h*_-l*x-d*v)*k,t[12]=(a*M-s*O-u*P)*k,t[13]=(r*O-n*M+i*P)*k,t[14]=(g*b-p*w-m*v)*k,t[15]=(l*w-h*b+f*v)*k)}(this,this),this.check()}multiplyLeft(t){return Ze(this,t,this),this.check()}multiplyRight(t){return Ze(this,this,t),this.check()}rotateX(t){return function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*n,t[5]=s*i+l*n,t[6]=a*i+h*n,t[7]=u*i+f*n,t[8]=c*i-o*n,t[9]=l*i-s*n,t[10]=h*i-a*n,t[11]=f*i-u*n}(this,this,t),this.check()}rotateY(t){return function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],c=e[8],l=e[9],h=e[10],f=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*n,t[1]=s*i-l*n,t[2]=a*i-h*n,t[3]=u*i-f*n,t[8]=o*n+c*i,t[9]=s*n+l*i,t[10]=a*n+h*i,t[11]=u*n+f*i}(this,this,t),this.check()}rotateZ(t){return function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*n,t[1]=s*i+l*n,t[2]=a*i+h*n,t[3]=u*i+f*n,t[4]=c*i-o*n,t[5]=l*i-s*n,t[6]=h*i-a*n,t[7]=f*i-u*n}(this,this,t),this.check()}rotateXYZ([t,e,r]){return this.rotateX(t).rotateY(e).rotateZ(r)}rotateAxis(t,e){return function(t,e,r,n){var i,o,s,a,u,c,l,h,f,d,p,g,m,y,v,b,_,w,x,E,P,M,S,O,A=n[0],T=n[1],k=n[2],C=Math.hypot(A,T,k);C<Ie||(A*=C=1/C,T*=C,k*=C,i=Math.sin(r),s=1-(o=Math.cos(r)),a=e[0],u=e[1],c=e[2],l=e[3],h=e[4],f=e[5],d=e[6],p=e[7],g=e[8],m=e[9],y=e[10],v=e[11],b=A*A*s+o,_=T*A*s+k*i,w=k*A*s-T*i,x=A*T*s-k*i,E=T*T*s+o,P=k*T*s+A*i,M=A*k*s+T*i,S=T*k*s-A*i,O=k*k*s+o,t[0]=a*b+h*_+g*w,t[1]=u*b+f*_+m*w,t[2]=c*b+d*_+y*w,t[3]=l*b+p*_+v*w,t[4]=a*x+h*E+g*P,t[5]=u*x+f*E+m*P,t[6]=c*x+d*E+y*P,t[7]=l*x+p*E+v*P,t[8]=a*M+h*S+g*O,t[9]=u*M+f*S+m*O,t[10]=c*M+d*S+y*O,t[11]=l*M+p*S+v*O,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?$e(this,this,t):$e(this,this,[t,t,t]),this.check()}translate(t){return function(t,e,r){var n,i,o,s,a,u,c,l,h,f,d,p,g=r[0],m=r[1],y=r[2];e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=n*g+a*m+h*y+e[12],t[13]=i*g+u*m+f*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=s*g+l*m+p*y+e[15])}(this,this,t),this.check()}transform(t,e){return 4===t.length?(Te(e=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,t}(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:r}=t;switch(r){case 2:e=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}(e||[-0,-0],t,this);break;case 3:e=Le(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Te(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=function(t,e,r){const n=e[0],i=e[1],o=r[3]*n+r[7]*i||1;return t[0]=(r[0]*n+r[4]*i)/o,t[1]=(r[1]*n+r[5]*i)/o,t}(e||[-0,-0],t,this);break;case 3:e=De(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Te(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,r){return this.identity().translate([t,e,r])}transformPoint(t,e){return Ce("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return Ce("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return Ce("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}function Qe(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=r*a-n*s,b=r*u-i*s,_=r*c-o*s,w=n*u-i*a,x=n*c-o*a,E=i*c-o*u,P=l*g-h*p,M=l*m-f*p,S=l*y-d*p,O=h*m-f*g,A=h*y-d*g,T=f*y-d*m,k=v*T-b*A+_*O+w*S-x*M+E*P;return k?(k=1/k,t[0]=(a*T-u*A+c*O)*k,t[1]=(i*A-n*T-o*O)*k,t[2]=(g*E-m*x+y*w)*k,t[3]=(f*x-h*E-d*w)*k,t[4]=(u*S-s*T-c*M)*k,t[5]=(r*T-i*S+o*M)*k,t[6]=(m*_-p*E-y*b)*k,t[7]=(l*E-f*_+d*b)*k,t[8]=(s*A-a*S+c*P)*k,t[9]=(n*S-r*A-o*P)*k,t[10]=(p*x-g*_+y*v)*k,t[11]=(h*_-l*x-d*v)*k,t[12]=(a*M-s*O-u*P)*k,t[13]=(r*O-n*M+i*P)*k,t[14]=(g*b-p*w-m*v)*k,t[15]=(l*w-h*b+f*v)*k,t):null}function Je(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],b=r[0],_=r[1],w=r[2],x=r[3];return t[0]=b*n+_*a+w*h+x*g,t[1]=b*i+_*u+w*f+x*m,t[2]=b*o+_*c+w*d+x*y,t[3]=b*s+_*l+w*p+x*v,b=r[4],_=r[5],w=r[6],x=r[7],t[4]=b*n+_*a+w*h+x*g,t[5]=b*i+_*u+w*f+x*m,t[6]=b*o+_*c+w*d+x*y,t[7]=b*s+_*l+w*p+x*v,b=r[8],_=r[9],w=r[10],x=r[11],t[8]=b*n+_*a+w*h+x*g,t[9]=b*i+_*u+w*f+x*m,t[10]=b*o+_*c+w*d+x*y,t[11]=b*s+_*l+w*p+x*v,b=r[12],_=r[13],w=r[14],x=r[15],t[12]=b*n+_*a+w*h+x*g,t[13]=b*i+_*u+w*f+x*m,t[14]=b*o+_*c+w*d+x*y,t[15]=b*s+_*l+w*p+x*v,t}var tr=r(7682);const er={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(er,"IDENTITY",{get:()=>V.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const rr={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},nr={common:0,meters:1,pixels:2},ir={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},or=Math.PI/180,sr=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ar=[0,0,0],ur={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class cr{constructor(t={}){const{id:e=null,x:r=0,y:n=0,width:i=1,height:o=1}=t;this.id=e||this.constructor.displayName||"viewport",this.x=r,this.y=n,this.width=i||1,this.height=o||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?rr.WEB_MERCATOR:rr.WEB_MERCATOR_AUTO_OFFSET:rr.IDENTITY}equals(t){return t instanceof cr&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&Me(t.projectionMatrix,this.projectionMatrix)&&Me(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const r=this.projectPosition(t),n=(0,tr.aW)(r,this.pixelProjectionMatrix),[i,o]=n,s=e?o:this.height-o;return 2===t.length?[i,s]:[i,s,n[2]]}unproject(t,{topLeft:e=!0,targetZ:r}={}){const[n,i,o]=t,s=e?i:this.height-i,a=r&&r*this.distanceScales.unitsPerMeter[2],u=(0,tr.CT)([n,s,o],this.pixelUnprojectionMatrix,a),[c,l,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,l,h]:Number.isFinite(r)?[c,l,r]:[c,l]}projectPosition(t){const[e,r]=this.projectFlat(t);return[e,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,r]=this.unprojectFlat(t);return[e,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?(0,tr.w5)(t):t}unprojectFlat(t){return this.isGeospatial?(0,tr.es)(t):t}getBounds(t={}){const e={targetZ:t.z||0},r=this.unproject([0,0],e),n=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(r[0],n[0],i[0],o[0]),Math.min(r[1],n[1],i[1],o[1]),Math.max(r[0],n[0],i[0],o[0]),Math.max(r[1],n[1],i[1],o[1])]}getDistanceScales(t=null){return t?(0,tr.ro)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:r=1,height:n=1}){return t<this.x+this.width&&this.x<t+r&&e<this.y+this.height&&this.y<e+n}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function(t){const e={};return e.left=Ue(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),e.right=Ue(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),e.bottom=Ue(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),e.top=Ue(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),e.near=Ue(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),e.far=Ue(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14]),e}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:e,aspect:r,focalDistance:n,near:i,far:o}){return t?(new Ke).orthographic({fovy:e,aspect:r,focalDistance:n,near:i,far:o}):(new Ke).perspective({fovy:e,aspect:r,near:i,far:o})}_initViewMatrix(t){const{viewMatrix:e=sr,longitude:r=null,latitude:n=null,zoom:i=null,position:o=null,modelMatrix:s=null,focalDistance:a=1,distanceScales:u=null}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(r),this.zoom=i,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?(0,tr.Bf)({latitude:n})+Math.log2(a):0);const c=Math.pow(2,this.zoom);this.scale=c,this.distanceScales=this.isGeospatial?(0,tr.ro)({latitude:n,longitude:r}):u||ur,this.focalDistance=a,this.distanceScales.metersPerUnit=new Be(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new Be(this.distanceScales.unitsPerMeter),this.position=ar,this.meterOffset=ar,o&&(this.position=o,this.modelMatrix=s,this.meterOffset=s?s.transformVector(o):o),this.isGeospatial?(this.longitude=r,this.latitude=n,this.center=this._getCenterInWorld({longitude:r,latitude:n})):this.center=o?this.projectPosition(o):[0,0,0],this.viewMatrixUncentered=e,this.viewMatrix=(new Ke).multiplyRight(this.viewMatrixUncentered).translate(new Be(this.center||ar).negate())}_getCenterInWorld({longitude:t,latitude:e}){const{meterOffset:r,distanceScales:n}=this,i=new Be(this.projectPosition([t,e,0]));if(r){const t=new Be(r).scale(n.unitsPerMeter);i.add(t)}return i}_initProjectionMatrix(t){const{projectionMatrix:e=null,orthographic:r=!1,fovyRadians:n,fovy:i=75,near:o=.1,far:s=1e3,focalDistance:a=1}=t;this.projectionMatrix=e||this._createProjectionMatrix({orthographic:r,fovyRadians:n||i*or,aspect:this.width/this.height,focalDistance:a,near:o,far:s})}_initPixelMatrices(){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var e;Je(t,t,this.projectionMatrix),Je(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=Qe([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(e=this.viewMatrixInverse)[12],e[13],e[14]];const r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];!function(t,e,r){var n=r[0],i=r[1],o=r[2];t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(r,r,[this.width/2,-this.height/2,1]),function(t,e,r){var n,i,o,s,a,u,c,l,h,f,d,p,g=r[0],m=r[1],y=r[2];e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=n*g+a*m+h*y+e[12],t[13]=i*g+u*m+f*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=s*g+l*m+p*y+e[15])}(r,r,[1,-1,0]),Je(n,r,this.viewProjectionMatrix),this.pixelProjectionMatrix=n,this.viewportMatrix=r,this.pixelUnprojectionMatrix=Qe([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||V.warn("Pixel project matrix not invertible")()}}cr.displayName="Viewport";const lr="vs",hr="fs";function fr(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const dr={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function pr(t){let e=gr(t);return"object"===e?t?"type"in t?Object.assign({},t,dr[t.type]):"value"in t?(e=gr(t.value),Object.assign({type:e},t,dr[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},dr[e])}function gr(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class mr{constructor({name:t,vs:e,fs:r,dependencies:n=[],uniforms:i,getUniforms:o,deprecations:s=[],defines:a={},inject:u={},vertexShader:c,fragmentShader:l}){fr("string"===typeof t),this.name=t,this.vs=e||c,this.fs=r||l,this.getModuleUniforms=o,this.dependencies=n,this.deprecations=this._parseDeprecationDefinitions(s),this.defines=a,this.injections=function(t){const e={vs:{},fs:{}};for(const r in t){let n=t[r];const i=r.slice(0,2);"string"===typeof n&&(n={order:0,injection:n}),e[i][r]=n}return e}(u),i&&(this.uniforms=function(t){const e={};for(const r in t){const n=pr(t[r]);e[r]=n}return e}(i))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:fr(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${e}// END MODULE_${this.name}\n\n`}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((r=>{r.regex.test(t)&&(r.deprecated?e.deprecated(r.old,r.new)():e.removed(r.old,r.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}})),t}_defaultGetUniforms(t={}){const e={},r=this.uniforms;for(const n in r){const i=r[n];n in t&&!i.private?(i.validate&&fr(i.validate(t[n],i),`${this.name}: invalid ${n}`),e[n]=t[n]):e[n]=i.value}return e}}function yr(t){return vr(_r(t))}function vr(t){const e={},r={};return br({modules:t,level:0,moduleMap:e,moduleDepth:r}),Object.keys(r).sort(((t,e)=>r[e]-r[t])).map((t=>e[t]))}function br({modules:t,level:e,moduleMap:r,moduleDepth:n}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)r[i.name]=i,(void 0===n[i.name]||n[i.name]<e)&&(n[i.name]=e);for(const i of t)i.dependencies&&br({modules:i.dependencies,level:e+1,moduleMap:r,moduleDepth:n})}function _r(t,e){return t.map((t=>(t instanceof mr||(fr("string"!==typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),fr(t.name,"shader module has no name"),(t=new mr(t)).dependencies=_r(t.dependencies)),t)))}const wr={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},xr={};Object.keys(wr).forEach((t=>{xr[t]=t}));const Er={};function Pr(t,e,r={}){const n=wr[e];if(fr(n,e),!function(t={}){const e="undefined"!==typeof window&&window.navigator||{},r=t.userAgent||e.userAgent||"",n=-1!==r.indexOf("MSIE "),i=-1!==r.indexOf("Trident/");return n||i}(r))return!0;if(e in Er)return Er[e];const i=`#extension GL_${n[0]} : ${r.behavior||"enable"}\nvoid main(void) {}`,o=t.createShader(35633);t.shaderSource(o,i),t.compileShader(o);const s=t.getShaderParameter(o,35713);return t.deleteShader(o),Er[e]=s,s}function Mr(t,e){const r=wr[e];fr(r,e);const n=function(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&r[1]||r[0],i="string"===typeof n?Boolean(t.getExtension(n)):n;return fr(!1===i||!0===i),i}function Sr(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>Mr(t,e)))}const Or={[lr]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[hr]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Ar="__LUMA_INJECT_DECLARATIONS__",Tr=/void\s+main\s*\([^)]*\)\s*\{\n?/,kr=/}\n?[^{}]*$/,Cr=[];function jr(t,e,r,n=!1){const i=e===lr;for(const o in r){const e=r[o];e.sort(((t,e)=>t.order-e.order)),Cr.length=e.length;for(let t=0,r=e.length;t<r;++t)Cr[t]=e[t].injection;const n=`${Cr.join("\n")}\n`;switch(o){case"vs:#decl":i&&(t=t.replace(Ar,n));break;case"vs:#main-start":i&&(t=t.replace(Tr,(t=>t+n)));break;case"vs:#main-end":i&&(t=t.replace(kr,(t=>n+t)));break;case"fs:#decl":i||(t=t.replace(Ar,n));break;case"fs:#main-start":i||(t=t.replace(Tr,(t=>t+n)));break;case"fs:#main-end":i||(t=t.replace(kr,(t=>n+t)));break;default:t=t.replace(o,(t=>t+n))}}return t=t.replace(Ar,""),n&&(t=t.replace(/\}\s*$/,(t=>t+Or[e]))),t}function Ir(t){const e={};return fr(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const r in t)e[r]=e[r]?`${e[r]}\n${t[r]}`:t[r]})),e}function Rr(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const Lr=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Dr=[...Lr,[Rr("attribute"),"in $1"],[Rr("varying"),"out $1"]],Fr=[...Lr,[Rr("varying"),"in $1"]],Nr=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Br=[...Nr,[Rr("in"),"attribute $1"],[Rr("out"),"varying $1"]],zr=[...Nr,[Rr("in"),"varying $1"]],Ur="gl_FragColor",Vr=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Gr=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Wr(t,e,r){switch(e){case 300:return r?Zr(t,Dr):function(t){const e=(t=Zr(t,Fr)).match(Vr);if(e){const r=e[1];t=t.replace(new RegExp("\\bgl_FragColor\\b","g"),r)}else{const e="fragmentColor";t=t.replace(Gr,(t=>`out vec4 ${e};\n${t}`)).replace(new RegExp("\\bgl_FragColor\\b","g"),e)}return t}(t);case 100:return r?Zr(t,Br):function(t){const e=(t=Zr(t,zr)).match(Vr);if(e){const r=e[1];t=t.replace(Vr,"").replace(new RegExp(`\\b${r}\\b`,"g"),Ur)}return t}(t);default:throw new Error(`unknown GLSL version ${e}`)}}function Zr(t,e){for(const[r,n]of e)t=t.replace(r,n);return t}const $r={[lr]:"vertex",[hr]:"fragment"};function Xr(t,{id:e,source:r,type:n,modules:i,defines:o={},hookFunctions:s=[],inject:a={},transpileToGLSL100:u=!1,prologue:c=!0,log:l}){fr("string"===typeof r,"shader source must be a string");const h=n===lr,f=r.split("\n");let d=100,p="",g=r;0===f[0].indexOf("#version ")?(d=300,p=f[0],g=f.slice(1).join("\n")):p=`#version ${d}`;const m={};i.forEach((t=>{Object.assign(m,t.getDefines())})),Object.assign(m,o);let y=c?`${p}\n${function({id:t,source:e,type:r}){return t&&"string"===typeof t&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${t}_${$r[r]}\n\n`:""}({id:e,source:r,type:n})}\n${function({type:t}){return`\n#define SHADER_TYPE_${$r[t].toUpperCase()}\n`}({type:n})}\n${function(t){switch(function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),r=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),n=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(r,n),vendor:r,renderer:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t)}\n${function(t,e,r){let n="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Sr(t,xr.GLSL_FRAG_DEPTH)&&(n+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Sr(t,xr.GLSL_DERIVATIVES)&&Pr(t,xr.GLSL_DERIVATIVES)&&(n+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Sr(t,xr.GLSL_FRAG_DATA)&&Pr(t,xr.GLSL_FRAG_DATA,{behavior:"require"})&&(n+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Sr(t,xr.GLSL_TEXTURE_LOD)&&(n+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),n}(t)}\n${function(t={}){let e=0,r="";for(const n in t){0===e&&(r+="\n// APPLICATION DEFINES\n"),e++;const i=t[n];(i||Number.isFinite(i))&&(r+=`#define ${n.toUpperCase()} ${t[n]}\n`)}0===e&&(r+="\n");return r}(m)}\n${h?"":"precision highp float;\n\n"}\n`:`${p}\n`;const v=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let r;"string"!==typeof t?(r=t,t=r.hook):r={},t=t.trim();const[n,i]=t.split(":"),o=t.replace(/\(.+/,"");e[n][o]=Object.assign(r,{signature:i})})),e}(s),b={},_={},w={};for(const x in a){const t="string"===typeof a[x]?{injection:a[x],order:0}:a[x],e=x.match(/^(v|f)s:(#)?([\w-]+)$/);if(e){const r=e[2],n=e[3];r?"decl"===n?_[x]=[t]:w[x]=[t]:b[x]=[t]}else w[x]=[t]}for(const x of i){l&&x.checkDeprecations(g,l);y+=x.getModuleSource(n,d);const t=x.injections[n];for(const e in t){const r=e.match(/^(v|f)s:#([\w-]+)$/);if(r){const n="decl"===r[2]?_:w;n[e]=n[e]||[],n[e].push(t[e])}else b[e]=b[e]||[],b[e].push(t[e])}}return y+="\n\n__LUMA_INJECT_DECLARATIONS__\n\n",y=jr(y,n,_),y+=function(t,e){let r="";for(const n in t){const i=t[n];if(r+=`void ${i.signature} {\n`,i.header&&(r+=`  ${i.header}`),e[n]){const t=e[n];t.sort(((t,e)=>t.order-e.order));for(const e of t)r+=`  ${e.injection}\n`}i.footer&&(r+=`  ${i.footer}`),r+="}\n"}return r}(v[n],b),y+=g,y=jr(y,n,w),y=Wr(y,u?100:d,h),y}function Yr(t){return function(e){const r={};for(const n of t){const t=n.getUniforms(e,r);Object.assign(r,t)}return r}}const Hr=new N({id:"luma.gl"});function qr(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Kr="Invalid WebGLRenderingContext";function Qr(t){return"undefined"!==typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||("undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version)))}function Jr(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function tn(t){return qr(Qr(t),Kr),t}function en(t){return qr(Jr(t),"Requires WebGL2"),t}const rn={};function nn(t,e){var r;rn[t]=!0,void 0!==e&&(r=e,T.console&&T.console.error&&T.console.error(r))}const on=function t(e){const r=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let n=0;n<this.attribs.length;n++){const e=new t.VertexAttrib(r);this.attribs[n]=e}this.maxAttrib=0};(on.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const sn=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let r;do{r=e.apply(t),0!==r&&(rn[r]=!0)}while(0!==r);for(r in rn)if(rn[r])return delete rn[r],parseInt(r,10);return 0}}(t);const r=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:r.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const n=e.currentVertexArrayObject;n.maxAttrib=Math.max(n.maxAttrib,t);const i=n.attribs[t];return i.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const n=e.currentVertexArrayObject;n.maxAttrib=Math.max(n.maxAttrib,t);const i=n.attribs[t];return i.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,n){switch(t){case 34962:e.currentArrayBuffer=n;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=n}return r.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,n){const i=e.currentVertexArrayObject,o=i.attribs[t];switch(n){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,n,i,o,s,a){const u=e.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,t);const c=u.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=n,c.type=i,c.normalized=o,c.stride=s,c.offset=a,c.recache(),r.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{var t;t="OESVertexArrayObject emulation library context restored",T.console&&T.console.log&&T.console.log(t),e.reset_()}),!0),this.reset_()};sn.prototype.VERTEX_ARRAY_BINDING_OES=34229,sn.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new on(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},sn.prototype.createVertexArrayOES=function(){const t=new on(this);return this.vertexArrayObjects.push(t),t},sn.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},sn.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof on&&t.hasBeenBound&&t.ext===this)},sn.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return void nn(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const r=this.original,n=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const i=this.currentVertexArrayObject;if(n===i)return;n&&i.elementArrayBuffer===n.elementArrayBuffer||r.bindBuffer.call(e,34963,i.elementArrayBuffer);let o=this.currentArrayBuffer;const s=Math.max(n?n.maxAttrib:0,i.maxAttrib);for(let a=0;a<=s;a++){const t=i.attribs[a],s=n?n.attribs[a]:null;if(n&&t.enabled===s.enabled||(t.enabled?r.enableVertexAttribArray.call(e,a):r.disableVertexAttribArray.call(e,a)),t.enabled){let i=!1;n&&t.buffer===s.buffer||(o!==t.buffer&&(r.bindBuffer.call(e,34962,t.buffer),o=t.buffer),i=!0),(i||t.cached!==s.cached)&&r.vertexAttribPointer.call(e,a,t.size,t.type,t.normalized,t.stride,t.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(e,34962,this.currentArrayBuffer)};const an="OES_element_index",un="WEBGL_draw_buffers",cn="WEBGL_debug_renderer_info",ln=t=>Jr(t)?void 0:0,hn={3074:t=>Jr(t)?void 0:36064,35723:t=>Jr(t)?void 0:4352,35977:ln,32937:ln,36795:(t,e)=>{const r=Jr(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return r&&r.GPU_DISJOINT_EXT?e(r.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const r=t.getExtension(cn);return e(r&&r.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const r=t.getExtension(cn);return e(r&&r.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const r=t.luma.extensions.EXT_texture_filter_anisotropic;return r?e(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:ln,35071:ln,37447:ln,36063:(t,e)=>{if(!Jr(t)){const r=t.getExtension(un);return r?e(r.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:ln,35374:ln,35377:ln,34852:t=>{if(!Jr(t)){const e=t.getExtension(un);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(an)?2147483647:65535,33001:t=>t.getExtension(an)?16777216:65535,33e3:t=>16777216,37157:ln,35373:ln,35657:ln,36183:ln,37137:ln,34045:ln,35978:ln,35979:ln,35968:ln,35376:ln,35375:ln,35659:ln,37154:ln,35371:ln,35658:ln,35076:ln,35077:ln,35380:ln};const fn="ANGLE_instanced_arrays";const dn={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{qr(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[fn]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){qr(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{qr(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{qr(!1)},deleteQuery:()=>{qr(!1)},beginQuery:()=>{qr(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},pn={readBuffer:(t,e,r)=>{Jr(t)&&e(r)},getVertexAttrib:(t,e,r,n)=>{const{webgl2:i,ext:o}=function(t,e){return{webgl2:Jr(t),ext:t.getExtension(e)}}(t,fn);let s;switch(n){case 35069:s=!!i&&void 0;break;case 35070:s=i||o?void 0:0}return void 0!==s?s:e(r,n)},getProgramParameter:(t,e,r,n)=>{if(!Jr(t))switch(n){case 35967:return 35981;case 35971:case 35382:return 0}return e(r,n)},getInternalformatParameter:(t,e,r,n,i)=>{if(!Jr(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(r,n,i)},getTexParameter(t,e,r,n){switch(n){case 34046:const{extensions:e}=t.luma,r=e.EXT_texture_filter_anisotropic;n=r&&r.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(r,n)},getParameter:function(t,e,r){const n=hn[r],i="function"===typeof n?n(t,e,r):n;return void 0!==i?i:e(r)},hint:(t,e,r,n)=>e(r,n)};function gn(t,{extension:e,target:r,target2:n}){const i=dn[e];qr(i);const{meta:o={}}=i,{suffix:s=""}=o,a=t.getExtension(e);for(const u of Object.keys(i)){const e=`${u}${s}`;let o=null;"meta"===u||"function"===typeof t[u]||(a&&"function"===typeof a[e]?o=(...t)=>a[e](...t):"function"===typeof i[u]&&(o=i[u].bind(r))),o&&(r[u]=o,n[u]=o)}}("undefined"!==typeof r.g?r.g:window).polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(!function(t){if("function"===typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const r=t.getExtension;t.getExtension=function(e){return r.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new sn(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const r of e)t.luma[r]=t.getExtension(r)}(t),function(t,e){for(const r of Object.getOwnPropertyNames(e))"overrides"!==r&&gn(t,{extension:r,target:t.luma,target2:t})}(t,dn),function(t,{target:e,target2:r}){Object.keys(pn).forEach((n=>{if("function"===typeof pn[n]){const i=t[n]?t[n].bind(t):()=>{},o=pn[n].bind(null,t,i);e[n]=o,r[n]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const mn={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},yn=(t,e,r)=>e?t.enable(r):t.disable(r),vn=(t,e,r)=>t.hint(r,e),bn=(t,e,r)=>t.pixelStorei(r,e);function _n(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const wn={3042:yn,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:yn,2885:(t,e)=>t.cullFace(e),2929:yn,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:yn,35723:vn,36006:(t,e)=>{const r=Jr(t)?36009:36160;return t.bindFramebuffer(r,e)},2886:(t,e)=>t.frontFace(e),33170:vn,2849:(t,e)=>t.lineWidth(e),32823:yn,32824:"polygonOffset",10752:"polygonOffset",35977:yn,32938:"sampleCoverage",32939:"sampleCoverage",3089:yn,3088:(t,e)=>t.scissor(...e),2960:yn,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:bn,3317:bn,37440:bn,37441:bn,37443:bn,3330:bn,3332:bn,3331:bn,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:bn,32878:bn,3316:bn,3315:bn,32877:bn,framebuffer:(t,e)=>{const r=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,r)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=_n(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=_n(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=_n(e)?e:[e,e];const[r,n]=e;t.stencilMaskSeparate(1028,r),t.stencilMaskSeparate(1029,n)},stencilFunc:(t,e)=>{e=_n(e)&&3===e.length?[...e,...e]:e;const[r,n,i,o,s,a]=e;t.stencilFuncSeparate(1028,r,n,i),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=_n(e)&&3===e.length?[...e,...e]:e;const[r,n,i,o,s,a]=e;t.stencilOpSeparate(1028,r,n,i),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function xn(t,e,r){return void 0!==e[t]?e[t]:r[t]}const En={blendEquation:(t,e,r)=>t.blendEquationSeparate(xn(32777,e,r),xn(34877,e,r)),blendFunc:(t,e,r)=>t.blendFuncSeparate(xn(32969,e,r),xn(32968,e,r),xn(32971,e,r),xn(32970,e,r)),polygonOffset:(t,e,r)=>t.polygonOffset(xn(32824,e,r),xn(10752,e,r)),sampleCoverage:(t,e,r)=>t.sampleCoverage(xn(32938,e,r),xn(32939,e,r)),stencilFuncFront:(t,e,r)=>t.stencilFuncSeparate(1028,xn(2962,e,r),xn(2967,e,r),xn(2963,e,r)),stencilFuncBack:(t,e,r)=>t.stencilFuncSeparate(1029,xn(34816,e,r),xn(36003,e,r),xn(36004,e,r)),stencilOpFront:(t,e,r)=>t.stencilOpSeparate(1028,xn(2964,e,r),xn(2965,e,r),xn(2966,e,r)),stencilOpBack:(t,e,r)=>t.stencilOpSeparate(1029,xn(34817,e,r),xn(34818,e,r),xn(34819,e,r))},Pn={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,r)=>t({[e]:r}),hint:(t,e,r)=>t({[e]:r}),bindFramebuffer:(t,e,r)=>{switch(e){case 36160:return t({36006:r,36010:r});case 36009:return t({36006:r});case 36008:return t({36010:r});default:return null}},blendColor:(t,e,r,n,i)=>t({32773:new Float32Array([e,r,n,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,r)=>t({32777:e,34877:r}),blendFunc:(t,e,r)=>t({32969:e,32968:r,32971:e,32970:r}),blendFuncSeparate:(t,e,r,n,i)=>t({32969:e,32968:r,32971:n,32970:i}),clearColor:(t,e,r,n,i)=>t({3106:new Float32Array([e,r,n,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,r,n,i)=>t({3107:[e,r,n,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,r)=>t({2928:new Float32Array([e,r])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,r)=>t({32824:e,10752:r}),sampleCoverage:(t,e,r)=>t({32938:e,32939:r}),scissor:(t,e,r,n,i)=>t({3088:new Int32Array([e,r,n,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,r)=>t({[1028===e?2968:36005]:r}),stencilFunc:(t,e,r,n)=>t({2962:e,2967:r,2963:n,34816:e,36003:r,36004:n}),stencilFuncSeparate:(t,e,r,n,i)=>t({[1028===e?2962:34816]:r,[1028===e?2967:36003]:n,[1028===e?2963:36004]:i}),stencilOp:(t,e,r,n)=>t({2964:e,2965:r,2966:n,34817:e,34818:r,34819:n}),stencilOpSeparate:(t,e,r,n,i)=>t({[1028===e?2964:34817]:r,[1028===e?2965:34818]:n,[1028===e?2966:34819]:i}),viewport:(t,e,r,n,i)=>t({2978:[e,r,n,i]})},Mn=(t,e)=>t.isEnabled(e),Sn={3042:Mn,2884:Mn,2929:Mn,3024:Mn,32823:Mn,32926:Mn,32928:Mn,3089:Mn,2960:Mn,35977:Mn};function On(t){for(const e in t)return!1;return!0}function An(t,e){if(t===e)return!0;const r=Array.isArray(t)||ArrayBuffer.isView(t),n=Array.isArray(e)||ArrayBuffer.isView(e);if(r&&n&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function Tn(t,e){const r=t[e].bind(t);t[e]=function(...e){const n=e[0];return n in t.state.cache&&t.state.enable?t.state.cache[n]:r(...e)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function kn(t,e,r){const n=t[e].bind(t);t[e]=function(...e){const{valueChanged:i,oldValue:o}=r(t.state._updateCache,...e);return i&&n(...e),o},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}class Cn{constructor(t,{copyState:e=!1,log:r=(()=>{})}={}){this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?function(t,e){if("number"===typeof(e=e||mn)){const r=e,n=Sn[r];return n?n(t,r):t.getParameter(r)}const r=Array.isArray(e)?e:Object.keys(e),n={};for(const i of r){const e=Sn[i];n[i]=e?e(t,Number(i)):t.getParameter(Number(i))}return n}(t):Object.assign({},mn),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){qr(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Rn(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,r=!1;const n=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const i in t){qr(void 0!==i);const o=t[i],s=this.cache[i];An(o,s)||(r=!0,e=s,n&&!(i in n)&&(n[i]=s),this.cache[i]=o)}return{valueChanged:r,oldValue:e}}}function jn(t,e={}){const{enable:n=!0,copyState:i}=e;if(qr(void 0!==i),!t.state){const e="undefined"!==typeof r.g?r.g:window,{polyfillContext:n}=e;n&&n(t),t.state=new Cn(t,{copyState:i}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}(t);for(const r in Pn){kn(t,r,Pn[r])}Tn(t,"getParameter"),Tn(t,"isEnabled")}return t.state.enable=n,t}function In(t){qr(t.state),t.state.pop()}function Rn(t,e){if(qr(Qr(t),"setParameters requires a WebGL context"),On(e))return;const r={};for(const i in e){const n=Number(i),o=wn[i];o&&("string"===typeof o?r[o]=!0:o(t,e[i],n))}const n=t.state&&t.state.cache;if(n)for(const i in r){(0,En[i])(t,e,n)}}function Ln(t,e,r){if(On(e))return r(t);const{nocatch:n=!0}=e;let i;if(function(t){t.state||jn(t,{copyState:!1}),t.state.push()}(t),Rn(t,e),n)i=r(t),In(t);else try{i=r(t)}finally{In(t)}return i}function Dn(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:r}=e.canvasSizeInfo;return r?t.drawingBufferWidth/r:1}return 1}function Fn(t,e,r=!0){return function(t,e,r,n,i){const o=Nn(t[0],e,r);let s=Bn(t[1],e,n,i),a=Nn(t[0]+1,e,r);const u=a===r-1?a:a-1;let c;a=Bn(t[1]+1,e,n,i),i?(a=0===a?a:a+1,c=s,s=a):c=a===n-1?a:a-1;return{x:o,y:s,width:Math.max(u-o+1,1),height:Math.max(c-s+1,1)}}(e,Dn(t),t.drawingBufferWidth,t.drawingBufferHeight,r)}function Nn(t,e,r){return Math.min(Math.round(t*e),r-1)}function Bn(t,e,r,n){return n?Math.max(0,r-1-Math.round(t*e)):Math.min(Math.round(t*e),r-1)}const zn=_(),Un=zn&&"undefined"!==typeof document,Vn={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Gn(t={}){qr(zn,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},Vn,t);const{width:e,height:r}=t;function n(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let i;t.onError=n;const{canvas:o}=t;return i=function(t,e){const{onError:r}=e;let n=null;const i=t=>n=t.statusMessage||n;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e));o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e));if(t.removeEventListener("webglcontextcreationerror",i,!1),!a)return r(`Failed to create ${s&&!o?"WebGL2":"WebGL"} context: ${n||"Unknown error"}`);e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1);e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1);return a}(function({canvas:t,width:e=800,height:r=600,onError:n}){let i;if("string"===typeof t){Un&&"complete"===document.readyState||n(`createGLContext called on canvas '${t}' before page was loaded`),i=document.getElementById(t)}else t?i=t:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(r)?`${r}px`:"100%",document.body.insertBefore(i,document.body.firstChild));return i}({canvas:o,width:e,height:r,onError:n}),t),i?(i=Wn(i,t),function(t){const e=Jr(t)?"WebGL2":"WebGL1",r=function(t){const e=t.getParameter(7936),r=t.getParameter(7937),n=t.getExtension("WEBGL_debug_renderer_info"),i=n&&t.getParameter(n.UNMASKED_VENDOR_WEBGL||7936),o=n&&t.getParameter(n.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:o||r,vendorMasked:e,rendererMasked:r,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),n=r?`(${r.vendor},${r.renderer})`:"",i=t.debug?" debug":"";Hr.info(1,`${e}${i} context ${n}`)()}(i),i):null}function Wn(t,e={}){if(!t||t._instrumented)return t;t._version=t._version||function(t){if("undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)return 2;return 1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Vn,e);const{manageState:r,debug:n}=e;return r&&jn(t,{copyState:!1,log:(...t)=>Hr.log(1,...t)()}),zn&&n&&(T.makeDebugContext?(t=T.makeDebugContext(t,e),Hr.level=Math.max(Hr.level,1)):Hr.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function Zn(t,e={}){if(t.canvas){return void function(t,e,r){let n="width"in r?r.width:t.canvas.clientWidth,i="height"in r?r.height:t.canvas.clientHeight;n&&i||(Hr.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,n=t.canvas.width||1,i=t.canvas.height||1);t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==n||o.clientHeight!==i||o.devicePixelRatio!==e){let r=e;const o=Math.floor(n*r),s=Math.floor(i*r);t.canvas.width=o,t.canvas.height=s,t.drawingBufferWidth===o&&t.drawingBufferHeight===s||(Hr.warn("Device pixel ratio clamped")(),r=Math.min(t.drawingBufferWidth/n,t.drawingBufferHeight/i),t.canvas.width=Math.floor(n*r),t.canvas.height=Math.floor(i*r)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:n,clientHeight:i,devicePixelRatio:e})}}(t,function(t){const e="undefined"===typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels),e)}const r=t.getExtension("STACKGL_resize_drawingbuffer");r&&"width"in e&&"height"in e&&r.resize(e.width,e.height)}const $n="8.5.10";const Xn=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new K({id:t})),this.stats.get(t)}};if(T.luma&&T.luma.VERSION!==$n)throw new Error(`luma.gl - multiple VERSIONs detected: ${T.luma.VERSION} vs 8.5.10`);T.luma||(_()&&Hr.log(1,"luma.gl 8.5.10 - set luma.log.level=1 (or higher) to trace rendering")(),T.luma=T.luma||{VERSION:$n,version:$n,log:Hr,stats:Xn,globals:{modules:{},nodeIO:{}}});T.luma;function Yn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Hn(t,e){if("string"!==typeof e)return e;const r=Number(e);if(!isNaN(r))return r;const n=t[e=e.replace(/^.*\./,"")];return Yn(void 0!==n,`Accessing undefined constant GL.${e}`),n}function qn(t,e){e=Number(e);for(const r in t)if(t[r]===e)return`GL.${r}`;return String(e)}const Kn={};function Qn(t="id"){Kn[t]=Kn[t]||1;return`${t}-${Kn[t]++}`}function Jn(t){return Yn("number"===typeof t,"Input must be a number"),t&&0===(t&t-1)}function ti(t){let e=!0;for(const r in t){e=!1;break}return e}function ei(t,e,r,n){const i=`See luma.gl ${r} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,o=Object.getPrototypeOf(t);n.forEach((t=>{o.methodName||(o[t]=()=>{throw Hr.removed(`Calling removed method ${e}.${t}: `,i)(),new Error(t)})}))}const ri="Resource subclass must define virtual methods";class ni{constructor(t,e={}){tn(t);const{id:r,userData:n={}}=e;this.gl=t,this.gl2=t,this.id=r||Qn(this.constructor.name),this.userData=n,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:t=!1}={}){const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(t=this.handle){if("function"!==typeof t)return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t,e={}){Yn(t=Hn(this.gl,t));const r=(this.constructor.PARAMETERS||{})[t];if(r){const t=Jr(this.gl);if(!((!("webgl2"in r)||t)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const e=r.webgl1,n="webgl2"in r?r.webgl2:r.webgl1;return t?n:e}}return this._getParameter(t,e)}getParameters(t={}){const{parameters:e,keys:r}=t,n=this.constructor.PARAMETERS||{},i=Jr(this.gl),o={},s=e||Object.keys(n);for(const a of s){const e=n[a];if(e&&(!("webgl2"in e)||i)&&(!("extension"in e)||this.gl.getExtension(e.extension))){const n=r?qn(this.gl,a):a;o[n]=this.getParameter(a,t),r&&"GLenum"===e.type&&(o[n]=qn(this.gl,o[n]))}}return o}setParameter(t,e){Yn(t=Hn(this.gl,t));const r=(this.constructor.PARAMETERS||{})[t];if(r){const t=Jr(this.gl);if(!((!("webgl2"in r)||t)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(e=Hn(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,r){return ei(this,t,e,r)}initialize(t){}_createHandle(){throw new Error(ri)}_deleteHandle(){throw new Error(ri)}_bindHandle(t){throw new Error(ri)}_getOptsFromHandle(){throw new Error(ri)}_getParameter(t,e){throw new Error(ri)}_setParameter(t,e){throw new Error(ri)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this.constructor.name,e=Xn.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}_removeStats(){const t=this.constructor.name;Xn.get("Resource Counts").get(`${t}s Active`).decrementCount()}_trackAllocatedMemory(t,e=this.constructor.name){const r=Xn.get("Memory Usage");r.get("GPU Memory").addCount(t),r.get(`${e} Memory`).addCount(t),this.byteLength=t}_trackDeallocatedMemory(t=this.constructor.name){const e=Xn.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get(`${t} Memory`).subtractCount(this.byteLength),this.byteLength=0}}function ii(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function oi(t,{clamped:e=!0}={}){switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function si({data:t,width:e,height:r}){const n=Math.round(e/2),i=Math.round(r/2),o=new Uint8Array(n*i*4);for(let s=0;s<i;s++)for(let r=0;r<n;r++)for(let i=0;i<4;i++)o[4*(s*n+r)+i]=t[4*(2*s*e+2*r)+i];return{data:o,width:n,height:i}}function ai(t,e,r){const{removedProps:n={},deprecatedProps:i={},replacedProps:o={}}=r;for(const a in n)if(a in e){const e=n[a]?`${t}.${n[a]}`:"N/A";Hr.removed(`${t}.${a}`,e)()}for(const a in i)if(a in e){const e=i[a];Hr.deprecated(`${t}.${a}`,`${t}.${e}`)()}let s=null;for(const a in o)if(a in e){const r=o[a];Hr.deprecated(`${t}.${a}`,`${t}.${r}`)(),s=s||Object.assign({},e),s[r]=e[a],delete s[a]}return s||e}const ui={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},ci={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class li{static getBytesPerElement(t){return oi(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){Yn(t.size);return oi(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new li(...[ui,...t])}constructor(...t){t.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return li.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return li.getBytesPerVertex(this)}_assign(t={}){return void 0!==(t=ai("Accessor",t,ci)).type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"===typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}const hi={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},fi={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:hi},di={removedProps:hi};class pi extends ni{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(t=this.accessor){return Math.round(this.byteLength/li.getBytesPerElement(t))}getVertexCount(t=this.accessor){return Math.round(this.byteLength/li.getBytesPerVertex(t))}initialize(t={}){return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=ai("Buffer",t,fi),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=ai("Buffer",t,di))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new li(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:r=0,srcOffset:n=0}=t,i=t.byteLength||t.length;Yn(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==n||void 0!==i?(en(this.gl),this.gl.bufferSubData(this.target,r,e,n,i)):this.gl.bufferSubData(o,r,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData({sourceBuffer:t,readOffset:e=0,writeOffset:r=0,size:n}){const{gl:i}=this;return en(i),i.bindBuffer(36662,t.handle),i.bindBuffer(36663,this.handle),i.copyBufferSubData(36662,36663,e,r,n),i.bindBuffer(36662,null),i.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:t=null,srcByteOffset:e=0,dstOffset:r=0,length:n=0}={}){en(this.gl);const i=oi(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(e),s=r;let a,u;t?(u=t.length,a=u-s):(a=Math.min(o,n||o),u=s+a);const c=Math.min(o,a);return Yn((n=n||c)<=c),t=t||new i(u),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,r,n),this.gl.bindBuffer(36662,null),t}bind({target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:r=0,size:n}={}){return 35345===t||35982===t?void 0!==n?this.gl.bindBufferRange(t,e,this.handle,r,n):(Yn(0===r),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind({target:t=this.target,index:e=this.accessor&&this.accessor.index}={}){return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t,e=0,r=t.byteLength+e){Yn(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const n=this._getTarget();this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.usage),this.gl.bufferSubData(n,e,t),this.gl.bindBuffer(n,null),this.debugData=t.slice(0,10),this.bytesUsed=r,this._trackAllocatedMemory(r);const i=ii(t);return Yn(i),this.setAccessor(new li(this.accessor,{type:i})),this}_setByteLength(t,e=this.usage){Yn(t>=0),this._trackDeallocatedMemory();let r=t;0===t&&(r=new Float32Array(0));const n=this._getTarget();return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,e),this.gl.bindBuffer(n,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/oi(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new li(this.accessor,{type:ii(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return Hr.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Hr.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return Hr.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return Hr.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new li(this.accessor,t),this}}const gi={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},mi={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},yi={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};const vi=[9729,9728],bi=T.WebGLBuffer||function(){};class _i extends ni{static isSupported(t,e={}){const{format:r,linearFiltering:n}=e;let i=!0;return r&&(i=i&&function(t,e){const r=gi[e];if(!r)return!1;if(void 0===r.gl1&&void 0===r.gl2)return!0;const n=Jr(t)&&r.gl2||r.gl1;return"string"===typeof n?t.getExtension(n):n}(t,r),i=i&&(!n||function(t,e){const r=gi[e];switch(r&&r.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(t,r))),i}constructor(t,e){const{id:r=Qn("texture"),handle:n,target:i}=e;super(t,{id:r,handle:n}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(t={}){let e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const r="undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(r&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:n=null,format:i=6408,border:o=0,recreate:s=!1,parameters:a={},pixelStore:u={},textureUnit:c}=t;e||(e=n);let{width:l,height:h,dataFormat:f,type:d,compressed:p=!1,mipmaps:g=!0}=t;const{depth:m=0}=t;return({width:l,height:h,compressed:p,dataFormat:f,type:d}=this._deduceParameters({format:i,type:d,dataFormat:f,compressed:p,data:e,width:l,height:h})),this.width=l,this.height=h,this.depth=m,this.format=i,this.type=d,this.dataFormat=f,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(Hr.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:e,width:l,height:h,depth:m,format:i,type:d,dataFormat:f,border:o,mipmaps:g,parameters:u,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),s&&(this.data=e),r&&(this._video={video:e,parameters:a,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:r}=this._video;if(r===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize({height:t,width:e,mipmaps:r=!1}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(t={}){return this._isNPOT()?(Hr.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ln(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:r=null,level:n=0,format:i=this.format,border:o=this.border,offset:s=0,parameters:a={}}=t;let{data:u=null,type:c=this.type,width:l=this.width,height:h=this.height,dataFormat:f=this.dataFormat,compressed:d=!1}=t;u||(u=r),({type:c,dataFormat:f,compressed:d,width:l,height:h}=this._deduceParameters({format:i,type:c,dataFormat:f,compressed:d,data:u,width:l,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;if(({data:u,dataType:m}=this._getDataType({data:u,compressed:d})),Ln(this.gl,a,(()=>{switch(m){case"null":p.texImage2D(e,n,i,l,h,o,f,c,u);break;case"typed-array":p.texImage2D(e,n,i,l,h,o,f,c,u,s);break;case"buffer":g=en(p),g.bindBuffer(35052,u.handle||u),g.texImage2D(e,n,i,l,h,o,f,c,s),g.bindBuffer(35052,null);break;case"browser-object":Jr(p)?p.texImage2D(e,n,i,l,h,o,f,c,u):p.texImage2D(e,n,i,f,c,u);break;case"compressed":for(const[t,r]of u.entries())p.compressedTexImage2D(e,t,r.format,r.width,r.height,o,r.data);break;default:Yn(!1,"Unknown image data type")}})),u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const t=mi[this.dataFormat]||4,e=yi[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:e=null,data:r=null,x:n=0,y:i=0,width:o=this.width,height:s=this.height,level:a=0,format:u=this.format,type:c=this.type,dataFormat:l=this.dataFormat,compressed:h=!1,offset:f=0,border:d=this.border,parameters:p={}}){if(({type:c,dataFormat:l,compressed:h,width:o,height:s}=this._deduceParameters({format:u,type:c,dataFormat:l,compressed:h,data:r,width:o,height:s})),Yn(0===this.depth,"texSubImage not supported for 3D textures"),r||(r=e),r&&r.data){const t=r;r=t.data,o=t.shape[0],s=t.shape[1]}r instanceof pi&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Ln(this.gl,p,(()=>{if(h)this.gl.compressedTexSubImage2D(t,a,n,i,o,s,u,r);else if(null===r)this.gl.texSubImage2D(t,a,n,i,o,s,l,c,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(t,a,n,i,o,s,l,c,r,f);else if(r instanceof bi){const e=en(this.gl);e.bindBuffer(35052,r),e.texSubImage2D(t,a,n,i,o,s,l,c,f),e.bindBuffer(35052,null)}else if(Jr(this.gl)){en(this.gl).texSubImage2D(t,a,n,i,o,s,l,c,r)}else this.gl.texSubImage2D(t,a,n,i,l,c,r)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return Hr.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType({data:t,compressed:e=!1}){return e?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof pi?{data:t.handle,dataType:"buffer"}:t instanceof bi?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:r}=t;let{width:n,height:i,dataFormat:o,type:s,compressed:a}=t;const u=gi[e];return o=o||u&&u.dataFormat,s=s||u&&u.types[0],a=a||u&&u.compressed,({width:n,height:i}=this._deduceImageSize(r,n,i)),{dataFormat:o,type:s,compressed:a,width:n,height:i,format:e,data:r}}_deduceImageSize(t,e,r){let n;return n="undefined"!==typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:r}:{width:e>=0?e:1,height:r>=0?r:1},Yn(n,"Could not deduced texture size"),Yn(void 0===e||n.width===e,"Deduced texture width does not match supplied width"),Yn(void 0===r||n.height===r,"Deduced texture height does not match supplied height"),n}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Yn(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!Jr(this.gl)&&(!(!this.width||!this.height)&&(!Jn(this.width)||!Jn(this.height)))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===vi.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}let wi="";class xi extends _i{static isSupported(t,e){return _i.isSupported(t,e)}constructor(t,e={}){var r,n;tn(t),(e instanceof Promise||"string"===typeof e)&&(e={data:e}),"string"===typeof e.data&&(e=Object.assign({},e,{data:(r=e.data,Yn("string"===typeof r),r=wi+r,new Promise(((t,e)=>{try{const i=new Image;i.onload=()=>t(i),i.onerror=()=>e(new Error(`Could not load image ${r}.`)),i.crossOrigin=n&&n.crossOrigin||"anonymous",i.src=r}catch(i){e(i)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const Ei="EXT_color_buffer_float";var Pi={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Ei,bpp:2},33327:{gl2:Ei,bpp:4},34842:{gl2:Ei,bpp:8},33326:{gl2:Ei,bpp:4},33328:{gl2:Ei,bpp:8},34836:{gl2:Ei,bpp:16},35898:{gl2:Ei,bpp:4}};class Mi extends ni{static isSupported(t,{format:e}={format:null}){return!e||function(t,e,r){const n=r[e];if(!n)return!1;const i=Jr(t)&&n.gl2||n.gl1;return"string"===typeof i?t.getExtension(i):i}(t,e,Pi)}static getSamplesForFormat(t,{format:e}){return t.getInternalformatParameter(36161,e,32937)}constructor(t,e={}){super(t,e),this.initialize(e),Object.seal(this)}initialize({format:t,width:e=1,height:r=1,samples:n=0}){return Yn(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==n&&Jr(this.gl)?this.gl.renderbufferStorageMultisample(36161,n,t,e,r):this.gl.renderbufferStorage(36161,t,e,r),this.format=t,this.width=e,this.height=r,this.samples=n,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Pi[this.format].bpp),this}resize({width:t,height:e}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){this.gl.bindRenderbuffer(36161,this.handle);return this.gl.getRenderbufferParameter(36161,t)}}const Si="clear: bad arguments";function Oi(t,{framebuffer:e=null,color:r=null,depth:n=null,stencil:i=null}={}){const o={};e&&(o.framebuffer=e);let s=0;r&&(s|=16384,!0!==r&&(o.clearColor=r)),n&&(s|=256,!0!==n&&(o.clearDepth=n)),i&&(s|=1024,!0!==n&&(o.clearStencil=n)),Yn(0!==s,Si),Ln(t,o,(()=>{t.clear(s)}))}const Ai=[34069,34070,34071,34072,34073,34074];class Ti extends _i{constructor(t,e={}){tn(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(t={}){const{mipmaps:e=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(r)})),this}subImage({face:t,data:e,x:r=0,y:n=0,mipmapLevel:i=0}){return this._subImage({target:t,data:e,x:r,y:n,mipmapLevel:i})}async setCubeMapImageData({width:t,height:e,pixels:r,data:n,border:i=0,format:o=6408,type:s=5121}){const{gl:a}=this,u=r||n,c=await Promise.all(Ai.map((t=>{const e=u[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),Ai.forEach(((r,n)=>{c[n].length>1&&!1!==this.opts.mipmaps&&Hr.warn(`${this.id} has mipmap and multiple LODs.`)(),c[n].forEach(((n,u)=>{t&&e?a.texImage2D(r,u,o,t,e,i,o,s,n):a.texImage2D(r,u,o,o,s,n)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:r,height:n,pixels:i,data:o,border:s=0,format:a=6408,type:u=5121}=t,{gl:c}=this,l=i||o;return this.bind(),l instanceof Promise?l.then((r=>this.setImageDataForFace(Object.assign({},t,{face:e,data:r,pixels:r})))):this.width||this.height?c.texImage2D(e,0,a,r,n,s,a,u,l):c.texImage2D(e,0,a,a,u,l),this}}Ti.FACES=Ai;class ki extends _i{static isSupported(t){return Jr(t)}constructor(t,e={}){en(t),super(t,e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1})),this.initialize(e),Object.seal(this)}setImageData({level:t=0,dataFormat:e=6408,width:r,height:n,depth:i=1,border:o=0,format:s,type:a=5121,offset:u=0,data:c,parameters:l={}}){if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Ln(this.gl,l,(()=>{ArrayBuffer.isView(c)&&this.gl.texImage3D(this.target,t,e,r,n,i,o,s,a,c),c instanceof pi&&(this.gl.bindBuffer(35052,c.handle),this.gl.texImage3D(this.target,t,e,r,n,i,o,s,a,u))})),c&&c.byteLength)this._trackAllocatedMemory(c.byteLength,"Texture");else{const t=mi[this.dataFormat]||4,e=yi[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}function Ci(t,e){const{gl:r,width:n,height:i,id:o}=t;return new Ui(r,Object.assign({},e,{id:`framebuffer-for-${o}`,width:n,height:i,attachments:{36064:t}}))}function ji(t,e={}){const{sourceX:r=0,sourceY:n=0,sourceFormat:i=6408}=e;let{sourceAttachment:o=36064,target:s=null,sourceWidth:a,sourceHeight:u,sourceType:c}=e;const{framebuffer:l,deleteFramebuffer:h}=Ri(t);Yn(l);const{gl:f,handle:d,attachments:p}=l;a=a||l.width,u=u||l.height,36064===o&&null===d&&(o=1028),Yn(p[o]),c=c||p[o].type,s=function(t,e,r,n,i){if(t)return t;const o=oi(e=e||5121,{clamped:!1}),s=function(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Yn(!1),0}}(r);return new o(n*i*s)}(s,c,i,a,u),c=c||ii(s);const g=f.bindFramebuffer(36160,d);return f.readPixels(r,n,a,u,i,c,s),f.bindFramebuffer(36160,g||null),h&&l.delete(),s}function Ii(t,{sourceAttachment:e=36064,targetMaxHeight:r=Number.MAX_SAFE_INTEGER}={}){let n=ji(t,{sourceAttachment:e}),{width:i,height:o}=t;for(;o>r;)({data:n,width:i,height:o}=si({data:n,width:i,height:o}));!function({data:t,width:e,height:r,bytesPerPixel:n=4,temp:i}){const o=e*n;i=i||new Uint8Array(o);for(let s=0;s<r/2;++s){const e=s*o,n=(r-s-1)*o;i.set(t.subarray(e,e+o)),t.copyWithin(e,n,n+o),t.set(i,n)}}({data:n,width:i,height:o});const s=document.createElement("canvas");s.width=i,s.height=o;const a=s.getContext("2d"),u=a.createImageData(i,o);return u.data.set(n),a.putImageData(u,0,0),s.toDataURL()}function Ri(t){return t instanceof Ui?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Ci(t),deleteFramebuffer:!0}}const Li="TIMER_QUERY",Di="ELEMENT_INDEX_UINT32";var Fi={["WEBGL2"]:[!1,!0],["VERTEX_ARRAY_OBJECT"]:["OES_vertex_array_object",!0],[Li]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],["INSTANCED_RENDERING"]:["ANGLE_instanced_arrays",!0],["MULTIPLE_RENDER_TARGETS"]:["WEBGL_draw_buffers",!0],[Di]:["OES_element_index_uint",!0],["BLEND_EQUATION_MINMAX"]:["EXT_blend_minmax",!0],["FLOAT_BLEND"]:["EXT_float_blend"],["COLOR_ENCODING_SRGB"]:["EXT_sRGB",!0],["TEXTURE_DEPTH"]:["WEBGL_depth_texture",!0],["TEXTURE_FLOAT"]:["OES_texture_float",!0],["TEXTURE_HALF_FLOAT"]:["OES_texture_half_float",!0],["TEXTURE_FILTER_LINEAR_FLOAT"]:["OES_texture_float_linear"],["TEXTURE_FILTER_LINEAR_HALF_FLOAT"]:["OES_texture_half_float_linear"],["TEXTURE_FILTER_ANISOTROPIC"]:["EXT_texture_filter_anisotropic"],["COLOR_ATTACHMENT_RGBA32F"]:[function(t){const e=new xi(t,{format:6408,type:5126,dataFormat:6408}),r=new Ui(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),n=r.getStatus();return e.delete(),r.delete(),36053===n},"EXT_color_buffer_float"],["COLOR_ATTACHMENT_FLOAT"]:[!1,"EXT_color_buffer_float"],["COLOR_ATTACHMENT_HALF_FLOAT"]:["EXT_color_buffer_half_float"],["GLSL_FRAG_DATA"]:["WEBGL_draw_buffers",!0],["GLSL_FRAG_DEPTH"]:["EXT_frag_depth",!0],["GLSL_DERIVATIVES"]:["OES_standard_derivatives",!0],["GLSL_TEXTURE_LOD"]:["EXT_shader_texture_lod",!0]};function Ni(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>Bi(t,e)))}function Bi(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const r=Fi[e];let n;Yn(r,e);const i=Jr(t)&&r[1]||r[0];if("function"===typeof i)n=i(t);else if(Array.isArray(i)){n=!0;for(const e of i)n=n&&Boolean(t.getExtension(e))}else"string"===typeof i?n=Boolean(t.getExtension(i)):"boolean"===typeof i?n=i:Yn(!1);return n}(t,e)),t.luma.caps[e]||Hr.log(2,`Feature: ${e} not supported`)(),t.luma.caps[e]}const zi="Multiple render targets not supported";class Ui extends ni{static isSupported(t,e={}){const{colorBufferFloat:r,colorBufferHalfFloat:n}=e;let i=!0;return r&&(i=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),n&&(i=i&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new Ui(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=en(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=en(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t,e={}){super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:t=1,height:e=1,attachments:r=null,color:n=!0,depth:i=!0,stencil:o=!1,check:s=!0,readBuffer:a,drawBuffers:u}){if(Yn(t>=0&&e>=0,"Width and height need to be integers"),this.width=t,this.height=e,r)for(const c in r){const n=r[c];(Array.isArray(n)?n[0]:n).resize({width:t,height:e})}else r=this._createDefaultAttachments(n,i,o,t,e);this.update({clearAttachments:!0,attachments:r,readBuffer:a,drawBuffers:u}),r&&s&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update({attachments:t={},readBuffer:e,drawBuffers:r,clearAttachments:n=!1,resizeAttachments:i=!0}){this.attach(t,{clearAttachments:n,resizeAttachments:i});const{gl:o}=this,s=o.bindFramebuffer(36160,this.handle);return e&&this._setReadBuffer(e),r&&this._setDrawBuffers(r),o.bindFramebuffer(36160,s||null),this}resize(t={}){let{width:e,height:r}=t;if(null===this.handle)return Yn(void 0===e&&void 0===r),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===r&&(r=this.gl.drawingBufferHeight),e!==this.width&&r!==this.height&&Hr.log(2,`Resizing framebuffer ${this.id} to ${e}x${r}`)();for(const n in this.attachments)this.attachments[n].resize({width:e,height:r});return this.width=e,this.height=r,this}attach(t,{clearAttachments:e=!1,resizeAttachments:r=!0}={}){const n={};e&&Object.keys(this.attachments).forEach((t=>{n[t]=null})),Object.assign(n,t);const i=this.gl.bindFramebuffer(36160,this.handle);for(const o in n){Yn(void 0!==o,"Misspelled framebuffer binding point?");const t=Number(o),e=n[t];let i=e;if(i)if(i instanceof Mi)this._attachRenderbuffer({attachment:t,renderbuffer:i});else if(Array.isArray(e)){const[r,n=0,o=0]=e;i=r,this._attachTexture({attachment:t,texture:r,layer:n,level:o})}else this._attachTexture({attachment:t,texture:i,layer:0,level:0});else this._unattach(t);r&&i&&i.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(Ui.STATUS||{})[t]||`Framebuffer error ${t}`}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),r=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),r}clear(t={}){const{color:e,depth:r,stencil:n,drawBuffers:i=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||r||n)&&Oi(this.gl,{color:e,depth:r,stencil:n}),i.forEach(((t,e)=>{!function(t,{framebuffer:e=null,buffer:r=6144,drawBuffer:n=0,value:i=[0,0,0,0]}={}){en(t),Ln(t,{framebuffer:e},(()=>{switch(r){case 6144:switch(i.constructor){case Int32Array:t.clearBufferiv(r,n,i);break;case Uint32Array:t.clearBufferuiv(r,n,i);break;case Float32Array:default:t.clearBufferfv(r,n,i)}break;case 6145:t.clearBufferfv(6145,0,[i]);break;case 6146:t.clearBufferiv(6146,0,[i]);break;case 34041:const[e,o]=i;t.clearBufferfi(34041,0,e,o);break;default:Yn(!1,Si)}}))}(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(t={}){return Hr.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(t={}){return Hr.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(t={}){return Hr.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(t={}){return Hr.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(t={}){return Hr.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(t={}){return Hr.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:t=[],x:e=0,y:r=0,width:n,height:i}){const o=en(this.gl),s=o.bindFramebuffer(36008,this.handle);return 0===e&&0===r&&void 0===n&&void 0===i?o.invalidateFramebuffer(36008,t):o.invalidateFramebuffer(36008,t,e,r,n,i),o.bindFramebuffer(36008,s),this}getAttachmentParameter(t,e,r){let n=this._getAttachmentParameterFallback(e);return null===n&&(this.gl.bindFramebuffer(36160,this.handle),n=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),r&&n>1e3&&(n=qn(this.gl,n)),n}getAttachmentParameters(t=36064,e,r=this.constructor.ATTACHMENT_PARAMETERS||[]){const n={};for(const i of r){n[e?qn(this.gl,i):i]=this.getAttachmentParameter(t,i,e)}return n}getParameters(t=!0){const e=Object.keys(this.attachments),r={};for(const n of e){const e=Number(n);r[t?qn(this.gl,e):e]=this.getAttachmentParameters(e,t)}return r}show(){return"undefined"!==typeof window&&window.open(Ii(this),"luma-debug-texture"),this}log(t=0,e=""){if(t>Hr.level||"undefined"===typeof window)return this;e=e||`Framebuffer ${this.id}`;const r=Ii(this,{targetMaxHeight:100});return Hr.image({logLevel:t,message:e,image:r},e)(),this}bind({target:t=36160}={}){return this.gl.bindFramebuffer(t,this.handle),this}unbind({target:t=36160}={}){return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,r,n,i){let o=null;return t&&(o=o||{},o[36064]=new xi(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:n,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),e&&r?(o=o||{},o[33306]=new Mi(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:n,height:111}),this.ownResources.push(o[33306])):e?(o=o||{},o[36096]=new Mi(this.gl,{id:`${this.id}-depth`,format:33189,width:n,height:i}),this.ownResources.push(o[36096])):r&&Yn(!1),o}_unattach(t){const e=this.attachments[t];e&&(e instanceof Mi?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer({attachment:t=36064,renderbuffer:e}){const{gl:r}=this;r.framebufferRenderbuffer(36160,t,36161,e.handle),this.attachments[t]=e}_attachTexture({attachment:t=36064,texture:e,layer:r,level:n}){const{gl:i}=this;switch(i.bindTexture(e.target,e.handle),e.target){case 35866:case 32879:en(i).framebufferTextureLayer(36160,t,e.target,n,r);break;case 34067:const o=function(t){return t<34069?t+34069:t}(r);i.framebufferTexture2D(36160,t,o,e.handle,n);break;case 3553:i.framebufferTexture2D(36160,t,3553,e.handle,n);break;default:Yn(!1,"Illegal texture type")}i.bindTexture(e.target,null),this.attachments[t]=e}_setReadBuffer(t){const e=Jr(r=this.gl)?r:null;var r;e?e.readBuffer(t):Yn(36064===t||1029===t,zi),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,r=en(e);if(r)r.drawBuffers(t);else{const r=e.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(t):Yn(1===t.length&&(36064===t[0]||1029===t[0]),zi)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=function(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Fi)void 0===t.luma.caps[e]&&(t.luma.caps[e]=Bi(t,e));return t.luma.caps}(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}Ui.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Vi={5126:ro.bind(null,"uniform1fv",Yi,1,no),35664:ro.bind(null,"uniform2fv",Yi,2,no),35665:ro.bind(null,"uniform3fv",Yi,3,no),35666:ro.bind(null,"uniform4fv",Yi,4,no),5124:ro.bind(null,"uniform1iv",Hi,1,no),35667:ro.bind(null,"uniform2iv",Hi,2,no),35668:ro.bind(null,"uniform3iv",Hi,3,no),35669:ro.bind(null,"uniform4iv",Hi,4,no),35670:ro.bind(null,"uniform1iv",Hi,1,no),35671:ro.bind(null,"uniform2iv",Hi,2,no),35672:ro.bind(null,"uniform3iv",Hi,3,no),35673:ro.bind(null,"uniform4iv",Hi,4,no),35674:ro.bind(null,"uniformMatrix2fv",Yi,4,io),35675:ro.bind(null,"uniformMatrix3fv",Yi,9,io),35676:ro.bind(null,"uniformMatrix4fv",Yi,16,io),35678:eo,35680:eo,5125:ro.bind(null,"uniform1uiv",qi,1,no),36294:ro.bind(null,"uniform2uiv",qi,2,no),36295:ro.bind(null,"uniform3uiv",qi,3,no),36296:ro.bind(null,"uniform4uiv",qi,4,no),35685:ro.bind(null,"uniformMatrix2x3fv",Yi,6,io),35686:ro.bind(null,"uniformMatrix2x4fv",Yi,8,io),35687:ro.bind(null,"uniformMatrix3x2fv",Yi,6,io),35688:ro.bind(null,"uniformMatrix3x4fv",Yi,12,io),35689:ro.bind(null,"uniformMatrix4x2fv",Yi,8,io),35690:ro.bind(null,"uniformMatrix4x3fv",Yi,12,io),35678:eo,35680:eo,35679:eo,35682:eo,36289:eo,36292:eo,36293:eo,36298:eo,36299:eo,36300:eo,36303:eo,36306:eo,36307:eo,36308:eo,36311:eo},Gi={},Wi={},Zi={},$i=[0];function Xi(t,e,r,n){1===e&&"boolean"===typeof t&&(t=t?1:0),Number.isFinite(t)&&($i[0]=t,t=$i);const i=t.length;if(i%e&&Hr.warn(`Uniform size should be multiples of ${e}`,t)(),t instanceof r)return t;let o=n[i];o||(o=new r(i),n[i]=o);for(let s=0;s<i;s++)o[s]=t[s];return o}function Yi(t,e){return Xi(t,e,Float32Array,Gi)}function Hi(t,e){return Xi(t,e,Int32Array,Wi)}function qi(t,e){return Xi(t,e,Uint32Array,Zi)}function Ki(t,e,r){const n=Vi[r.type];if(!n)throw new Error(`Unknown GLSL uniform type ${r.type}`);return n().bind(null,t,e)}function Qi(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function Ji(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let r=0;r<e;++r)if(!Number.isFinite(t[r]))return!1;return!0}(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof _i||(t instanceof Mi||t instanceof Ui&&Boolean(t.texture))))}function to(t,e,r){if(Array.isArray(r)||ArrayBuffer.isView(r))if(t[e]){const n=t[e];for(let t=0,e=r.length;t<e;++t)n[t]=r[t]}else t[e]=r.slice();else t[e]=r}function eo(){let t=null;return(e,r,n)=>{const i=t!==n;return i&&(e.uniform1i(r,n),t=n),i}}function ro(t,e,r,n){let i=null,o=null;return(s,a,u)=>{const c=e(u,r),l=c.length;let h=!1;if(null===i)i=new Float32Array(l),o=l,h=!0;else{Yn(o===l,"Uniform length cannot change.");for(let t=0;t<l;++t)if(c[t]!==i[t]){h=!0;break}}return h&&(n(s,t,a,c),i.set(c)),h}}function no(t,e,r,n){t[e](r,n)}function io(t,e,r,n){t[e](r,!1,n)}function oo(t,e="unnamed"){const r=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return r?r[1]:e}function so(t,e,r,n){const i=t.split(/\r?\n/),o={},s={},a=n||oo(e)||"(unnamed)",u=`${function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(r)} shader ${a}`;for(let l=0;l<i.length;l++){const e=i[l];if(e.length<=1)continue;const r=e.split(":"),n=r[0],a=parseInt(r[2],10);if(isNaN(a))throw new Error(`GLSL compilation error in ${u}: ${t}`);"WARNING"!==n?o[a]=e:s[a]=e}const c=function(t,e=1,r=": "){const n=t.split(/\r?\n/),i=String(n.length+e-1).length;return n.map(((t,n)=>{const o=String(n+e),s=o.length;return uo(o,i-s)+r+t}))}(e);return{shaderName:u,errors:ao(o,c),warnings:ao(s,c)}}function ao(t,e){let r="";for(let n=0;n<e.length;n++){const i=e[n];if((t[n+3]||t[n+2]||t[n+1])&&(r+=`${i}\n`,t[n+1])){const e=t[n+1],i=e.split(":",3),o=i[0],s=parseInt(i[1],10)||0;r+=uo(`^^^ ${o}: ${e.substring(i.join(":").length+1).trim()}\n\n`,s)}}return r}function uo(t,e){let r="";for(let n=0;n<e;++n)r+=" ";return`${r}${t}`}class co extends ni{static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Yn(!1),"unknown"}}constructor(t,e){tn(t),Yn("string"===typeof e.source,"Shader: GLSL source code must be a JavaScript string");super(t,{id:oo(e.source,null)||e.id||Qn(`unnamed ${co.getTypeName(e.shaderType)}`)}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize({source:t}){const e=oo(t,null);e&&(this.id=Qn(e)),this._compile(t)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return`${co.getTypeName(this.shaderType)}:${this.id}`}getName(){return oo(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(t=this.source){t.startsWith("#version ")||(t=`#version 100\n${t}`),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);if(!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:r,warnings:n}=so(t,this.source,this.shaderType,this.id);throw Hr.error(`GLSL compilation errors in ${e}\n${r}`)(),Hr.warn(`GLSL compilation warnings in ${e}\n${n}`)(),new Error(`GLSL compilation errors in ${e}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class lo extends co{constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class ho extends co{constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const fo=5126,po=5124,go=5125,mo={[fo]:[fo,1,"float"],35664:[fo,2,"vec2"],35665:[fo,3,"vec3"],35666:[fo,4,"vec4"],[po]:[po,1,"int"],35667:[po,2,"ivec2"],35668:[po,3,"ivec3"],35669:[po,4,"ivec4"],[go]:[go,1,"uint"],36294:[go,2,"uvec2"],36295:[go,3,"uvec3"],36296:[go,4,"uvec4"],35670:[fo,1,"bool"],35671:[fo,2,"bvec2"],35672:[fo,3,"bvec3"],35673:[fo,4,"bvec4"],35674:[fo,8,"mat2"],35685:[fo,8,"mat2x3"],35686:[fo,8,"mat2x4"],35675:[fo,12,"mat3"],35687:[fo,12,"mat3x2"],35688:[fo,12,"mat3x4"],35676:[fo,16,"mat4"],35689:[fo,16,"mat4x2"],35690:[fo,16,"mat4x3"]};function yo(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return Yn(!1),0}}function vo(t){const e=mo[t];if(!e)return null;const[r,n]=e;return{type:r,components:n}}function bo(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=fo}for(const r in mo){const[n,i,o]=mo[r];if(n===t&&i===e)return{glType:r,name:o}}return null}class _o{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,r=e.getProgramParameter(t.handle,35721);for(let n=0;n<r;n++){const{name:r,type:i,size:o}=e.getActiveAttrib(t.handle,n),s=e.getAttribLocation(t.handle,r);s>=0&&this._addAttribute(s,r,i,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!Jr(e))return;const r=e.getProgramParameter(t.handle,35971);for(let n=0;n<r;n++){const{name:r,type:i,size:o}=e.getTransformFeedbackVarying(t.handle,n);this._addVarying(n,r,i,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,r,n){const{type:i,components:o}=vo(r),s={type:i,size:n*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new li(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,r){/instance/i.test(e)&&(r.divisor=1)}_addVarying(t,e,r,n){const{type:i,components:o}=vo(r),s={location:t,name:e,accessor:new li({type:i,size:n*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const wo=35981,xo=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Eo extends ni{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Program","v6.0",xo),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(t={}){const{hash:e,vs:r,fs:n,varyings:i,bufferMode:o=wo}=t;return this.hash=e||"",this.vs="string"===typeof r?new lo(this.gl,{id:`${t.id}-vs`,source:r}):r,this.fs="string"===typeof n?new ho(this.gl,{id:`${t.id}-fs`,source:n}):n,Yn(this.vs instanceof lo),Yn(this.fs instanceof ho),this.uniforms={},this._textureUniforms={},i&&i.length>0&&(en(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new _o(this),this.setProps(t)}delete(t={}){return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw({logPriority:t,drawMode:e=4,vertexCount:r,offset:n=0,start:i,end:o,isIndexed:s=!1,indexType:a=5123,instanceCount:u=0,isInstanced:c=u>0,vertexArray:l=null,transformFeedback:h,framebuffer:f,parameters:d={},uniforms:p,samplers:g}){if((p||g)&&(Hr.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(p||{})),Hr.priority>=t){const n=f?f.id:"default",i=`mode=${qn(this.gl,e)} verts=${r} instances=${u} indexType=${qn(this.gl,a)} isInstanced=${c} isIndexed=${s} Framebuffer=${n}`;Hr.log(t,i)()}return Yn(l),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===r||c&&0===u)&&(l.bindForDraw(r,u,(()=>{if(void 0!==f&&(d=Object.assign({},d,{framebuffer:f})),h){const t=yo(e);h.begin(t)}this._bindTextures(),Ln(this.gl,d,(()=>{s&&c?this.gl2.drawElementsInstanced(e,r,a,n,u):s&&Jr(this.gl)&&!isNaN(i)&&!isNaN(o)?this.gl2.drawRangeElements(e,i,o,r,a,n):s?this.gl.drawElements(e,r,a,n):c?this.gl2.drawArraysInstanced(e,n,r,u):this.gl.drawArrays(e,n,r)})),h&&h.end()})),!0)}setUniforms(t={}){Hr.priority>=2&&function(t,e,r){for(const n in t){const i=t[n];if((!r||Boolean(r[n]))&&!Ji(i))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${n}`,i),new Error(`${e} Bad uniform ${n}`)}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const r=t[e],n=this._uniformSetters[e];if(n){let t=r,i=!1;if(t instanceof Ui&&(t=t.texture),t instanceof _i)if(i=this.uniforms[e]!==r,i){void 0===n.textureIndex&&(n.textureIndex=this._textureIndexCounter++);const r=t,{textureIndex:i}=n;r.bind(i),t=i,this._textureUniforms[e]=r}else t=n.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(n(t)||i)&&to(this.uniforms,e,r)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const r=this._textureUniforms[e];r.update(),t=t&&r.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),r={};for(const n of e){switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new lo({handle:n});break;case 35632:r.fs=new ho({handle:n})}}return r}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=Qn(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?`${t}-program`:"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),Hr.time(4,`linkProgram for ${this._getName()}`)(),t.linkProgram(this.handle),Hr.timeEnd(4,`linkProgram for ${this._getName()}`)(),t.debug||Hr.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${t.getProgramInfoLog(this.handle)}`);t.validateProgram(this.handle);if(!t.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${t.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const r=this.gl.getActiveUniform(this.handle,e),{name:n}=Qi(r.name);let i=t.getUniformLocation(this.handle,n);if(this._uniformSetters[n]=Ki(t,i,r),r.size>1)for(let e=0;e<r.size;e++)i=t.getUniformLocation(this.handle,`${n}[${e}]`),this._uniformSetters[`${n}[${e}]`]=Ki(t,i,r)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}class Po{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new Po(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"===typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(t={}){const{vs:e="",fs:r="",defines:n={},inject:i={},varyings:o=[],bufferMode:s=35981,transpileToGLSL100:a=!1}=t,u=this._getModuleList(t.modules),c=this._getHash(e),l=this._getHash(r),h=u.map((t=>this._getHash(t.name))).sort(),f=o.map((t=>this._getHash(t))),d=Object.keys(n).sort(),p=Object.keys(i).sort(),g=[],m=[];for(const v of d)g.push(this._getHash(v)),g.push(this._getHash(n[v]));for(const v of p)m.push(this._getHash(v)),m.push(this._getHash(i[v]));const y=`${c}/${l}D${g.join("/")}M${h.join("/")}I${m.join("/")}V${f.join("/")}H${this.stateHash}B${s}${a?"T":""}`;if(!this._programCache[y]){const t=function(t,e){const{vs:r,fs:n}=e,i=yr(e.modules||[]);return{gl:t,vs:Xr(t,Object.assign({},e,{source:r,type:lr,modules:i})),fs:Xr(t,Object.assign({},e,{source:n,type:hr,modules:i})),getUniforms:Yr(i)}}(this.gl,{vs:e,fs:r,modules:u,inject:i,defines:n,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[y]=new Eo(this.gl,{hash:y,vs:t.vs,fs:t.fs,varyings:o,bufferMode:s}),this._getUniforms[y]=t.getUniforms||(t=>{}),this._useCounts[y]=0}return this._useCounts[y]++,this._programCache[y]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(t=[]){const e=new Array(this._defaultModules.length+t.length),r={};let n=0;for(let i=0,o=this._defaultModules.length;i<o;++i){const t=this._defaultModules[i],o=t.name;e[n++]=t,r[o]=!0}for(let i=0,o=t.length;i<o;++i){const o=t[i],s=o.name;r[s]||(e[n++]=o,r[s]=!0)}return e.length=n,e}}const Mo={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null};var So={name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"};const Oo=Object.keys(er).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(er[t],";"))).join(""),Ao=Object.keys(rr).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(rr[t],";"))).join(""),To=Object.keys(nr).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(nr[t],";"))).join("");var ko="".concat(Oo,"\n").concat(Ao,"\n").concat(To,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);\n      return 1.0 / cos(radians(y));\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),Co="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function jo(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});!function(){var t=function(){var t=new Co(4);return Co!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();function Io(t,e){if(t===e)return!0;if(Array.isArray(t)){const r=t.length;if(!e||e.length!==r)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}return!1}function Ro(t){let e,r={};return n=>{for(const i in n)if(!Io(n[i],r[i])){e=t(n),r=n;break}return e}}const Lo=[0,0,0,0],Do=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Fo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],No=[0,0,0],Bo=[0,0,0],zo=Ro((function({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:n}){const{projectionCenter:i,viewProjectionMatrix:o,originCommon:s,cameraPosCommon:a,shaderCoordinateOrigin:u,geospatialOrigin:c}=function(t,e,r){const{viewMatrixUncentered:n,projectionMatrix:i}=t;let{viewMatrix:o,viewProjectionMatrix:s}=t,a=Lo,u=Lo,c=t.cameraPosition;const{geospatialOrigin:l,shaderCoordinateOrigin:h,offsetMode:f}=Uo(t,e,r);f&&(u=t.projectPosition(l||h),c=[c[0]-u[0],c[1]-u[1],c[2]-u[2]],u[3]=1,a=jo([],u,s),o=n||o,s=Je([],i,o),s=Je([],s,Do));return{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,originCommon:u,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:l}}(t,r,n),l=t.getDistanceScales(),h=[t.width*e,t.height*e],f=jo([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,d={project_uCoordinateSystem:r,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:u,project_uCommonOrigin:s.slice(0,3),project_uCenter:i,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:l.unitsPerMeter,project_uCommonUnitsPerWorldUnit:l.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:No,project_uScale:t.scale,project_uViewProjectionMatrix:o,project_uCameraPosition:a};if(c){const e=t.getDistanceScales(c);switch(r){case er.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case er.LNGLAT:case er.LNGLAT_OFFSETS:t._pseudoMeters||(d.project_uCommonUnitsPerMeter=e.unitsPerMeter),d.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case er.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return d}));function Uo(t,e,r=Bo){r.length<3&&(r=[r[0],r[1],0]);let n,i=r,o=!0;switch(n=e===er.LNGLAT_OFFSETS||e===er.METER_OFFSETS?r:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case rr.WEB_MERCATOR:e!==er.LNGLAT&&e!==er.CARTESIAN||(n=[0,0,0],o=!1);break;case rr.WEB_MERCATOR_AUTO_OFFSET:e===er.LNGLAT?i=n:e===er.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],n=t.unprojectPosition(i),i[0]-=r[0],i[1]-=r[1],i[2]-=r[2]);break;case rr.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case rr.GLOBE:o=!1,n=null;break;default:o=!1}return{geospatialOrigin:n,shaderCoordinateOrigin:i,offsetMode:o}}const Vo={};var Go={name:"project",dependencies:[Mo,So],vs:ko,getUniforms:function(t=Vo){return t.viewport?function({viewport:t,devicePixelRatio:e=1,modelMatrix:r=null,coordinateSystem:n=er.DEFAULT,coordinateOrigin:i,autoWrapLongitude:o=!1}={}){n===er.DEFAULT&&(n=t.isGeospatial?er.LNGLAT:er.CARTESIAN);const s=zo({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i});return s.project_uWrapLongitude=o,s.project_uModelMatrix=r||Fo,s}(t):{}}};const Wo=[Go],Zo=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function $o(t){const e=Po.getDefaultProgramManager(t);for(const r of Wo)e.addDefaultModule(r);for(const r of Zo)e.addShaderHook(r);return e}const Xo=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class Yo{constructor(t,{deck:e,stats:r,viewport:n,timeline:i}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new ye({gl:t,protocol:"deck://"}),this.context={...Xo,layerManager:this,gl:t,deck:e,programManager:t&&$o(t),stats:r||new K({id:"deck.gl"}),viewport:n||new cr({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:i||new u,resourceManager:this.resourceManager},this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const n=r.getNeedsRedraw(t);e=e||n}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t=null}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){W("layerManager.setLayers",this,e,t),this.lastRenderedLayers=t,t=Z(t,Boolean);for(const r of t)r.context=this.context;return this._updateLayers(this.layers,t),this}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this.lastRenderedLayers,t)),this._nextLayers=null}activateViewport(t){return W("layerManager.activateViewport",this,t),t&&(this.context.viewport=t),this}_handleError(t,e,r){r.raiseError(e,"".concat(t," of ").concat(r))}_updateLayers(t,e){const r={};for(const o of t)r[o.id]?V.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const n=[];this._updateSublayersRecursively(e,r,n),this._finalizeOldLayers(r);let i=!1;for(const o of n)if(o.hasUniformTransition()){i=!0;break}this._needsUpdate=i,this.layers=n}_updateSublayersRecursively(t,e,r){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&V.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let o=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite&&i.getSubLayers()}catch(n){this._handleError("matching",n,i)}o&&this._updateSublayersRecursively(o,e,r)}}_finalizeOldLayers(t){for(const e in t){const r=t[e];r&&this._finalizeLayer(r)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=h}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=l,e!==t&&(t.lifecycle=f)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=d;try{t._finalize(),t.lifecycle=p}catch(e){this._handleError("finalization",e,t)}}}function Ho(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const r in t){const n=t[r],i=e[r];if(!(n===i||Array.isArray(n)&&Array.isArray(i)&&Ho(n,i)))return!1}return!0}class qo{constructor(t={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return"string"===typeof t?this.views.find((e=>e.id===t)):t}getViewState(t){const e=this.getView(t),r=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(r):r}getViewport(t){return this._viewportMap[t]}unproject(t,e){const r=this.getViewports(),n={x:t[0],y:t[1]};for(let i=r.length-1;i>=0;--i){const o=r[i];if(o.containsPixel(n)){const r=t.slice();return r[0]-=o.x,r[1]-=o.y,o.unproject(r,e)}}return null}setProps(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=Z(t,Boolean);this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){if(t){!Ho(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t}else V.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(e)}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>t._getViewport(e,{width:e.width,height:e.height}),...e})}_updateController(t,e,r,n){let i=t.controller;return i?(i={...e,...t.props,...i,id:t.id,x:r.x,y:r.y,width:r.width,height:r.height},n?n.setProps(i):n=this._createController(t,i),n):null}_rebuildViewports(){const{width:t,height:e,views:r}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let o=r.length;o--;){const s=r[o],a=this.getViewState(s),u=s.makeViewport({width:t,height:e,viewState:a});let c=n[s.id];s.controller&&!c&&(i=!0),!i&&s.controller||!c||(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,a,u,c),this._viewports.unshift(u)}for(const o in n)n[o]&&!this.controllers[o]&&n[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((r,n)=>!t[n].equals(e[n])))}}const Ko=/([0-9]+\.?[0-9]*)(%|px)/;function Qo(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=t.match(Ko);if(e&&e.length>=3){const t="%"===e[2],r=parseFloat(e[1]);return{position:t?r/100:r,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function Jo(t,e){return t.relative?Math.round(t.position*e):t.position}function ts(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class es{constructor(t={}){const{id:e=null,x:r=0,y:n=0,width:i="100%",height:o="100%",viewportInstance:s,type:a=cr}=t;ts(!s||s instanceof cr),this.viewportInstance=s,this.id=e||this.constructor.displayName||"view",this.type=a,this.props={...t,id:this.id},this._parseDimensions({x:r,y:n,width:i,height:o}),this.equals=this.equals.bind(this),Object.seal(this)}equals(t){if(this===t)return!0;if(this.viewportInstance)return t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance);return Ho(this.props,t.props)}makeViewport({width:t,height:e,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const n=this.getDimensions({width:t,height:e});return this._getViewport(r,n)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(t){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){return{x:Jo(this._x,t),y:Jo(this._y,e),width:Jo(this._width,t),height:Jo(this._height,e)}}_getControllerProps(t){let e=this.props.controller;return e?!0===e?t:("function"===typeof e&&(e={type:e}),{...t,...e}):null}_getViewport(t,e){const{type:r}=this;return new r({...t,...this.props,...e})}_parseDimensions({x:t,y:e,width:r,height:n}){this._x=Qo(t),this._y=Qo(e),this._width=Qo(r),this._height=Qo(n)}}function rs(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}!function(){var t=function(){var t=new Co(2);return Co!=Float32Array&&(t[0]=0,t[1]=0),t}()}();const ns=Math.PI/180;function is(t){return 512/4003e4/Math.cos(t*ns)}class os extends cr{constructor(t={}){const{latitude:e=0,longitude:r=0,zoom:n=11,pitch:i=0,bearing:o=0,nearZMultiplier:s=.1,farZMultiplier:a=1.01,orthographic:u=!1,projectionMatrix:c,repeat:l=!1,worldOffset:h=0,legacyMeterSizes:f=!1}=t;let{width:d,height:p,altitude:g=1.5}=t;const m=Math.pow(2,n);let y;d=d||1,p=p||1;let v=null;c?(g=c[5]/2,y=(0,tr.Lu)(g)):(t.fovy?(y=t.fovy,g=(0,tr.sj)(y)):y=(0,tr.Lu)(g),v=(0,tr.wl)({width:d,height:p,pitch:i,fovy:y,nearZMultiplier:s,farZMultiplier:a}));let b=(0,tr.lf)({height:p,pitch:i,bearing:o,scale:m,altitude:g});if(h){b=(new Ke).translate([512*h,0,0]).multiplyLeft(b)}super({...t,width:d,height:p,viewMatrix:b,longitude:r,latitude:e,zoom:n,...v,fovy:y,focalDistance:g}),this.latitude=e,this.longitude=r,this.zoom=n,this.pitch=i,this.bearing=o,this.altitude=g,this.fovy=y,this.orthographic=u,this._subViewports=l?[]:null,this._pseudoMeters=f,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360);for(let n=e;n<=r;n++){const t=n?new os({...this,worldOffset:n}):this;this._subViewports.push(t)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,r]=this.projectFlat(t);return[e,r,(t[2]||0)*is(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,r]=this.unprojectFlat(t);return[e,r,(t[2]||0)/is(r)]}addMetersToLngLat(t,e){return(0,tr.eG)(t,e)}panByPosition(t,e){const r=(0,tr.CT)(e,this.pixelUnprojectionMatrix),n=rs([],this.projectFlat(t),((i=[])[0]=-(o=r)[0],i[1]=-o[1],i));var i,o;const s=rs([],this.center,n),[a,u]=this.unprojectFlat(s);return{longitude:a,latitude:u}}getBounds(t={}){const e=(0,tr.zX)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:r,height:n}=this,{longitude:i,latitude:o,zoom:s}=(0,tr.Xg)({width:r,height:n,bounds:t,...e});return new os({width:r,height:n,longitude:i,latitude:o,zoom:s})}}function ss(){}os.displayName="WebMercatorViewport";const as={onStart:ss,onUpdate:ss,onInterrupt:ss,onEnd:ss};class us{constructor(t){this._inProgress=!1,this._handle=null,this.timeline=t,this.settings={}}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings={...as,...t},this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const cs=()=>{},ls=1,hs=2,fs=3,ds={transitionEasing:t=>t,transitionInterruption:ls,onTransitionStart:cs,onTransitionInterrupt:cs,onTransitionEnd:cs};class ps{constructor(t,e={}){this.ControllerState=t,this.props={...ds,...e},this.propsInTransition=null,this.transition=new us(e.timeline),this.onViewStateChange=e.onViewStateChange||cs,this.onStateChange=e.onStateChange||cs,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const r=this.props;if(t={...ds,...t},this.props=t,this._shouldIgnoreViewportChange(r,t))return e;if(this._isTransitionEnabled(t)){const{interruption:n,endProps:i}=this.transition.settings,o={...r,...n===hs?i:this.propsInTransition||r};this._triggerTransition(o,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:r}=t;return(e>0||"auto"===e)&&Boolean(r)}_isUpdateDueToCurrentTransition(t){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===fs||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const r=new this.ControllerState(t),n=new this.ControllerState(e).shortestPathFrom(r),{transitionInterpolator:i}=e,o=i.getDuration?i.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=e.transitionInterpolator.initializeProps(t,n);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t(e)}}_onTransitionUpdate(t){const{time:e,settings:{interpolator:r,startProps:n,endProps:i,duration:o,easing:s}}=t,a=s(e/o),u=r.interpolateProps(n,i,a);this.propsInTransition=new this.ControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}const gs=["longitude","latitude","zoom","bearing","pitch"],ms=["longitude","latitude","zoom"];class ys extends class{constructor(t={}){Array.isArray(t)&&(t={compare:t,extract:t,required:t});const{compare:e,extract:r,required:n}=t;this._propsToCompare=e,this._propsToExtract=r,this._requiredProps=n}arePropsEqual(t,e){for(const r of this._propsToCompare||Object.keys(e))if(!(r in t)||!(r in e)||!Me(t[r],e[r]))return!1;return!0}initializeProps(t,e){let r;if(this._propsToExtract){const n={},i={};for(const r of this._propsToExtract)n[r]=t[r],i[r]=e[r];r={start:n,end:i}}else r={start:t,end:e};return this._checkRequiredProps(r.start),this._checkRequiredProps(r.end),r}interpolateProps(t,e,r){return e}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const r=t[e];ts(Number.isFinite(r)||Array.isArray(r),"".concat(e," is required for transition"))}))}}{constructor(t={}){super((Array.isArray(t)?t:t.transitionProps)||{compare:gs,extract:gs,required:ms}),this.opts=t}initializeProps(t,e){const r=super.initializeProps(t,e),{makeViewport:n,around:i}=this.opts;if(n&&i){const o=n(t),s=n(e),a=o.unproject(i);r.start.around=i,Object.assign(r.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return r}interpolateProps(t,e,r){const n={};for(const i of this._propsToExtract)n[i]=Pe(t[i]||0,e[i]||0,r);if(e.aroundPosition){const i=this.opts.makeViewport({...e,...n});Object.assign(n,i.panByPosition(e.aroundPosition,Pe(t.around,e.around,r)))}return n}}const vs={transitionDuration:0},bs={transitionDuration:300,transitionEasing:t=>t,transitionInterruption:ls},_s=t=>1-(1-t)*(1-t),ws=["wheel"],xs=["panstart","panmove","panend"],Es=["pinchstart","pinchmove","pinchend"],Ps=["tripanstart","tripanmove","tripanend"],Ms=["doubletap"],Ss=["keydown"];const Os=0,As=0,Ts=1.5,ks=0,Cs=20,js=0,Is=60;class Rs extends class{constructor(t){this._viewportProps=this._applyConstraints(t)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(t){return this._viewportProps}_applyConstraints(t){return t}}{constructor({makeViewport:t,width:e,height:r,latitude:n,longitude:i,zoom:o,bearing:s=As,pitch:a=Os,altitude:u=Ts,maxZoom:c=Cs,minZoom:l=ks,maxPitch:h=Is,minPitch:f=js,startPanLngLat:d,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v,normalize:b}={}){ts(Number.isFinite(i)),ts(Number.isFinite(n)),ts(Number.isFinite(o)),super({width:e,height:r,latitude:n,longitude:i,zoom:o,bearing:s,pitch:a,altitude:u,maxZoom:c,minZoom:l,maxPitch:h,minPitch:f,normalize:b}),this._state={startPanLngLat:d,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const r=this._state.startPanLngLat||this._unproject(e);if(!r)return this;const n=this.makeViewport(this._viewportProps).panByPosition(r,t);return this._getUpdatedState(n)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:r=0}){const{startRotatePos:n,startBearing:i,startPitch:o}=this._state;if(!n||!Number.isFinite(i)||!Number.isFinite(o))return this;let s;return s=t?this._calculateNewPitchAndBearing({...this._getRotationParams(t,n),startBearing:i,startPitch:o}):{bearing:i+e,pitch:o+r},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:r}){let{startZoom:n,startZoomLngLat:i}=this._state;Number.isFinite(n)||(n=this._viewportProps.zoom,i=this._unproject(e)||this._unproject(t));const o=this._calculateNewZoom({scale:r,startZoom:n}),s=this.makeViewport({...this._viewportProps,zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(i,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),r={...this._viewportProps},{bearing:n,longitude:i}=r;return Math.abs(n-e.bearing)>180&&(r.bearing=n<0?n+360:n-360),Math.abs(i-e.longitude)>180&&(r.longitude=i<0?i+360:i-360),r}_zoomFromCenter(t){const{width:e,height:r}=this._viewportProps;return this.zoom({pos:[e/2,r/2],scale:t})}_panFromCenter(t){const{width:e,height:r}=this._viewportProps;return this.pan({startPos:[e/2,r/2],pos:[e/2+t[0],r/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:r,zoom:n}=t;t.zoom=Ee(n,r,e);const{maxPitch:i,minPitch:o,pitch:s}=t;t.pitch=Ee(s,o,i);const{normalize:a=!0}=t;return a&&Object.assign(t,(0,tr.QA)(t)),t}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:r,minZoom:n}=this._viewportProps;return Ee(e+Math.log2(t),n,r)}_calculateNewPitchAndBearing({deltaScaleX:t,deltaScaleY:e,startBearing:r,startPitch:n}){e=Ee(e,-1,1);const{minPitch:i,maxPitch:o}=this._viewportProps;let s=n;return e>0?s=n+e*(o-n):e<0&&(s=n-e*(i-n)),{pitch:s,bearing:r+180*t}}_getRotationParams(t,e){const r=t[0]-e[0],n=t[1]-e[1],i=t[1],o=e[1],{width:s,height:a}=this._viewportProps,u=r/s;let c=0;return n>0?Math.abs(a-o)>5&&(c=n/(o-a)*1.2):n<0&&o>5&&(c=1-i/o),c=Math.min(1,Math.max(-1,c)),{deltaScaleX:u,deltaScaleY:c}}}class Ls extends class{constructor(t,e={}){this.ControllerState=t,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new ps(t,{...e,onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)});const r=this.linearTransitionProps;this._transition=r&&{...bs,transitionInterpolator:new ys({transitionProps:r})},this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(e)}get linearTransitionProps(){return null}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.setProps(this.controllerStateProps)}finalize(){for(const t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){const{ControllerState:e}=this;this.controllerState=new e({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state});const r=this._eventStartBlocked;switch(t.type){case"panstart":return!r&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!r&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!r&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}getCenter(t){const{x:e,y:r}=this.controllerStateProps,{offsetCenter:n}=t;return[n.x-e,n.y-r]}isPointInBounds(t,e){const{width:r,height:n}=this.controllerStateProps;if(e&&e.handled)return!1;const i=t[0]>=0&&t[0]<=r&&t[1]>=0&&t[1]<=n;return i&&e&&e.stopPropagation(),i}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),"makeViewport"in t&&(this.makeViewport=t.makeViewport),"dragMode"in t&&(this.dragMode=t.dragMode),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:e}=t;!0===e&&(e=300),this.inertia=e;const{scrollZoom:r=!0,dragPan:n=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:u=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(ws,c&&r),this.toggleEvents(xs,c&&(n||i)),this.toggleEvents(Es,c&&(s||a)),this.toggleEvents(Ps,c&&a),this.toggleEvents(Ms,c&&o),this.toggleEvents(Ss,c&&u),this.scrollZoom=r,this.dragPan=n,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=u}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e={},r={}){const n={...t.getViewportProps(),...e},i=this.controllerState!==t;if(this._state=t.getState(),this._setInteractionState(r),i){const t=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:n,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange&&(t.interactionState=this._interactionState,this.onViewStateChange(t))}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let r=this.isFunctionKeyPressed(t)||t.rightButton;(this.invertPan||"pan"===this.dragMode)&&(r=!r);const n=this.controllerState[r?"panStart":"rotateStart"]({pos:e});return this._panMove=r,this.updateViewport(n,vs,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),r=this.controllerState.pan({pos:e});return this.updateViewport(r,vs,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const r=this.getCenter(t),n=[r[0]+t.velocityX*e/2,r[1]+t.velocityY*e/2],i=this.controllerState.pan({pos:n}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:_s},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),r=this.controllerState.rotate({pos:e});return this.updateViewport(r,vs,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const r=this.getCenter(t),n=[r[0]+t.velocityX*e/2,r[1]+t.velocityY*e/2],i=this.controllerState.rotate({pos:n}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:_s},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:r=.01,smooth:n=!1}=this.scrollZoom,{delta:i}=t;let o=2/(1+Math.exp(-Math.abs(i*r)));i<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:n?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const r=this.controllerState.rotateStart({pos:e});return this.updateViewport(r,vs,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const r=this.controllerState.rotate({pos:e});return this.updateViewport(r,vs,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const r=this.getCenter(t),n=[r[0],r[1]+=t.velocityY*e/2],i=this.controllerState.rotate({pos:n});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:_s},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const r=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(r,vs,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:r}=t,n=this.getCenter(t);e=e.zoom({pos:n,scale:r})}if(this.touchRotate){const{rotation:r}=t;e=e.rotate({deltaAngleX:this._startPinchRotation-r})}return this.updateViewport(e,vs,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e,_lastPinchEvent:r}=this;if(this.touchZoom&&e&&r&&t.scale!==r.scale){const n=this.getCenter(t);let i=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(r.scale))/(t.deltaTime-r.deltaTime),a=Math.pow(2,o+s*e/2);i=i.zoom({pos:n,scale:a}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:n}),transitionDuration:e,transitionEasing:_s},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const r=this.isFunctionKeyPressed(t),n=this.controllerState.zoom({pos:e,scale:r?.5:2});return this.updateViewport(n,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:r,moveSpeed:n,rotateSpeedX:i,rotateSpeedY:o}=this.keyboard,{controllerState:s}=this;let a;const u={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(r).zoomOut(r):s.zoomOut(r),u.isZooming=!0;break;case"Equal":a=e?s.zoomIn(r).zoomIn(r):s.zoomIn(r),u.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(i),u.isRotating=!0):(a=s.moveLeft(n),u.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(i),u.isRotating=!0):(a=s.moveRight(n),u.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),u.isRotating=!0):(a=s.moveUp(n),u.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),u.isRotating=!0):(a=s.moveDown(n),u.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),u),!0}_getTransitionProps(t){const{_transition:e}=this;return e?t?{...e,transitionInterpolator:new ys({...t,transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport})}:e:vs}}{constructor(t){t.dragMode=t.dragMode||"pan",super(Rs,t)}setProps(t){const e=this.controllerStateProps;super.setProps(t);(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state}))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}class Ds extends es{constructor(t){super({...t,type:os})}get controller(){return this._getControllerProps({type:Ls})}}Ds.displayName="MapView";const Fs=[255,255,255],Ns=1;let Bs=0;class zs{constructor(t={}){const{color:e=Fs}=t,{intensity:r=Ns}=t;this.id=t.id||"ambient-".concat(Bs++),this.color=e,this.intensity=r,this.type="ambient"}}const Us=[255,255,255],Vs=1,Gs=[0,0,-1];let Ws=0;class Zs{constructor(t={}){const{color:e=Us}=t,{intensity:r=Vs}=t,{direction:n=Gs}=t,{_shadow:i=!1}=t;this.id=t.id||"directional-".concat(Ws++),this.color=e,this.intensity=r,this.type="directional",this.direction=new Be(n).normalize().toArray(),this.shadow=i}getProjectedLight(){return this}}class $s{constructor(t={}){const{id:e="effect"}=t;this.id=e,this.props={...t}}preRender(){}getModuleParameters(){}cleanup(){}}class Xs extends class{constructor(t,e={}){const{id:r="pass"}=e;this.id=r,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(){}cleanup(){}}{render(t){return Rn(this.gl,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{viewports:e,views:r,onViewportActive:n,clearCanvas:i=!0}=t;t.pass=t.pass||"unknown";const o=this.gl;i&&function(t){const e=t.drawingBufferWidth,r=t.drawingBufferHeight;Rn(t,{viewport:[0,0,e,r]}),t.clear(16640)}(o);const s=[];for(const a of e){const e=a.viewport||a,i=r&&r[e.id];n(e);const u=this._getDrawLayerParams(e,t);t.view=i;const c=e.subViewports||[e];for(const r of c){t.viewport=r;const e=this._drawLayersInViewport(o,t,u);s.push(e)}}return s}_getDrawLayerParams(t,{layers:e,pass:r,layerFilter:n,effects:i,moduleParameters:o}){const s=[],a=Ys(),u={viewport:t,isPicking:r.startsWith("picking"),renderPass:r},c={};for(let l=0;l<e.length;l++){const h=e[l],f=this._shouldDrawLayer(h,u,n,c),d={shouldDrawLayer:f,layerRenderIndex:a(h,f)};f&&(d.moduleParameters=this._getModuleParameters(h,i,r,o),d.layerParameters=this.getLayerParameters(h,l,t)),s[l]=d}return s}_drawLayersInViewport(t,{layers:e,pass:r,viewport:n,view:i},o){const s=function(t,{viewport:e}){const r=t.canvas?t.canvas.clientHeight||t.canvas.height:100,n=e,i=Dn(t);return[n.x*i,(r-n.y-n.height)*i,n.width*i,n.height*i]}(t,{viewport:n});if(i&&i.props.clear){const e=!0===i.props.clear?{color:!0,depth:!0}:i.props.clear;Ln(t,{scissorTest:!0,scissor:s},(()=>Oi(t,e)))}const a={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};Rn(t,{viewport:s});for(let c=0;c<e.length;c++){const t=e[c],{shouldDrawLayer:i,layerRenderIndex:s,moduleParameters:l,layerParameters:h}=o[c];if(i&&t.props.pickable&&a.pickableCount++,t.isComposite)a.compositeCount++;else if(i){a.visibleCount++,l.viewport=n;try{t.drawLayer({moduleParameters:l,uniforms:{layerIndex:s},parameters:h})}catch(u){t.raiseError(u,"drawing ".concat(t," to ").concat(r))}}}return a}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e){return t.props.parameters}_shouldDrawLayer(t,e,r,n){if(!(this.shouldDrawLayer(t)&&t.props.visible))return!1;e.layer=t;let i=t.parent;for(;i;){if(!i.props.visible||!i.filterSubLayer(e))return!1;e.layer=i,i=i.parent}if(r){const t=e.layer.id;if(t in n||(n[t]=r(e)),!n[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,r,n){const i=Object.assign(Object.create(t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:Dn(this.gl)});if(e)for(const o of e)Object.assign(i,o.getModuleParameters(t));return Object.assign(i,this.getModuleParameters(t,e),n)}}function Ys(t=0,e={}){const r={},n=(i,o)=>{const s=i.props._offset,a=i.id,u=i.parent&&i.parent.id;let c;if(u&&!(u in e)&&n(i.parent,!1),u in r){const t=r[u]=r[u]||Ys(e[u],e);c=t(i,o),r[a]=t}else Number.isFinite(s)?(c=s+(e[u]||0),r[a]=null):c=t;return o&&c>=t&&(t=c+1),e[a]=c,c};return n}class Hs extends Xs{constructor(t,e){super(t,e),this.shadowMap=new xi(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Mi(t,{format:33189,width:1,height:1}),this.fbo=new Ui(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;Ln(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const r=t.viewports[0],n=Dn(this.gl),i=r.width*n,o=r.height*n;i===e.width&&o===e.height||e.resize({width:i,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const qs=Ro((function({viewport:t,center:e}){return new Ke(t.viewProjectionMatrix).invert().transform(e)})),Ks=Ro((function({viewport:t,shadowMatrices:e}){const r=[],n=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,o=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[r,n,i]=t,o=(0,tr.CT)([r,n,i],e);if(Number.isFinite(i))return o;return[o[0],o[1],0]}(t,n)));for(const s of e){const e=s.clone().translate(new Be(t.center).negate()),n=o.map((t=>e.transform(t))),i=(new Ke).ortho({left:Math.min(...n.map((t=>t[0]))),right:Math.max(...n.map((t=>t[0]))),bottom:Math.min(...n.map((t=>t[1]))),top:Math.max(...n.map((t=>t[1]))),near:Math.min(...n.map((t=>-t[2]))),far:Math.max(...n.map((t=>-t[2])))});r.push(i.multiplyRight(s))}return r})),Qs=[0,0,0,1],Js=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];var ta={name:"shadow",dependencies:[Go],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>{if(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0){const{shadowEnabled:r=!0}=t;return r&&t.shadowMatrices&&t.shadowMatrices.length>0?function(t={},e={}){const r={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||Qs,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},n=qs({viewport:t.viewport,center:e.project_uCenter}),i=[],o=Ks({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let s=0;s<t.shadowMatrices.length;s++){const r=o[s],a=r.clone().translate(new Be(t.viewport.center).negate());e.project_uCoordinateSystem===er.LNGLAT&&e.project_uProjectionMode===rr.WEB_MERCATOR?(o[s]=a,i[s]=n):(o[s]=r.clone().multiplyRight(Js),i[s]=a.transform(n))}for(let s=0;s<o.length;s++)r["shadow_uViewProjectionMatrices[".concat(s,"]")]=o[s],r["shadow_uProjectCenters[".concat(s,"]")]=i[s],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(s)]=t.shadowMaps[s]:r["shadow_uShadowMap".concat(s)]=t.dummyShadowMap;return r}(t,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}};const ea={color:[255,255,255],intensity:1},ra=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],na=[0,0,0,200/255];class ia extends $s{constructor(t){super(t),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=na,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const e in t){const r=t[e];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow))}preRender(t,{layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=Po.getDefaultProgramManager(t),ta&&this.programManager.addDefaultModule(ta)),this.dummyShadowMap||(this.dummyShadowMap=new xi(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++){this.shadowPasses[t].render({layers:e,layerFilter:r,viewports:n,onViewportActive:i,views:o,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(ta),this.programManager=null)}_createLightMatrix(){const t=[];for(const e of this.directionalLights){const r=(new Ke).lookAt({eye:new Be(e.direction).negate()});t.push(r)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const r=new Hs(t);this.shadowPasses[e]=r,this.shadowMaps[e]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:r}=this;t||0!==e.length||0!==r.length||(this.ambientLight=new zs(ea),this.directionalLights.push(new Zs(ra[0]),new Zs(ra[1])))}}const oa=new ia;class sa{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&Ho(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(t=[]){this.cleanup(),this.effects=t,this._createInternalEffects()}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some((t=>t instanceof ia))||this._internalEffects.push(oa)}}class aa extends Xs{}const ua={blendFunc:[1,0,32771,0],blendEquation:32774};class ca extends Xs{render(t){return t.pickingFBO?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:r,viewports:n,onViewportActive:i,pickingFBO:o,deviceRect:{x:s,y:a,width:u,height:c},pass:l="picking",redrawReason:h,pickZ:f}){const d=this.gl;this.pickZ=f;const p=!f&&{byLayer:new Map,byAlpha:[]};this._colors=p;const g=Ln(d,{scissorTest:!0,scissor:[s,a,u,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...ua,blend:!f},(()=>super.render({target:o,layers:t,layerFilter:e,views:r,viewports:n,onViewportActive:i,pass:l,redrawReason:h})));this._colors=null;return{decodePickingColor:p&&la.bind(null,p),stats:g}}shouldDrawLayer(t){return t.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,r){const n={...t.props.parameters};return this.pickZ?n.blend=!1:(Object.assign(n,ua),n.blend=!0,n.blendColor=function(t,e,r){const{byLayer:n,byAlpha:i}=t;let o;if(n.has(e)){const t=n.get(e);t.viewports.push(r),o=t.a}else if(o=n.size+1,o<=255){const t={a:o,layer:e,viewports:[r]};n.set(e,t),i[o]=t}else V.warn("Too many pickable layers, only picking the first 255")(),o=0;return[0,0,0,o/255]}(this._colors,t,r)),n}}function la(t,e){const r=t.byAlpha[e[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(e)}}class ha{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new aa(t),this.pickLayersPass=new ca(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=t.layerFilter||this.layerFilter,t.effects=t.effects||[],t.target=t.target||Ui.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const r=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,n=e.render({...t,target:r});this._postRender(t.effects,t),this.renderCount++,W("deckRenderer.renderLayers",this,n,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let r=null;for(const n of t)n.preRender(this.gl,e),n.postRender&&(r=n);r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new Ui(this.gl),new Ui(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:r}=this,n={inputBuffer:r[0],swapBuffer:r[1],target:null};for(const i of t)if(i.postRender){if(i===this.lastPostProcessEffect){n.target=e.target,i.postRender(this.gl,n);break}const t=i.postRender(this.gl,n);n.inputBuffer=t,n.swapBuffer=t===r[0]?r[1]:r[0]}}}const fa={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function da({pickedColors:t,decodePickingColor:e,deviceX:r,deviceY:n,deviceRadius:i,deviceRect:o}){if(t){const{x:s,y:a,width:u,height:c}=o;let l=i*i,h=-1,f=0;for(let e=0;e<c;e++){const i=e+a-n,o=i*i;if(o>l)f+=4*u;else for(let e=0;e<u;e++){if(t[f+3]-1>=0){const t=e+s-r,n=t*t+o;n<=l&&(l=n,h=f)}f+=4}}if(h>=0){const r=t.slice(h,h+4),n=e(r);if(n){const t=Math.floor(h/4/u),e=h/4-t*u;return{...n,pickedColor:r,pickedX:s+e,pickedY:a+t}}V.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return fa}function pa({pickInfo:t,viewports:e,pixelRatio:r,x:n,y:i,z:o}){let s=e[0];e.length>1&&(s=function(t,e){for(let r=t.length-1;r>=0;r--){const n=t[r];if(n.containsPixel(e))return n}return t[0]}((null===t||void 0===t?void 0:t.pickedViewports)||e,{x:n,y:i}));const a=s&&s.unproject([n-s.x,i-s.y],{targetZ:o});return{color:null,layer:null,viewport:s,index:-1,picked:!1,x:n,y:i,pixel:[n,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:null,pixelRatio:r}}function ga(t){const{pickInfo:e,lastPickedInfo:r,mode:n,layers:i}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,u=s?[s]:[];if("hover"===n){const t=r.index,e=r.layerId,n=s&&s.props.id;if(n!==e||a!==t){if(n!==e){const t=i.find((t=>t.props.id===e));t&&u.unshift(t)}r.layerId=n,r.index=a,r.info=null}}const c=pa(t),l=new Map;return l.set(null,c),u.forEach((t=>{let e={...c};t===s&&(e.color=o,e.index=a,e.picked=!0),e=ma({layer:t,info:e,mode:n}),t===s&&"hover"===n&&(r.info=e),l.set(e.layer.id,e),"hover"===n&&e.layer.updateAutoHighlight(e)})),l}function ma({layer:t,info:e,mode:r}){for(;t&&e;){const n=e.layer||null;e.sourceLayer=n,e.layer=t,e=t.getPickingInfo({info:e,mode:r,sourceLayer:n}),t=t.parent}return e}class ya{constructor(t){this.gl=t,this.pickingFBO=null,this.pickLayersPass=new ca(t),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:r,viewports:n},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,s=i&&i.viewport&&i.viewport.id,a=o?r.find((t=>t.id===o)):null,u=s&&n.find((t=>t.id===s))||n[0],c=u&&u.unproject([t-u.x,e-u.y]),l={x:t,y:e,viewport:u,coordinate:c,layer:a};return{...i,...l}}_resizeBuffer(){const{gl:t}=this;return this.pickingFBO||(this.pickingFBO=new Ui(t),Ui.isSupported(t,{colorBufferFloat:!0})&&(this.depthFBO=new Ui(t),this.depthFBO.attach({36064:new xi(t,{format:Jr(t)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.pickingFBO}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>t.isPickable()&&!t.isComposite));return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:r,x:n,y:i,radius:o=0,depth:s=1,mode:a="query",unproject3D:u,onViewportActive:c}){if(!(t=this._getPickable(t)))return{result:[],emptyInfo:pa({viewports:r,x:n,y:i})};this._resizeBuffer();const l=Dn(this.gl),h=Fn(this.gl,[n,i],!0),f=[h.x+Math.floor(h.width/2),h.y+Math.floor(h.height/2)],d=Math.round(o*l),{width:p,height:g}=this.pickingFBO,m=this._getPickingRect({deviceX:f[0],deviceY:f[1],deviceRadius:d,deviceWidth:p,deviceHeight:g});let y;const v=[],b=new Set;for(let _=0;_<s;_++){const o=da({...m&&this._drawAndSample({layers:t,views:e,viewports:r,onViewportActive:c,deviceRect:m,pass:"picking:".concat(a),redrawReason:a}),deviceX:f[0],deviceY:f[1],deviceRadius:d,deviceRect:m});let h;if(o.pickedLayer&&u&&this.depthFBO){h=this._drawAndSample({layers:[o.pickedLayer],views:e,viewports:r,onViewportActive:c,deviceRect:{x:o.pickedX,y:o.pickedY,width:1,height:1},pass:"picking:".concat(a),redrawReason:"pick-z",pickZ:!0}).pickedColors[0]*r[0].distanceScales.metersPerUnit[2]+r[0].position[2]}o.pickedLayer&&_+1<s&&(b.add(o.pickedLayer),o.pickedLayer.disablePickingIndex(o.pickedObjectIndex)),y=ga({pickInfo:o,lastPickedInfo:this.lastPickedInfo,mode:a,layers:t,viewports:r,x:n,y:i,z:h,pixelRatio:l});for(const t of y.values())t.layer&&v.push(t);if(!o.pickedColor)break}for(const _ of b)_.restorePickingColors();return{result:v,emptyInfo:y&&y.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:r,x:n,y:i,width:o=1,height:s=1,mode:a="query",maxObjects:u=null,onViewportActive:c}){if(!(t=this._getPickable(t)))return[];this._resizeBuffer();const l=Dn(this.gl),h=Fn(this.gl,[n,i],!0),f=h.x,d=h.y+h.height,p=Fn(this.gl,[n+o,i+s],!0),g=p.x+p.width,m=p.y,y={x:f,y:m,width:g-f,height:d-m},v=function({pickedColors:t,decodePickingColor:e}){const r=new Map;if(t)for(let n=0;n<t.length;n+=4)if(t[n+3]-1>=0){const i=t.slice(n,n+4),o=i.join(",");if(!r.has(o)){const t=e(i);t?r.set(o,{...t,pickedColor:i}):V.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(r.values())}(this._drawAndSample({layers:t,views:e,viewports:r,onViewportActive:c,deviceRect:y,pass:"picking:".concat(a),redrawReason:a})),b=new Map,_=Number.isFinite(u);for(let w=0;w<v.length&&!(_&&b.size>=u);w++){const t=v[w];let e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:n,y:i,width:o,height:s,pixelRatio:l};e=ma({layer:t.pickedLayer,info:e,mode:a}),b.has(e.object)||b.set(e.object,e)}return Array.from(b.values())}_drawAndSample({layers:t,views:e,viewports:r,onViewportActive:n,deviceRect:i,pass:o,redrawReason:s,pickZ:a}){const u=a?this.depthFBO:this.pickingFBO,{decodePickingColor:c}=this.pickLayersPass.render({layers:t,layerFilter:this.layerFilter,views:e,viewports:r,onViewportActive:n,pickingFBO:u,deviceRect:i,pass:o,redrawReason:s,pickZ:a}),{x:l,y:h,width:f,height:d}=i,p=new(a?Float32Array:Uint8Array)(f*d*4);return ji(u,{sourceX:l,sourceY:h,sourceWidth:f,sourceHeight:d,target:p}),{pickedColors:p,decodePickingColor:c}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:r,deviceWidth:n,deviceHeight:i}){const o=Math.max(0,t-r),s=Math.max(0,e-r),a=Math.min(n,t+r+1)-o,u=Math.min(i,e+r+1)-s;return a<=0||u<=0?null:{x:o,y:s,width:a,height:u}}}const va={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class ba{constructor(t){const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,va),e.appendChild(this.el)),this.isVisible=!1}setTooltip(t,e,r){const n=this.el;if("string"===typeof t)n.innerText=t;else{if(!t)return this.isVisible=!1,void(n.style.display="none");"text"in t&&(n.innerText=t.text),"html"in t&&(n.innerHTML=t.html),"className"in t&&(n.className=t.className),Object.assign(n.style,t.style)}this.isVisible=!0,n.style.display="block",n.style.transform="translate(".concat(e,"px, ").concat(r,"px)")}remove(){this.el&&this.el.remove()}}const{_parseImageNode:_a}=globalThis,wa="undefined"!==typeof Image,xa="undefined"!==typeof ImageBitmap,Ea=Boolean(_a),Pa=!!Jt||Ea;function Ma(t){const e=Oa(t);if(!e)throw new Error("Not an image");return e}function Sa(t){switch(Ma(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),r=e.getContext("2d");if(!r)throw new Error("getImageData");return e.width=t.width,e.height=t.height,r.drawImage(t,0,0),r.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Oa(t){return"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&t instanceof Image?"image":t&&"object"===typeof t&&t.data&&t.width&&t.height?"data":null}const Aa=/^data:image\/svg\+xml/,Ta=/\.svg((\?|#).*)?$/;function ka(t){return t&&(Aa.test(t)||Ta.test(t))}function Ca(t,e){if(ka(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function ja(t,e,r){const n=function(t,e){if(ka(e)){let e=(new TextDecoder).decode(t);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(r){throw new Error(r.message)}return"data:image/svg+xml;base64,".concat(btoa(e))}return Ca(t,e)}(t,r),i=self.URL||self.webkitURL,o="string"!==typeof n&&i.createObjectURL(n);try{return await async function(t,e){const r=new Image;if(r.src=t,e.image&&e.image.decode&&r.decode)return await r.decode(),r;return await new Promise(((e,n)=>{try{r.onload=()=>e(r),r.onerror=e=>n(new Error("Could not load image ".concat(t,": ").concat(e)))}catch(i){n(i)}}))}(o||n,e)}finally{o&&i.revokeObjectURL(o)}}const Ia={};let Ra=!0;async function La(t,e,r){let n;if(ka(r)){n=await ja(t,e,r)}else n=Ca(t,r);const i=e&&e.imagebitmap;return await async function(t,e=null){!function(t){for(const e in t||Ia)return!1;return!0}(e)&&Ra||(e=null);if(e)try{return await createImageBitmap(t,e)}catch(r){console.warn(r),Ra=!1}return await createImageBitmap(t)}(n,i)}const Da=!1,Fa=!0;function Na(t){const e=Ba(t);return function(t){const e=Ba(t);if(!(e.byteLength>=24&&2303741511===e.getUint32(0,Da)))return null;return{mimeType:"image/png",width:e.getUint32(16,Da),height:e.getUint32(20,Da)}}(e)||function(t){const e=Ba(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,Da)&&255===e.getUint8(2)))return null;const{tableMarkers:r,sofMarkers:n}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)t.add(r);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}();let i=2;for(;i+9<e.byteLength;){const t=e.getUint16(i,Da);if(n.has(t))return{mimeType:"image/jpeg",height:e.getUint16(i+5,Da),width:e.getUint16(i+7,Da)};if(!r.has(t))return null;i+=2,i+=e.getUint16(i,Da)}return null}(e)||function(t){const e=Ba(t);if(!(e.byteLength>=10&&1195984440===e.getUint32(0,Da)))return null;return{mimeType:"image/gif",width:e.getUint16(6,Fa),height:e.getUint16(8,Fa)}}(e)||function(t){const e=Ba(t);if(!(e.byteLength>=14&&16973===e.getUint16(0,Da)&&e.getUint32(2,Fa)===e.byteLength))return null;return{mimeType:"image/bmp",width:e.getUint32(18,Fa),height:e.getUint32(22,Fa)}}(e)}function Ba(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const za={id:"image",module:"images",name:"Images",version:"3.1.4",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,r){const n=((e=e||{}).image||{}).type||"auto",{url:i}=r||{};let o;switch(function(t){switch(t){case"auto":case"data":return function(){if(xa)return"imagebitmap";if(wa)return"image";if(Pa)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return xa||wa||Pa;case"imagebitmap":return xa;case"image":return wa;case"data":return Pa;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(n)){case"imagebitmap":o=await La(t,e,i);break;case"image":o=await ja(t,e,i);break;case"data":o=await async function(t,e){const{mimeType:r}=Na(t)||{},n=globalThis._parseImageNode;return ot(n),await n(t,r)}(t);break;default:ot(!1)}return"data"===n&&(o=Sa(o)),o},tests:[t=>Boolean(Na(new DataView(t)))],options:{image:{type:"auto",decode:!0}}};var Ua={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],r=t[t.length-1];return"{"===e&&"}"===r||"["===e&&"]"===r},parseTextSync:JSON.parse};const Va="8.6.5",Ga=T.deck&&T.deck.VERSION;if(Ga&&Ga!==Va)throw new Error("deck.gl - multiple versions detected: ".concat(Ga," vs ").concat(Va));Ga||(V.log(1,"deck.gl ".concat(Va))(),T.deck=Object.assign(T.deck||{},{VERSION:Va,version:Va,log:V,_registerLoggers:function(t){G=t}}),function(t){const e=oe();t=Array.isArray(t)?t:[t];for(const r of t){const t=at(r);e.find((e=>t===e))||e.unshift(t)}}([Ua,[za,{imagebitmap:{premultiplyAlpha:"none"}}]]));var Wa=T.deck;const Za=globalThis;function $a(t){if(!t&&!_())return"Node";if(v(t))return"Electron";const e="undefined"!==typeof navigator?navigator:{},r=t||e.userAgent||"";if(r.indexOf("Edge")>-1)return"Edge";const n=-1!==r.indexOf("MSIE "),i=-1!==r.indexOf("Trident/");return n||i?"IE":Za.chrome?"Chrome":Za.safari?"Safari":Za.mozInnerScreenX?"Firefox":"Unknown"}class Xa extends ni{static isSupported(t,e=[]){const r=Jr(t),n=Ni(t,Li);let i=r||n;for(const o of e)switch(o){case"queries":i=i&&r;break;case"timers":i=i&&n;break;default:Yn(!1)}return i}constructor(t,e={}){super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:t=!1}={}){return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((r,n)=>{const i=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):e++>t?(n("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)})),this._pollingPromise}_createHandle(){return Xa.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Ya=_()&&"undefined"!==typeof document;let Ha=0;class qa{constructor(t={}){const{onCreateContext:e=(t=>Gn(t)),onAddHTML:r=null,onInitialize:n=(()=>{}),onRender:i=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:u={},debug:c=!1,createFramebuffer:l=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:f=!0,stats:d=Xn.get("animation-loop-"+Ha++)}=t;let{useDevicePixels:p=!0}=t;"useDevicePixelRatio"in t&&(Hr.deprecated("useDevicePixelRatio","useDevicePixels")(),p=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:r,onInitialize:n,onRender:i,onFinalize:o,onError:s,gl:a,glOptions:u,debug:c,createFramebuffer:l},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=d,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:f,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return Yn("string"===typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(t={}){if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Xa.isSupported(this.gl,["timers"])?new Xa(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...t){return this.props.onCreateContext(...t)}onInitialize(...t){return this.props.onInitialize(...t)}onRender(...t){return this.props.onRender(...t)}onFinalize(...t){return this.props.onFinalize(...t)}getHTMLControlValue(t,e=1){const r=document.getElementById(t);return r?Number(r.value):e}setViewParameters(){return Hr.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Ya?new Promise(((t,e)=>{Ya&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(...t){this.display?this.display._renderFrame(...t):this.onRender(...t)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:r}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"===typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!==typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?Wn(this.props.gl,t):this.onCreateContext(t),!Qr(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Rn(this.gl,mn),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const r=this.props.onAddHTML(e);r&&(e.innerHTML=r)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let r=1;const{canvas:n}=this.gl;return n&&n.clientHeight?r=n.clientWidth/n.clientHeight:t>0&&e>0&&(r=t/e),{width:t,height:e,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Zn(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Ui(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var Ka=r(2317);function Qa(){}const Ja={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:Qa,onResize:Qa,onViewStateChange:Qa,onInteractionStateChange:Qa,onBeforeRender:Qa,onAfterRender:Qa,onLoad:Qa,onError:(t,e)=>V.error(t)(),_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",debug:!1,drawPickingColors:!1};class tu{constructor(t){t={...Ja,...t},this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),t.viewState&&t.initialViewState&&V.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===$a()&&V.warn("IE 11 support will be deprecated in v8.0")(),t.gl||"undefined"!==typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new K({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&ve.setProps(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&V.removed("onLayerHover","onHover")(),"onLayerClick"in t&&V.removed("onLayerClick","onClick")(),t.initialViewState&&!Ho(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(t),n=this.layerManager.needsRedraw(t),i=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||r||n||i||o,e}redraw(t){if(!this.layerManager)return;const e=t||this.needsRedraw({clearRedrawFlags:!0});e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}getViews(){return this.viewManager.views}getViewports(t){return this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const r in t)this.layerManager.resourceManager.add({resourceId:r,data:t[r],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,r){const{stats:n}=this;n.get("Pick Count").incrementCount(),n.get(e).timeStart();const i=this.deckPicker[t]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,...r});return n.get(e).timeEnd(),i}_createCanvas(t){let e=t.canvas;if("string"===typeof e&&(e=document.getElementById(e),ts(e)),!e){e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay";(t.parent||document.body).appendChild(e)}return Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;let{width:e,height:r}=t;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(r||0===r)&&(r=Number.isFinite(r)?"".concat(r,"px"):r,this.canvas.style.position="absolute",this.canvas.style.height=r)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:t,height:e}=this;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:t}=this;if(!t)return!1;const e=t.clientWidth||t.width,r=t.clientHeight||t.height;return(e!==this.width||r!==this.height)&&(this.width=e,this.height=r,!0)}_createAnimationLoop(t){const{width:e,height:r,gl:n,glOptions:i,debug:o,onError:s,onBeforeRender:a,onAfterRender:u,useDevicePixels:c,autoResizeDrawingBuffer:l}=t;return new qa({width:e,height:r,useDevicePixels:c,autoResizeDrawingBuffer:l,autoResizeViewport:!1,gl:n,onCreateContext:t=>Gn({...i,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:u,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new Ds({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_onPointerMove(t){const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const r=t.offsetCenter;if(!r)return;e.x=r.x,e.y=r.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t,e.mode="hover"}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:r}=this._pick("pickObject","pickObject Time",t);this.interactiveState.isHovering=e.length>0;let n=r,i=!1;for(const o of e)n=o,i=o.layer.onHover(o,t.event);if(!i&&this.props.onHover&&this.props.onHover(n,t.event),this.props.getTooltip){const t=this.props.getTooltip(n);this.tooltip.setTooltip(t,n.x,n.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,Wn(t,{enable:!0,copyState:!0})),this.tooltip=new ba(this.canvas),Rn(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new u;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new Ka.Q(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const n in ir)this.eventManager.on(n,this._onEvent);this.viewManager=new qo({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new Yo(t,{deck:this,stats:this.stats,viewport:r,timeline:e}),this.effectManager=new sa,this.deckRenderer=new ha(t),this.deckPicker=new ya(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:r}=this.layerManager.context;Rn(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:r})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),V.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.interactiveState.isDragging=t.isDragging,this.props.onInteractionStateChange(t)}_onEvent(t){const e=ir[t.type],r=t.offsetCenter;if(!e||!r)return;const n=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:n,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:o}=i,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let u=!1;s&&(u=s.call(o,i,t)),!u&&a&&a(i,t)}_onPointerDown(t){const e=t.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const r=Xn.get("Memory Usage");t.bufferMemory=r.get("Buffer Memory").count,t.textureMemory=r.get("Texture Memory").count,t.renderbufferMemory=r.get("Renderbuffer Memory").count,t.gpuMemory=r.get("GPU Memory").count}}tu.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf($s)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.oneOfType([t.bool,t.number]),touchAction:t.string,eventRecognizerOptions:t.object,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onInteractionStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLoad:t.func,onError:t.func,debug:t.bool,drawPickingColors:t.bool,_framebuffer:t.object,_animate:t.bool,_pickable:t.bool,_typedArrayManagerProps:t.object}},tu.defaultProps=Ja,tu.VERSION=Wa.VERSION;var eu="undefined"!==typeof window?n.useLayoutEffect:n.useEffect;function ru(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}class nu{constructor(t,e){this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:r}=this.source,{size:n}=e;let i=r;if(r&&r.length!==n){i=new Float32Array(n);const t=e.elementOffset||0;for(let e=0;e<n;++e)i[e]=r[t+e]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function iu(t){return t.stride||t.size*t.bytesPerElement}function ou(t,e){e.offset&&V.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const r=iu(t),n=("vertexOffset"in e?e.vertexOffset:t.vertexOffset||0)*r+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:n,stride:r}}const su=[],au=[];function uu(t){return t&&t[Symbol.asyncIterator]}const cu=[],lu=[[0,1/0]];function hu({source:t,target:e,start:r=0,end:n,size:i,getData:o}){n=n||e.length;const s=t.length,a=n-r;if(s>a)return void e.set(t.subarray(0,a),r);if(e.set(t,r),!o)return;let u=s;for(;u<a;){const n=o(u,t);for(let t=0;t<i;t++)e[r+u]=n[t]||0,u++}}const fu={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function du(t,e){return t?(Number.isFinite(t)&&(t={duration:t}),t.type=t.type||"interpolation",{...fu[t.type],...e,...t}):null}function pu(t,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function gu(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function mu(t){t.push(t.shift())}function yu(t,e){const{doublePrecision:r,settings:n,value:i,size:o}=t,s=r&&i instanceof Float64Array?2:1;return(n.noAlloc?i.length:e*o)*s}function vu({buffer:t,numInstances:e,attribute:r,fromLength:n,fromStartIndices:i,getData:o=(t=>t)}){const s=r.doublePrecision&&r.value instanceof Float64Array?2:1,a=r.size*s,u=r.byteOffset,c=r.startIndices,l=i&&c,h=yu(r,e),f=r.state.constant;if(!l&&n>=h)return;const d=f?r.value:r.getBuffer().getData({srcByteOffset:u});if(r.settings.normalized&&!f){const t=o;o=(e,n)=>r._normalizeConstant(t(e,n))}const p=f?(t,e)=>o(d,e):(t,e)=>o(d.subarray(t,t+a),e),g=t.getData({length:n}),m=new Float32Array(h);!function({source:t,target:e,size:r,getData:n,sourceStartIndices:i,targetStartIndices:o}){if(!Array.isArray(o))return hu({source:t,target:e,size:r,getData:n}),e;let s=0,a=0;const u=n&&((t,e)=>n(t+a,e)),c=Math.min(i.length,o.length);for(let l=1;l<c;l++){const n=i[l]*r,c=o[l]*r;hu({source:t.subarray(s,n),target:e,start:a,end:c,size:r,getData:u}),s=n,a=c}a<e.length&&hu({source:[],target:e,start:a,size:r,getData:u})}({source:g,target:m,sourceStartIndices:i,targetStartIndices:c,size:a,getData:p}),t.byteLength<m.byteLength+u&&t.reallocate(m.byteLength+u),t.subData({data:m,offset:u})}class bu extends class{constructor(t,e){this.gl=t,this.id=e.id,this.size=e.size;const r=e.logicalType||e.type,n=5130===r;let{defaultValue:i}=e;i=Number.isFinite(i)?[i]:i||new Array(this.size).fill(0),e.defaultValue=i;let o=r;n?o=5126:!o&&e.isIndexed?o=t&&function(t,e){return Ni(t,e)}(t,Di)?5125:5123:o||(o=5126),e.logicalType=r,e.type=o;let s=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||o||5126);this.shaderAttributes={},this.doublePrecision=n,n&&!1===e.fp64&&(s=Float32Array),e.bytesPerElement=s.BYTES_PER_ELEMENT,this.defaultType=s,this.value=null,this.settings=e,this.state={externalBuffer:null,bufferAccessor:e,allocatedValue:null,constant:!1},this._buffer=null,this.setData(e)}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new pi(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*iu(t):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),ve.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const r={},n=this.value instanceof Float64Array,i=function(t,e){const r=ou(t,e);return{high:r,low:{...r,offset:r.offset+4*t.size}}}(this.getAccessor(),e||{});return r[t]=new nu(this,i.high),r["".concat(t,"64Low")]=n?new nu(this,i.low):new Float32Array(this.size),r}if(e){const r=ou(this.getAccessor(),e);return{[t]:new nu(this,r)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(t){const{state:e}=this;ArrayBuffer.isView(t)?t={value:t}:t instanceof pi&&(t={buffer:t});const r={...this.settings,...t};if(e.bufferAccessor=r,t.constant){let r=t.value;r=this._normalizeValue(r,[],0),this.settings.normalized&&(r=this._normalizeConstant(r));if(!(!e.constant||!this._areValuesEqual(r,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=r}else if(t.buffer){const n=t.buffer;e.externalBuffer=n,e.constant=!1,this.value=t.value;const i=t.value instanceof Float64Array;r.type=t.type||n.accessor.type,r.bytesPerElement=n.accessor.BYTES_PER_ELEMENT*(i?2:1),r.stride=iu(r)}else if(t.value){this._checkExternalBuffer(t);let n=t.value;e.externalBuffer=null,e.constant=!1,this.value=n,r.bytesPerElement=n.BYTES_PER_ELEMENT,r.stride=iu(r);const{buffer:i,byteOffset:o}=this;this.doublePrecision&&n instanceof Float64Array&&(n=Ge(n,r));const s=n.byteLength+o+2*r.stride;i.byteLength<s&&i.reallocate(s),i.setAccessor(null),i.subData({data:n,offset:o}),r.type=t.type||i.accessor.type}return!0}updateSubBuffer(t={}){const{value:e}=this,{startOffset:r=0,endOffset:n}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?Ge(e,{size:this.size,startIndex:r,endIndex:n}):e.subarray(r,n),offset:r*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:t,copy:e=!1}){const{state:r}=this,n=r.allocatedValue,i=ve.allocate(n,t+1,{size:this.size,type:this.defaultType,copy:e});this.value=i;const{buffer:o,byteOffset:s}=this;return o.byteLength<i.byteLength+s&&(o.reallocate(i.byteLength+s),e&&n&&o.subData({data:n instanceof Float64Array?Ge(n,this):n,offset:s})),r.allocatedValue=i,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!t.constant&&e){const r=this.defaultType;let n=!1;if(this.doublePrecision&&(n=e.BYTES_PER_ELEMENT<4),n)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof r||!this.settings.normalized||"normalized"in t||V.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,r){const{defaultValue:n,size:i}=this.settings;if(Number.isFinite(t))return e[r]=t,e;if(!t)return e[r]=n[0],e;switch(i){case 4:e[r+3]=Number.isFinite(t[3])?t[3]:n[3];case 3:e[r+2]=Number.isFinite(t[2])?t[2]:n[2];case 2:e[r+1]=Number.isFinite(t[1])?t[1]:n[1];case 1:e[r+0]=Number.isFinite(t[0])?t[0]:n[0];break;default:let o=i;for(;--o>=0;)e[r+o]=Number.isFinite(t[o])?t[o]:n[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:r}=this;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}}{constructor(t,e={}){super(t,e);const{transition:r=!1,noAlloc:n=!1,update:i=null,accessor:o=null,transform:s=null,startIndices:a=null}=e;Object.assign(this.settings,{transition:r,noAlloc:n,update:i||o&&this._autoUpdater,accessor:o,transform:s}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:lu,startIndices:a}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!==typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,r=this.settings.transition;return du(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],r)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:r=1/0}=e;this.state.updateRanges=function(t,e){if(t===lu)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const r=[],n=t.length;let i=0;for(let o=0;o<n;o++){const n=t[o];n[1]<e[0]?(r.push(n),i=o+1):n[0]>e[1]?r.push(n):e=[Math.min(n[0],e[0]),Math.max(n[1],e[1])]}return r.splice(i,0,e),r}(this.state.updateRanges,[t,r])}else this.state.updateRanges=lu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=cu}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}update(t){this.setData(t)}allocate(t){const{state:e,settings:r}=this;return!r.noAlloc&&(!!r.update&&(super.allocate({numInstances:t,copy:e.updateRanges!==lu}),!0))}updateBuffer({numInstances:t,data:e,props:r,context:n}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of i)o.call(n,this,{data:e,startRow:s,endRow:a,props:r,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,r]of i){const n=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(r)?this.getVertexOffset(r):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:n,endOffset:i})}else;this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){if(void 0===t||"function"===typeof t)return!1;return this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:r,settings:n}=this;if(!t)return r.binaryValue=null,r.binaryAccessor=null,!1;if(n.noAlloc)return!1;if(r.binaryValue===t)return this.clearNeedsUpdate(),!0;r.binaryValue=t,this.setNeedsRedraw(),ArrayBuffer.isView(t)&&(t={value:t});if(n.transform||e!==this.startIndices){ts(ArrayBuffer.isView(t.value),"invalid ".concat(n.accessor));const i=t.size&&t.size!==this.size;return r.binaryAccessor=function(t,{size:e,stride:r,offset:n,startIndices:i,nested:o}){const s=t.BYTES_PER_ELEMENT,a=r?r/s:e,u=n?n/s:0,c=Math.floor((t.length-u)/a);return(r,{index:n,target:s})=>{if(!i){const r=n*a+u;for(let n=0;n<e;n++)s[n]=t[r+n];return s}const l=i[n],h=i[n+1]||c;let f;if(o){f=new Array(h-l);for(let r=l;r<h;r++){const n=r*a+u;s=new Array(e);for(let r=0;r<e;r++)s[r]=t[n+r];f[r-l]=s}}else if(a===e)f=t.subarray(l*e+u,h*e+u);else{f=new t.constructor((h-l)*e);let r=0;for(let n=l;n<h;n++){const i=n*a+u;for(let n=0;n<e;n++)f[r++]=t[i+n]}}return f}}(t.value,{size:t.size||this.size,stride:t.stride,offset:t.offset,startIndices:e,nested:i}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?e[t]:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const r in t)Object.assign(e,super.getShaderAttributes(r,t[r]));return e}_autoUpdater(t,{data:e,startRow:r,endRow:n,props:i,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:u,size:c,startIndices:l}=t,{accessor:h,transform:f}=s,d=a.binaryAccessor||("function"===typeof h?h:i[h]);ts("function"===typeof d,'accessor "'.concat(h,'" is not a function'));let p=t.getVertexOffset(r);const{iterable:g,objectInfo:m}=function(t,e=0,r=1/0){let n=su;const i={index:-1,data:t,target:[]};return t?"function"===typeof t[Symbol.iterator]?n=t:t.length>0&&(au.length=t.length,n=au):n=su,(e>0||Number.isFinite(r))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(e,r),i.index=e-1),{iterable:n,objectInfo:i}}(e,r,n);for(const y of g){m.index++;let e=d(y,m);if(f&&(e=f.call(this,e)),l){const r=(m.index<l.length-1?l[m.index+1]:o)-l[m.index];if(e&&Array.isArray(e[0])){let r=p;for(const n of e)t._normalizeValue(n,u,r),r+=c}else e&&e.length>c?u.set(e,p):(t._normalizeValue(e,m.target,0),X({target:u,source:m.target,start:p,count:r}));p+=r*c}else t._normalizeValue(e,u,p),p+=c}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||"function"===typeof t.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let r=!0;switch(e){case 4:r=r&&Number.isFinite(t[3]);case 3:r=r&&Number.isFinite(t[2]);case 2:r=r&&Number.isFinite(t[1]);case 1:r=r&&Number.isFinite(t[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const _u="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",wu=`#version 300 es\n${_u}`;function xu(t,e){e=Array.isArray(e)?e:[e];const r=t.replace(/^\s+/,"").split(/\s+/),[n,i,o]=r;if(!e.includes(n)||!i||!o)return null;return{qualifier:n,type:i,name:o.split(";")[0]}}function Eu(t={}){const{version:e=100,input:r,inputType:n,output:i}=t;if(!r)return 300===e?wu:e>300?`#version ${e}\n${_u}`:"void main() {gl_FragColor = vec4(0);}";const o=function(t,e){switch(e){case"float":return`vec4(${t}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${t}, 0.0, 1.0)`;case"vec3":return`vec4(${t}, 1.0)`;case"vec4":return t;default:return fr(!1),null}}(r,n);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${n} ${r};\nout vec4 ${i};\nvoid main() {\n  ${i} = ${o};\n}`:`varying ${n} ${r};\nvoid main() {\n  gl_FragColor = ${o};\n}`}class Pu extends ni{static isSupported(t){return Jr(t)}constructor(t,e={}){en(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(t={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,ti(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(t={}){return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const r=this._getVaryingIndex(t),{buffer:n,byteSize:i,byteOffset:o}=this._getBufferParams(e);return r<0?(this.unused[t]=n,Hr.warn((()=>`${this.id} unused varying buffer ${t}`))(),this):(this.buffers[r]=e,this.bindOnUse||this._bindBuffer(r,n,o,i),this)}begin(t=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,r,n;return t instanceof pi===!1?(n=t.buffer,r=t.byteSize,e=t.byteOffset):n=t,void 0===e&&void 0===r||(e=e||0,r=r||n.byteLength-e),{buffer:n,byteOffset:e,byteSize:r}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:r,byteOffset:n}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,n,r)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e,r=0,n){const i=e&&e.handle;return i&&void 0!==n?this.gl.bindBufferRange(35982,t,i,r,n):this.gl.bindBufferBase(35982,t,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}class Mu{constructor(t,e={}){this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(t={}){const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(t={}){const e=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:n}=e;return{attributes:Object.assign({},r,t.attributes),transformFeedback:n}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],r=t?e[t]:null;return r?r instanceof pi?r:r.buffer:null}getData(t={}){const{varyingName:e}=t,r=this.getBuffer(e);return r?r.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(t={}){this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Yn(Jr(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const n in this.feedbackMap){const t=this.feedbackMap[n];n in e&&(r[t]=n)}Object.assign(r,t.feedbackBuffers);for(const n in r){const t=r[n];if("string"===typeof t){const i=e[t],{byteLength:o,usage:s,accessor:a}=i;r[n]=this._createNewBuffer(n,{byteLength:o,usage:s,accessor:a})}}return r}_setupBuffers(t={}){const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const r=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:r})}_setupTransformFeedback(t,{model:e}){const{program:r}=e;t.transformFeedback=new Pu(this.gl,{program:r,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),r=Object.assign({},t.feedbackBuffers);for(const n in this.feedbackMap){const i=this.feedbackMap[n];e[n]=t.feedbackBuffers[i],r[i]=t.sourceBuffers[n],Yn(r[i]instanceof pi)}return{sourceBuffers:e,feedbackBuffers:r}}_createNewBuffer(t,e){const r=new pi(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}function Su(t){let e=100;const r=t.match(/[^\s]+/g);if(r.length>=2&&"#version"===r[0]){const t=parseInt(r[1],10);Number.isFinite(t)&&(e=t)}return e}const Ou={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null};function Au({vs:t,sourceTextureMap:e,targetTextureVarying:r,targetTexture:n}){let i=Object.keys(e).length,o=null;const s={};let a=t,u={};if(i>0||r){const t=a.split("\n"),c=t.slice();if(t.forEach(((t,n,a)=>{if(i>0){const r=function(t,e){const r={},n=function(t){return xu(t,["attribute","in"])}(t);if(!n)return null;const{type:i,name:o}=n;if(o&&e[o]){const e=`// ${t} => Replaced by Transform with a sampler`,{samplerName:n,sizeName:s,uniformDeclerations:a}=function(t){const e=`transform_uSampler_${t}`,r=`transform_uSize_${t}`;return{samplerName:e,sizeName:r,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${r};`}}(o),u=`  ${i} ${o} = transform_getInput(${n}, ${s}).${function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return fr(!1),null}}(i)};\n`;r[n]=o;return{updatedLine:e,inject:{"vs:#decl":a,"vs:#main-start":u},samplerTextureMap:r}}return null}(t,e);if(r){const{updatedLine:t,inject:e}=r;c[n]=t,u=Ir([u,e]),Object.assign(s,r.samplerTextureMap),i--}}r&&!o&&(o=function(t,e){const r=xu(t,["varying","out"]);if(!r)return null;return r.name===e?r.type:null}(t,r))})),r){Yn(n);const t=`transform_uSize_${r}`;u=Ir([u,{"vs:#decl":`uniform vec2 ${t};\n`,"vs:#main-start":`     vec2 transform_position = transform_getPos(${t});\n     gl_Position = vec4(transform_position, 0, 1.);\n`}])}a=c.join("\n")}return{vs:a,targetTextureType:o,inject:u,samplerTextureMap:s}}const Tu={10241:9728,10240:9728,10242:33071,10243:33071};class ku{constructor(t,e={}){this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(t={}){const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(t={}){const{sourceBuffers:e,sourceTextures:r,framebuffer:n,targetTexture:i}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let u=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const e in this.samplerTextureMap){const t=this.samplerTextureMap[e];s[e]=r[t]}this._setSourceTextureParameters();const t=function({sourceTextureMap:t,targetTextureVarying:e,targetTexture:r}){const n={};let i,o;e&&(({width:i,height:o}=r),n[`transform_uSize_${e}`]=[i,o]);for(const s in t)({width:i,height:o}=t[s]),n[`transform_uSize_${s}`]=[i,o];return n}({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(s,t)}return this.hasTargetTexture&&(u=!1,a.viewport=[0,0,n.width,n.height]),{attributes:o,framebuffer:n,uniforms:s,discard:u,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData({packed:t=!1}={}){const{framebuffer:e}=this.bindings[this.currentIndex],r=ji(e);if(!t)return r;const n=r.constructor,i=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return fr(!1),null}}(this.targetTextureType),o=new n(r.length*i/4);let s=0;for(let a=0;a<r.length;a+=4)for(let t=0;t<i;t++)o[s++]=r[a+t];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(t={}){const{_targetTextureVarying:e,_swapTexture:r}=t;this._swapTexture=r,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:r}=t;if(r instanceof xi)return r;const n=e[r];return n?(this._targetRefTexName=r,this._createNewTexture(n)):null}_setupTextures(t={}){const{sourceBuffers:e,_sourceTextures:r={},_targetTexture:n}=t,i=this._createTargetTexture({sourceTextures:r,textureOrReference:n});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:r,targetTexture:i}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!==typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,r)=>{r[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new pi(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:r,sourceTextures:n,targetTexture:i}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,n),Object.assign(t.sourceBuffers,r),i){t.targetTexture=i;const{width:e,height:r}=i,{framebuffer:n}=t;n?(n.update({attachments:{36064:i},resizeAttachments:!1}),n.resize({width:e,height:r})):t.framebuffer=new Ui(this.gl,{id:"transform-framebuffer",width:e,height:r,attachments:{36064:i}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const r in e)e[r].setParameters(Tu)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);e[this._swapTexture]=t.targetTexture;return{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=function(t,e){Yn(t instanceof xi||t instanceof Ti||t instanceof ki);const r=t.constructor,{gl:n,width:i,height:o,format:s,type:a,dataFormat:u,border:c,mipmaps:l}=t;return new r(n,Object.assign({width:i,height:o,format:s,type:a,dataFormat:u,border:c,mipmaps:l},e))}(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(t={}){const{sourceTextures:e,targetTexture:r}=this.bindings[this.currentIndex],{vs:n,uniforms:i,targetTextureType:o,inject:s,samplerTextureMap:a}=Au({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),u=Ir([t.inject||{},s]);this.targetTextureType=o,this.samplerTextureMap=a;return{vs:n,fs:t._fs||Eu({version:Su(n),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Ou].concat(t.modules||[]):t.modules,uniforms:i,inject:u}}}let Cu=null;function ju(t,e){var r;return new t((r=t.BYTES_PER_ELEMENT*e,(!Cu||Cu.byteLength<r)&&(Cu=new ArrayBuffer(r)),Cu),0,e)}class Iu extends ni{static isSupported(t,e={}){return!e.constantAttributeZero||(Jr(t)||"Chrome"===$a())}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new Iu(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return Iu.MAX_ATTRIBUTES=Iu.MAX_ATTRIBUTES||t.getParameter(34921),Iu.MAX_ATTRIBUTES}static setConstant(t,e,r){switch(r.constructor){case Float32Array:Iu._setConstantFloatArray(t,e,r);break;case Int32Array:Iu._setConstantIntArray(t,e,r);break;case Uint32Array:Iu._setConstantUintArray(t,e,r);break;default:Yn(!1)}}constructor(t,e={}){const r=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Iu.getMaxAttributes(this.gl)}initialize(t={}){return this.setProps(t)}setProps(t){return this}setElementBuffer(t=null,e={}){return Yn(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,r){if(34963===e.target)return this.setElementBuffer(e,r);const{size:n,type:i,stride:o,offset:s,normalized:a,integer:u,divisor:c}=r,{gl:l,gl2:h}=this;return t=Number(t),this.bind((()=>{l.bindBuffer(34962,e.handle),u?(Yn(Jr(l)),h.vertexAttribIPointer(t,n,i,o,s)):l.vertexAttribPointer(t,n,i,a,o,s),l.enableVertexAttribArray(t),h.vertexAttribDivisor(t,c||0)})),this}enable(t,e=!0){return!e&&0===t&&!Iu.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const r=this._normalizeConstantArrayValue(e),n=r.byteLength*t,i=r.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new pi(this.gl,n),o=o||this.buffer.reallocate(n),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const t=ju(e.constructor,i);!function({target:t,source:e,start:r=0,count:n=1}){const i=e.length,o=n*i;let s=0;for(let a=r;s<i;s++)t[a++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(r+s,r,r+s),s*=2):(t.copyWithin(r+s,r,r+o-s),s=o)}({target:t,source:r,start:0,count:i}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}static _setConstantFloatArray(t,e,r){switch(r.length){case 1:t.vertexAttrib1fv(e,r);break;case 2:t.vertexAttrib2fv(e,r);break;case 3:t.vertexAttrib3fv(e,r);break;case 4:t.vertexAttrib4fv(e,r);break;default:Yn(!1)}}static _setConstantIntArray(t,e,r){switch(Yn(Jr(t)),r.length){case 1:t.vertexAttribI1iv(e,r);break;case 2:t.vertexAttribI2iv(e,r);break;case 3:t.vertexAttribI3iv(e,r);break;case 4:t.vertexAttribI4iv(e,r);break;default:Yn(!1)}}static _setConstantUintArray(t,e,r){switch(Yn(Jr(t)),r.length){case 1:t.vertexAttribI1uiv(e,r);break;case 2:t.vertexAttribI2uiv(e,r);break;case 3:t.vertexAttribI3uiv(e,r);break;case 4:t.vertexAttribI4uiv(e,r);break;default:Yn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,{location:e}){return Yn(Number.isFinite(e)),this.bind((()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(e,t);default:return this.gl.getVertexAttrib(e,t)}}))}}const Ru=/^(.+)__LOCATION_([0-9]+)$/,Lu=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Du{constructor(t,e={}){const r=e.id||e.program&&e.program.id;this.id=r,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Iu(t),ei(this,"VertexArray","v6.0",Lu),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(t={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const r=t[e];this._setAttribute(e,r)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(t=null,e={}){return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e,r={}){if(34963===e.target)return this.setElementBuffer(e,r);const{location:n,accessor:i}=this._resolveLocationAndAccessor(t,e,e.accessor,r);return n>=0&&(this.values[n]=e,this.accessors[n]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(n,e,i)),this}setConstant(t,e,r={}){const{location:n,accessor:i}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},r));return n>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[n]=e,this.accessors[n]=i,this.clearDrawParams(),this.vertexArrayObject.enable(n,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new pi(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof pi&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof pi&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,r){let n;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),n=r()})),n}_resolveLocationAndAccessor(t,e,r,n){const i={location:-1,accessor:null},{location:o,name:s}=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,Hr.once(3,(()=>`unused value ${t} in ${this.id}`))(),i;const a=this._getAttributeInfo(s||o);if(!a)return i;const u=this.accessors[o]||{},c=li.resolve(a.accessor,u,r,n),{size:l,type:h}=c;return Yn(Number.isFinite(l)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const r=Ru.exec(t),n=r?r[1]:t,i=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(n)+i,name:n}:{location:-1}}_setAttribute(t,e){if(e instanceof pi)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof pi){const r=e[0],n=e[1];this.setBuffer(t,r,n)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const r=e;this.setConstant(t,r)}else{if(!(e.buffer instanceof pi))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const r=e;this.setBuffer(t,r.buffer,r)}}}_setConstantAttributes(t,e){const r=Math.max(0|t,0|e);let n=this.values[0];ArrayBuffer.isView(n)&&this._setConstantAttributeZero(n,r);for(let i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)n=this.values[i],ArrayBuffer.isView(n)&&this._setConstantAttribute(i,n)}_setConstantAttributeZero(t,e){if(Iu.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const r=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(t,e){Iu.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const r=this.values[e],n=this.accessors[e];if(!r)return;const{divisor:i}=n,o=i>0;if(t.isInstanced=t.isInstanced||o,r instanceof pi){const e=r;if(o){const r=e.getVertexCount(n);t.instanceCount=Math.min(t.instanceCount,r)}else{const r=e.getVertexCount(n);t.vertexCount=Math.min(t.vertexCount,r)}}}setElements(t=null,e={}){return Hr.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function Fu(t,e={}){const{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){const{maxElts:r=16,size:n=1}=e;let i="[";for(let o=0;o<t.length&&o<r;++o)o>0&&(i+=","+(o%n===0?" ":"")),i+=Fu(t[o],e);return`${i}${t.length>r?"...":"]"}`}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return r?"0":"0.";if(r)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const n=t.toPrecision(2);return n.indexOf(".0")===n.length-2?n.slice(0,-1):n}function Nu(t,e,r,n){const{gl:i}=t;if(!e)return{[n]:"null","Format ":"N/A"};let o,s,a,u="NOT PROVIDED",c=1,l=0,h=0;if(r&&(u=r.type,c=r.size,u=String(u).replace("Array",""),o=-1!==u.indexOf("nt")),e instanceof pi){const t=e,{data:f,changed:d}=t.getDebugData();let p;if(s=d?"*":"",a=f,h=t.byteLength,l=h/f.BYTES_PER_ELEMENT/c,r){p=`${r.divisor>0?"I ":"P "} ${l} (x${c}=${h} bytes ${qn(i,u)})`}else o=!0,p=`${h} bytes`;return{[n]:`${s}${Fu(a,{size:c,isInteger:o})}`,"Format ":p}}return a=e,c=e.length,u=String(e.constructor.name).replace("Array",""),o=-1!==u.indexOf("nt"),{[n]:`${Fu(a,{size:c,isInteger:o})} (constant)`,"Format ":`${c}x${u} (constant)`}}function Bu(t,e){const{type:r,size:n}=e,i=bo(r,n);return i?`${t} (${i.name})`:t}function zu({header:t="Uniforms",program:e,uniforms:r,undefinedOnly:n=!1}){Yn(e);const i=".*Matrix",o=e._uniformSetters,s={},a=Object.keys(o).sort();let u=0;for(const h of a)h.match(".*_.*")||h.match(i)||Uu({table:s,header:t,uniforms:r,uniformName:h,undefinedOnly:n})&&u++;for(const h of a)h.match(i)&&Uu({table:s,header:t,uniforms:r,uniformName:h,undefinedOnly:n})&&u++;for(const h of a)s[h]||Uu({table:s,header:t,uniforms:r,uniformName:h,undefinedOnly:n})&&u++;let c=0;const l={};if(!n)for(const h in r){const e=r[h];s[h]||(c++,l[h]={Type:`NOT USED: ${e}`,[t]:Fu(e)})}return{table:s,count:u,unusedTable:l,unusedCount:c}}function Uu({table:t,header:e,uniforms:r,uniformName:n,undefinedOnly:i}){const o=r[n],s=function(t){return void 0!==t&&null!==t}(o);return(!i||!s)&&(t[n]={[e]:s?Fu(o):"N/A","Uniform Type":s?o:"NOT PROVIDED"},!0)}function Vu(t){const{type:e,size:r}=t.accessor,n=bo(e,r);return n?`${n.name} ${t.name}`:t.name}const Gu={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Wu(t,e){const{attributeMap:r=Gu}=e||{};return r&&r[t]||t}function Zu(t,e){let r;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":r="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":r="vectors"}switch(r){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}Yn(Number.isFinite(e.size),`attribute ${t} needs size`)}const $u=()=>{},Xu={};class Yu{constructor(t,e={}){const{id:r=Qn("model")}=e;Yn(Qr(t)),this.id=r,this.gl=t,this.id=e.id||Qn("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||Po.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:r,fs:n,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c}=t;this.programProps={program:e,vs:r,fs:n,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},Yn(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:r,fs:n,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c}=t;this.programProps={program:e,vs:r,fs:n,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return Yn(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return Yn(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,r){const n={};let i=e.indices;for(const o in e.attributes){const s=e.attributes[o],a=Wu(o,r);if("indices"===o)i=s;else if(s.constant)n[a]=s.value;else{const e=s.value,r={...s};delete r.value,n[a]=[new pi(t,e),r],Zu(o,r)}}if(i){const e=i.value||i;Yn(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const r={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};n.indices=[new pi(t,{data:e,target:34963}),r]}return n}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(t={}){if(ti(t))return this;const e={};for(const r in t){const n=t[r];e[r]=n.getValue?n.getValue():n}return this.vertexArray.setAttributes(e),this}setUniforms(t={}){return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return Oi(this.program.gl,t),this}draw(t={}){this._checkProgram();const{moduleSettings:e=null,framebuffer:r,uniforms:n={},attributes:i={},transformFeedback:o=this.transformFeedback,parameters:s={},vertexArray:a=this.vertexArray}=t;let u;this.setAttributes(i),this.updateModuleSettings(e),this.setUniforms(n),Hr.priority>=2&&(u=this._logDrawCallStart(2));const c=this.vertexArray.getDrawParams(),{isIndexed:l=c.isIndexed,indexType:h=c.indexType,indexOffset:f=c.indexOffset,vertexArrayInstanced:d=c.isInstanced}=this.props;d&&!this.isInstanced&&Hr.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=$u,onAfterRender:y=$u}=this.props;m(),this.program.setUniforms(this.uniforms);const v=this.program.draw(Object.assign(Xu,t,{logPriority:u,uniforms:null,framebuffer:r,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:o,isIndexed:l,indexType:h,isInstanced:p,instanceCount:g,offset:l?f:0}));return y(),Hr.priority>=2&&this._logDrawCallEnd(u,a,r),v}transform(t={}){const{discard:e=!0,feedbackBuffers:r,unbindModels:n=[]}=t;let{parameters:i}=t;r&&this._setFeedbackBuffers(r),e&&(i=Object.assign({},i,{35977:e})),n.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:i}))}finally{n.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(t={}){return Hr.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:r,modules:n,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:e,fs:r,modules:n,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Yn(t instanceof Eo,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Du(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof pi&&e.delete()}}_setAnimationProps(t){this.animated&&Yn(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(t={}){if(ti(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new Pu(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),Hr.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:Hr.level<=2})(),t}_logDrawCallEnd(t,e,r,n){if(void 0===t)return;const i=function({vertexArray:t,header:e="Attributes"}){if(!t.configuration)return{};const r={};t.elements&&(r.ELEMENT_ARRAY_BUFFER=Nu(t,t.elements,null,e));const n=t.values;for(const i in n){const o=t._getAttributeInfo(i);if(o){let s=`${i}: ${o.name}`;const a=t.accessors[o.location];a&&(s=`${i}: ${Bu(o.name,a)}`),r[s]=Nu(t,n[i],a,e)}}return r}({vertexArray:e,header:`${this.id} attributes`,attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=zu({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:u,count:c}=zu({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});c>0&&Hr.log("MISSING UNIFORMS",Object.keys(u))(),a>0&&Hr.log("UNUSED UNIFORMS",Object.keys(s))();const l=function(t){const e={},r=`Accessors for ${t.id}`;for(const n of t.attributeInfos)n&&(e[`in ${Vu(n)}`]={[r]:JSON.stringify(n.accessor)});for(const n of t.varyingInfos)n&&(e[`out ${Vu(n)}`]={[r]:JSON.stringify(n.accessor)});return e}(this.vertexArray.configuration);Hr.table(t,i)(),Hr.table(t,o)(),Hr.table(t+1,l)(),n&&n.log({logLevel:2,message:`Rendered to ${n.id}`}),Hr.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}class Hu{static isSupported(t){return Jr(t)}constructor(t,e={}){this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:r}=this;t&&t.delete(),e&&e.delete(),r&&r.delete()}run(t={}){const{clearRenderTarget:e=!0}=t,r=this._updateDrawOptions(t);e&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of e)t=t||r.swap();Yn(t,"Nothing to swap")}getBuffer(t=null){return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(t={}){const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of e){const e=r.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(t={}){"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of e)r.update(t)}_initialize(t={}){const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new Yu(e,Object.assign({},t,{fs:t.fs||Eu({version:Su(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of r)e=n.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){if(!ti(t.feedbackBuffers)||!ti(t.feedbackMap)||t.varyings&&t.varyings.length>0)return!0;return!1})(e)&&(this.bufferTransform=new Mu(t,e)),function(t){if(!ti(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)return!0;return!1}(e)&&(this.textureTransform=new ku(t,e)),Yn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of r)e=Object.assign(e,n.getDrawOptions(e));return e}}const qu="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";const Ku={interpolation:class{constructor({gl:t,attribute:e,timeline:r}){this.gl=t,this.type="interpolation",this.transition=new us(r),this.attribute=e,this.attributeInTransition=new bu(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const r=gu(e.size);return new Hu(t,{vs:qu,defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"]})}(t,e);const n={byteLength:0,usage:35050};this.buffers=[new pi(t,n),new pi(t,n)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();const{gl:r,buffers:n,attribute:i}=this;mu(n);const o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of n)vu({buffer:s,...o});this.currentStartIndices=i.startIndices,this.currentLength=yu(i,e),this.attributeInTransition.update({buffer:n[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:n[0],aTo:pu(0,i)},feedbackBuffers:{vCurrent:n[1]}})}update(){const t=this.transition.update();if(t){const{time:t,settings:{duration:e,easing:r}}=this.transition,n=r(t/e);this.transform.run({uniforms:{time:n}})}return t}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:t,attribute:e,timeline:r}){this.gl=t,this.type="spring",this.transition=new us(r),this.attribute=e,this.attributeInTransition=new bu(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new xi(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new Ui(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,r){const n=gu(e.size);return new Hu(t,{framebuffer:r,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:n},varyings:["vNext"]})}(t,e,this.framebuffer);const n={byteLength:0,usage:35050};this.buffers=[new pi(t,n),new pi(t,n),new pi(t,n)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:r,buffers:n,attribute:i}=this,o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of n)vu({buffer:s,...o});this.currentStartIndices=i.startIndices,this.currentLength=yu(i,e),this.attributeInTransition.update({buffer:n[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:pu(0,i)}})}update(){const{buffers:t,transform:e,framebuffer:r,transition:n}=this;if(!n.update())return!1;e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:n.settings.stiffness,damping:n.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),mu(t),this.attributeInTransition.update({buffer:t[1],value:this.attribute.value});return ji(r)[0]>0||n.end(),!0}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Qu{constructor(t,{id:e,timeline:r}){this.id=e,this.gl=t,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Hu.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:r}){this.numInstances=r||1;for(const n in t){const r=t[n],i=r.getTransitionSetting(e);i&&this._updateAttribute(n,r,i)}for(const n in this.transitions){const r=t[n];r&&r.getTransitionSetting(e)||this._removeTransition(n)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const r=this.transitions[e];r.inProgress&&(t[e]=r.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const e in this.transitions){this.transitions[e].update()&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,r){const n=this.transitions[t];let i=!n||n.type!==r.type;if(i){if(!this.isSupported)return void V.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();n&&this._removeTransition(t);const o=Ku[r.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(V.error("unsupported transition type '".concat(r.type,"'"))(),i=!1)}(i||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(r,this.numInstances))}}const Ju="attributeManager.invalidate";class tc{constructor(t,{id:e="attribute-manager",stats:r,timeline:n}={}){this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Qu(t,{id:"".concat(e,"-transitions"),timeline:n}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(t=!0){return this.needsRedraw=!0,this}add(t,e){this._add(t,e)}addInstanced(t,e){this._add(t,e,{instanced:1})}remove(t){for(let e=0;e<t.length;e++){const r=t[e];void 0!==this.attributes[r]&&(this.attributes[r].delete(),delete this.attributes[r])}}invalidate(t,e){const r=this._invalidateTrigger(t,e);W(Ju,this,t,r)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);W(Ju,this,"all")}update({data:t,numInstances:e,startIndices:r=null,transitions:n,props:i={},buffers:o={},context:s={}}={}){let a=!1;W("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const n=this.attributes[u],c=n.settings.accessor;n.startIndices=r,i[u]&&V.removed("props.".concat(u),"data.attributes.".concat(u))(),n.setExternalBuffer(o[u])||n.setBinaryValue(o[c],t.startIndices)||!o[c]&&n.setConstantValue(i[c])||n.needsUpdate()&&(a=!0,this._updateAttribute({attribute:n,numInstances:e,data:t,props:i,context:s})),this.needsRedraw|=n.needsRedraw()}a&&W("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:n})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:r}=this,n={...r.getAttributes()};for(const i in e){const o=e[i];o.needsRedraw(t)&&!r.hasAttribute(i)&&(n[i]=o)}return n}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const r={};for(const n in t)e[n]||Object.assign(r,t[n].getShaderAttributes());return r}getAccessors(){return this.updateTriggers}_add(t,e,r={}){e&&V.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const n in t){const e=t[n];this.attributes[n]=this._createAttribute(n,e,r)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,r){const n={...e,id:t,isIndexed:e.isIndexed||e.elements||!1,constant:e.constant||!1,size:(e.elements?1:e.size)||1,value:e.value||null,divisor:e.instanced||r.instanced?1:e.divisor||0};return new bu(this.gl,n)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){this.attributes[e].getUpdateTriggers().forEach((r=>{t[r]||(t[r]=[]),t[r].push(e)}))}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:r,updateTriggers:n}=this,i=n[t];return i&&i.forEach((t=>{const n=r[t];n&&n.setNeedsUpdate(n.id,e)})),i}_updateAttribute(t){const{attribute:e,numInstances:r}=t;if(W("attribute.updateStart",e),e.constant)return void e.setConstantValue(e.value);e.allocate(r)&&W("attribute.allocate",e,r);e.updateBuffer(t)&&(this.needsRedraw=!0,W("attribute.updateEnd",e,r))}}const ec=1e-5;function rc(t,e,r,n,i){const o=e-t;return(r-e)*i+-o*n+o+e}function nc(t,e){if(Array.isArray(t)){let r=0;for(let n=0;n<t.length;n++){const i=t[n]-e[n];r+=i*i}return Math.sqrt(r)}return Math.abs(t-e)}const ic={interpolation:class extends us{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:r,duration:n,easing:i}}=this,o=i(t/n);this._value=Pe(e,r,o)}},spring:class extends us{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:r,stiffness:n}=this.settings,{_prevValue:i=t,_currValue:o=t}=this;let s=function(t,e,r,n,i){if(Array.isArray(r)){const o=[];for(let s=0;s<r.length;s++)o[s]=rc(t[s],e[s],r[s],n,i);return o}return rc(t,e,r,n,i)}(i,o,e,r,n);const a=nc(s,e),u=nc(s,o);a<ec&&u<ec&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}};class oc{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,r,n){const{transitions:i}=this;if(i.has(t)){const r=i.get(t),{value:n=r.settings.fromValue}=r;e=n,this.remove(t)}if(!(n=du(n)))return;const o=ic[n.type];if(!o)return void V.error("unsupported transition type '".concat(n.type,"'"))();const s=new o(this.timeline);s.start({...n,fromValue:e,toValue:r}),i.set(t,s)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,r]of this.transitions)r.update(),t[e]=r.value,r.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}const{COMPONENT:sc}=g;function ac(t,e){const r=cc({newProps:t,oldProps:e,propTypes:dc(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=function(t,e){if(null===e)return"oldProps is null, initial diff";let r=null;const{dataComparator:n,_dataDiff:i}=t;n?n(t.data,e.data)||(r="Data comparator detected a change"):t.data!==e.data&&(r="A new data container was supplied");r&&i&&(r=i(t.data,e.data)||r);return r}(t,e);let i=!1;return n||(i=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers){if(fc(t,e,"all"))return{all:!0}}const r={};let n=!1;for(const i in t.updateTriggers)if("all"!==i){fc(t,e,i)&&(r[i]=!0,n=r)}return n}(t,e)),{dataChanged:n,propsChanged:r,updateTriggersChanged:i,extensionsChanged:hc(t,e),transitionsChanged:uc(t,e)}}function uc(t,e){if(!t.transitions)return null;const r={},n=dc(t);for(const i in t.transitions){const o=n[i],s=o&&o.type;("number"===s||"color"===s||"array"===s)&&lc(t[i],e[i],o)&&(r[i]=!0)}return r}function cc({newProps:t,oldProps:e,ignoreProps:r={},propTypes:n={},triggerName:i="props"}={}){if(e===t)return null;if("object"!==typeof t||null===t)return"".concat(i," changed shallowly");if("object"!==typeof e||null===e)return"".concat(i," changed shallowly");for(const o of Object.keys(t))if(!(o in r)){if(!(o in e))return"".concat(i,".").concat(o," added");const r=lc(t[o],e[o],n[o]);if(r)return"".concat(i,".").concat(o," ").concat(r)}for(const o of Object.keys(e))if(!(o in r)){if(!(o in t))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const r=lc(t[o],e[o],n[o]);if(r)return"".concat(i,".").concat(o," ").concat(r)}}return null}function lc(t,e,r){let n=r&&r.equal;return n&&!n(t,e,r)?"changed deeply":n||(n=t&&e&&t.equals,!n||n.call(t,e))?n||e===t?null:"changed shallowly":"changed deeply"}function hc(t,e){if(null===e)return"oldProps is null, initial diff";const r=e.extensions,{extensions:n}=t;if(n===r)return!1;if(!r||!n)return!0;if(n.length!==r.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(r[i]))return!0;return!1}function fc(t,e,r){let n=t.updateTriggers[r];n=void 0===n||null===n?{}:n;let i=e.updateTriggers[r];i=void 0===i||null===i?{}:i;return cc({oldProps:i,newProps:n,triggerName:r})}function dc(t){const e=t[sc],r=e&&e.constructor;return r?r._propTypes:{}}function pc(t){if(null===(e=t)||"object"!==typeof e)throw new Error("count(): argument not an object");var e;if("function"===typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"===typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}function gc(t,e){if(!e)return t;const r={...t,...e};if("defines"in e&&(r.defines={...t.defines,...e.defines}),"modules"in e&&(r.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=r.modules.findIndex((t=>"project32"===t.name));t>=0&&r.modules.splice(t,1)}if("inject"in e)if(t.inject){const n={...t.inject};for(const t in e.inject)n[t]=(n[t]||"")+e.inject[t];r.inject=n}else r.inject=e.inject;return r}var mc=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t};!function(){var t=function(){var t=new Co(3);return Co!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function yc(t,e,r=!1){const n=e.projectPosition(t);if(r&&e instanceof os){const[r,i,o=0]=t,s=e.getDistanceScales([r,i]);n[2]=o*s.unitsPerMeter[2]}return n}function vc(t,{viewport:e,modelMatrix:r,coordinateSystem:n,coordinateOrigin:i,offsetMode:o}){let[s,a,u=0]=t;switch(r&&([s,a,u]=jo([],[s,a,u,1],r)),n){case er.LNGLAT:return yc([s,a,u],e,o);case er.LNGLAT_OFFSETS:return yc([s+i[0],a+i[1],u+(i[2]||0)],e,o);case er.METER_OFFSETS:return yc((0,tr.eG)(i,[s,a,u]),e,o);case er.CARTESIAN:default:return e.isGeospatial?[s+i[0],a+i[1],u+i[2]]:e.projectPosition([s,a,u])}}function bc(t,e){const{viewport:r,coordinateSystem:n,coordinateOrigin:i,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=function(t){const e={...t};let{coordinateSystem:r}=t;const{viewport:n,coordinateOrigin:i,fromCoordinateSystem:o,fromCoordinateOrigin:s}=t;return r===er.DEFAULT&&(r=n.isGeospatial?er.LNGLAT:er.CARTESIAN),void 0===o&&(e.fromCoordinateSystem=r),void 0===s&&(e.fromCoordinateOrigin=i),e.coordinateSystem=r,e}(e),{geospatialOrigin:u,shaderCoordinateOrigin:c,offsetMode:l}=Uo(r,n,i),h=vc(t,{viewport:r,modelMatrix:o,coordinateSystem:s,coordinateOrigin:a,offsetMode:l});if(l){const t=r.projectPosition(u||c);mc(h,h,t)}return h}const _c={10241:9987,10240:9729,10242:33071,10243:33071},wc={};const xc={boolean:{validate:(t,e)=>!0,equal:(t,e,r)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||Sc(t)&&(3===t.length||4===t.length),equal:(t,e,r)=>Ec(t,e)},accessor:{validate(t,e){const r=Oc(t);return"function"===r||r===Oc(e.value)},equal:(t,e,r)=>"function"===typeof e||Ec(t,e)},array:{validate:(t,e)=>e.optional&&!t||Sc(t),equal:(t,e,r)=>r.compare?Ec(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"===typeof t,equal:(t,e,r)=>!r.compare||t===e},data:{transform:(t,e,r)=>{const{dataTransform:n}=r?r.props:{};return n&&t?n(t):t}},image:{transform:(t,e,r)=>function(t,e){const r=t.context&&t.context.gl;if(!r||!e)return null;if(e instanceof xi)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let n=null;e.compressed&&(n={10241:e.data.length>1?9985:9729});const i=new xi(r,{...e,parameters:{..._c,...n,...t.props.textureParameters}});return wc[i.id]=!0,i}(r,t),release:t=>{var e;(e=t)&&e instanceof xi&&wc[e.id]&&(e.delete(),delete wc[e.id])}}};function Ec(t,e){if(t===e)return!0;if(!Sc(t)||!Sc(e))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Pc(t,e){switch(Oc(e)){case"object":return Mc(t,e);case"array":return Mc(t,{type:"array",value:e,compare:!1});case"boolean":return Mc(t,{type:"boolean",value:e});case"number":return Mc(t,{type:"number",value:e});case"function":return Mc(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Mc(t,e){return"type"in e?{name:t,...xc[e.type],...e}:"value"in e?{name:t,type:Oc(e.value),...e}:{name:t,type:"object",value:e}}function Sc(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Oc(t){return Sc(t)?"array":null===t?"null":typeof t}const{COMPONENT:Ac,ASYNC_ORIGINAL:Tc,ASYNC_RESOLVED:kc,ASYNC_DEFAULTS:Cc}=g;function jc(){const t=this,e=Ic(t.constructor),r=Object.create(e);r[Ac]=t,r[Tc]={},r[kc]={};for(let n=0;n<arguments.length;++n){const t=arguments[n];for(const e in t)r[e]=t[e]}return Object.freeze(r),r}function Ic(t){const e=Dc(t,"_mergedDefaultProps");return e||(function(t){if(!t.prototype)return;const e=Object.getPrototypeOf(t),r=Ic(e),n=function(t){const e={},r={},n={};for(const[i,o]of Object.entries(t))if(o&&o.deprecatedFor)n[i]=Array.isArray(o.deprecatedFor)?o.deprecatedFor:[o.deprecatedFor];else{const t=Pc(i,o);e[i]=t,r[i]=t.value}return{propTypes:e,defaultProps:r,deprecatedProps:n}}(Dc(t,"defaultProps")||{}),i=function(t,e,r){const n=Object.create(null);Object.assign(n,e,t);const i=function(t){const e=Dc(t,"layerName")||Dc(t,"componentName");e||V.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(r);return delete t.id,Object.defineProperties(n,{id:{writable:!0,value:i}}),n}(n.defaultProps,r,t),o={...e._propTypes,...n.propTypes};!function(t,e){const r={},n={};for(const i in e){const t=e[i],{name:o,value:s}=t;t.async&&(r[o]=s,n[o]=Rc(o))}t[Cc]=r,t[Tc]={},Object.defineProperties(t,n)}(i,o);const s={...e._deprecatedProps,...n.deprecatedProps};(function(t,e){for(const r in e)Object.defineProperty(t,r,{enumerable:!1,set(t){const n="".concat(this.id,": ").concat(r);for(const i of e[r])Lc(this,i)||(this[i]=t);V.deprecated(n,e[r].join("/"))()}})})(i,s),t._mergedDefaultProps=i,t._propTypes=o,t._deprecatedProps=s}(t),t._mergedDefaultProps)}function Rc(t){return{enumerable:!0,set(e){"string"===typeof e||e instanceof Promise||uu(e)?this[Tc][t]=e:this[kc][t]=e},get(){if(this[kc]){if(t in this[kc]){return this[kc][t]||this[Cc][t]}if(t in this[Tc]){const e=this[Ac]&&this[Ac].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Cc][t]}}return this[Cc][t]}}}function Lc(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Dc(t,e){return Lc(t,e)&&t[e]}const{ASYNC_ORIGINAL:Fc,ASYNC_RESOLVED:Nc,ASYNC_DEFAULTS:Bc}=g,zc=Object.freeze({});class Uc{constructor(t=null){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=zc,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[Nc]||{},r=t[Fc]||t,n=t[Bc]||{};for(const i in e){const t=e[i];this._createAsyncPropData(i,n[i]),this._updateAsyncProp(i,t),e[i]=this.getAsyncProp(i)}for(const i in r){const t=r[i];this._createAsyncPropData(i,n[i]),this._updateAsyncProp(i,t)}}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"===typeof e){var r;const n=null===(r=this.layer)||void 0===r?void 0:r.props.fetch,i=e;n&&(e=n(i,{propName:t,layer:this.layer}))}e instanceof Promise?this._watchPromise(t,e):uu(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e)}}_didAsyncInputValueChange(t,e){const r=this.asyncProps[t];return e!==r.resolvedValue&&e!==r.lastValue&&(r.lastValue=e,!0)}_setPropValue(t,e){this.freezeAsyncOldProps();const r=this.asyncProps[t];e=this._postProcessValue(r,e),r.resolvedValue=e,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount}_setAsyncPropValue(t,e,r){const n=this.asyncProps[t];n&&r>=n.resolvedLoadCount&&void 0!==e&&(this.freezeAsyncOldProps(),n.resolvedValue=e,n.resolvedLoadCount=r,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const r=this.asyncProps[t];r.pendingLoadCount++;const n=r.pendingLoadCount;e.then((e=>{var i;e=this._postProcessValue(r,e),this._setAsyncPropValue(t,e,n);const o=null===(i=this.layer)||void 0===i?void 0:i.props.onDataLoad;"data"===t&&o&&o(e,{propName:t,layer:this.layer})})).catch((e=>{var r;null===(r=this.layer)||void 0===r||r.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}))}async _resolveAsyncIterable(t,e){var r;"data"!==t&&this._setPropValue(t,e);const n=this.asyncProps[t];n.pendingLoadCount++;const i=n.pendingLoadCount;let o=[],s=0;for await(const u of e){const{dataTransform:e}=this.component?this.component.props:{};o=e?e(u,o):o.concat(u),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(t,o,i)}const a=null===(r=this.layer)||void 0===r?void 0:r.props.onDataLoad;a&&a(o,{propName:t,layer:this.layer})}_postProcessValue(t,e){const r=t.type;return r&&(r.release&&r.release(t.resolvedValue,r,this.component),r.transform)?r.transform(e,r,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:r&&r[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:Vc,ASYNC_RESOLVED:Gc,ASYNC_DEFAULTS:Wc}=g;let Zc=0;class $c{constructor(){this.props=jc.apply(this,arguments),this.id=this.props.id,this.count=Zc++,this.lifecycle=c,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}get root(){let t=this;for(;t.parent;)t=t.parent;return t}clone(t){const{props:e}=this,r={};for(const n in e[Wc])n in e[Gc]?r[n]=e[Gc][n]:n in e[Vc]&&(r[n]=e[Vc][n]);return new this.constructor({...e,...r,...t})}get stats(){return this.internalState.stats}_initState(){this.internalState=new Uc({})}}$c.componentName="Component",$c.defaultProps={};class Xc extends Uc{constructor({attributeManager:t,layer:e}){super(e),this.attributeManager=t,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}}const Yc=2**24-1,Hc=Object.freeze([]),qc=Ro((({oldViewport:t,viewport:e})=>t.equals(e)));let Kc=new Uint8ClampedArray(0);const Qc={data:{type:"data",value:Hc,async:!0},dataComparator:null,_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:r,loaders:n,loadOptions:i,signal:o})=>{const{resourceManager:s}=r.context;var a;(i=i||r.getLoadOptions(),n=n||r.props.loaders,o)&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:o}});let u=s.contains(t);return u||i||(s.add({resourceId:t,data:ge(t,n),persistent:!1}),u=!0),u?s.subscribe({resourceId:t,onChange:t=>r.internalState.reloadAsyncProp(e,t),consumerId:r.id,requestId:e}):ge(t,n,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:er.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Jc extends $c{toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}raiseError(t,e){var r,n,i,o;(e&&(t.message="".concat(e,": ").concat(t.message)),null===(r=(n=this.props).onError)||void 0===r?void 0:r.call(n,t))||(null===(i=this.context)||void 0===i||null===(o=i.onError)||void 0===o||o.call(i,t,this))}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:e}=this.context,r=vc(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[n,i,o]=(0,tr.aW)(r,e.pixelProjectionMatrix);return 2===t.length?[n,i]:[n,i,o]}unproject(t){const{viewport:e}=this.context;return e.unproject(t)}projectPosition(t){return bc(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===er.DEFAULT||t===er.LNGLAT||t===er.CARTESIAN}onHover(t,e){return!!this.props.onHover&&this.props.onHover(t,e)}onClick(t,e){return!!this.props.onClick&&this.props.onClick(t,e)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){ts(t instanceof Uint8Array);const[e,r,n]=t;return e+256*r+65536*n-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const e of this.props.extensions)t=gc(t,e.getShaders.call(this,e));return t}shouldUpdateState({oldProps:t,props:e,context:r,changeFlags:n}){return n.propsOrDataChanged}updateState({oldProps:t,props:e,context:r,changeFlags:n}){const i=this.getAttributeManager();if(n.dataChanged&&i){const{dataChanged:t}=n;if(Array.isArray(t))for(const e of t)i.invalidateAll(e);else i.invalidateAll()}const o=t.highlightedObjectIndex>=0||t.pickable,s=e.highlightedObjectIndex>=0||e.pickable;if(o!==s&&i){const{pickingColors:t,instancePickingColors:e}=i.attributes,r=t||e;r&&(s&&r.constant&&(r.constant=!1,i.invalidate(r.id)),r.value||s||(r.constant=!0,r.value=[0,0,0]))}}finalizeState(){for(const e of this.getModels())e.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e}){const{index:r}=t;return r>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[r]),t}activateViewport(t){const e=this.internalState.viewport;this.internalState.viewport=t,e&&qc({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",e=""){const r=this.getAttributeManager();r&&("all"===t?r.invalidateAll():r.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(t){const e=this.getAttributeManager();if(!e)return;const r=this.getNumInstances(t),n=this.getStartIndices(t);e.update({data:t.data,numInstances:r,startIndices:n,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),r=Object.create(this.props);for(const t in e)Object.defineProperty(r,t,{value:e[t]});return r}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const r=Math.floor(Kc.length/3);if(this.internalState.usesPickingColorCache=!0,r<e){e>Yc&&V.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Kc=ve.allocate(Kc,e,{size:3,copy:!0,maxCount:Math.max(e,Yc)});const t=Math.floor(Kc.length/3),n=[];for(let e=r;e<t;e++)this.encodePickingColor(e,n),Kc[3*e+0]=n[0],Kc[3*e+1]=n[1],Kc[3*e+2]=n[2]}t.value=Kc.subarray(0,3*e)}_setModelAttributes(t,e){const r=this.getAttributeManager(),n=t.userData.excludeAttributes||{},i=r.getShaderAttributes(e,n);t.setAttributes(i)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:r}=this.getAttributeManager().attributes,n=e||r,i=n.getVertexOffset(t),o=n.getVertexOffset(t+1);n.buffer.subData({data:new Uint8Array(o-i),offset:i})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,r=t||e;this.internalState.usesPickingColorCache&&r.value.buffer!==Kc.buffer&&(r.value=Kc.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:pc(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){W("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();W("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,e=this.context.viewport,r=this._updateUniformTransition();this.internalState.propsInTransition=r,this.context.viewport=this.internalState.viewport||e,this.props=r;try{const r=this._getUpdateParams(),i=this.getModels();if(this.context.gl)this.updateState(r);else try{this.updateState(r)}catch(n){}for(const t of this.props.extensions)t.updateState.call(this,r,t);const o=this.getModels()[0]!==i[0];this._updateModules(r,o),this.isComposite?this._renderLayers(r):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=e,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){W("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:e={},parameters:r={}}){this._updateAttributeTransition();const n=this.props;this.props=this.internalState.propsInTransition||n;const{opacity:i}=this.props;e.opacity=Math.pow(i,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:i}=this.props,o=i&&i(e)||[0,0];Rn(this.context.gl,{polygonOffset:o}),Ln(this.context.gl,r,(()=>{const n={moduleParameters:t,uniforms:e,parameters:r,context:this.context};for(const t of this.props.extensions)t.draw.call(this,n,t);this.draw(n)}))}finally{this.props=n}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:e}=this.internalState;for(const n in t)if(t[n]){let r=!1;switch(n){case"dataChanged":Array.isArray(e[n])&&(e[n]=Array.isArray(t[n])?e[n].concat(t[n]):t[n],r=!0);default:e[n]||(e[n]=t[n],r=!0)}r&&W("layer.changeFlag",this,n,t)}const r=e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged;e.propsOrDataChanged=r,e.somethingChanged=r||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,e){const r=ac(t,e);if(r.updateTriggersChanged)for(const n in r.updateTriggersChanged)r.updateTriggersChanged[n]&&this.invalidateAttribute(n);if(r.transitionsChanged)for(const n in r.transitionsChanged)this.internalState.uniformTransitions.add(n,e[n],t[n],t.transitions[n]);return this.setChangeFlags(r)}validateProps(){!function(t){const e=dc(t);for(const r in e){const n=e[r],{validate:i}=n;if(i&&!i(t[r],n))throw new Error("Invalid prop ".concat(r,": ").concat(t[r]))}}(this.props)}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:r}=this.props;t.picked&&"function"===typeof r&&(e.pickingHighlightColor=r(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_updateModules({props:t,oldProps:e},r){const{autoHighlight:n,highlightedObjectIndex:i,highlightColor:o}=t;if(r||e.autoHighlight!==n||e.highlightedObjectIndex!==i||e.highlightColor!==o){const t={};n||(t.pickingSelectedColor=null),Array.isArray(o)&&(t.pickingHighlightColor=o),Number.isInteger(i)&&(t.pickingSelectedColor=i>=0?this.encodePickingColor(i):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const r=this.getAttributeManager(),n=r&&r.getNeedsRedraw(t);return e=e||n,e}_getAttributeManager(){return new tc(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){ts(!this.internalState&&!this.state),ts(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Xc({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(V.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new oc(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){W("layer.matched",this,this===t);const{state:e,internalState:r}=t;this!==t&&(this.internalState=r,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}function tl(t){return t?"function"===typeof t?(0,n.createElement)(es,{},t):Array.isArray(t)?t.map(tl):t.type===n.Fragment?tl(t.props.children):(ru(t.type,es),t):t}Jc.layerName="Layer",Jc.defaultProps=Qc;const el={position:"absolute",zIndex:-1};function rl(t,e){return t?"function"===typeof t?t(e):Array.isArray(t)?t.map((t=>rl(t,e))):function(t){const e=t&&t.type,r=e&&e.defaultProps;return r&&r.mapStyle}(t)?(e.style=el,(0,n.cloneElement)(t,e)):function(t){const e=t&&t.type;return e&&e.deckGLViewProps}(t)?(0,n.cloneElement)(t,e):t:t}const nl={mixBlendMode:null};function il(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}const ol=(0,n.forwardRef)(((t,e)=>{const r=(0,n.useRef)({}).current,[i,o]=(0,n.useState)(0);r.forceUpdate=o;const s=(0,n.useRef)(null),a=(0,n.useRef)(null),u=(0,n.useMemo)((()=>function({children:t,layers:e,views:r}){const i=[],o=[],s={};return n.Children.forEach(tl(t),(t=>{if(t){const e=t.type;if(ru(e,Jc)){const r=function(t,e){const r={},n=t.defaultProps||{};for(const i in e)n[i]!==e[i]&&(r[i]=e[i]);return new t(r)}(e,t.props);o.push(r)}else i.push(t);if(e!==es&&ru(e,es)&&t.props.id){const r=new e(t.props);s[r.id]=r}}})),Object.keys(s).length>0&&(Array.isArray(r)?r.forEach((t=>{s[t.id]=t})):r&&(s[r.id]=r),r=Object.values(s)),{layers:e=o.length>0?[...o,...e]:e,children:i,views:r}}(t)),[t.layers,t.views,t.children]);let c=!0;const l=e=>c&&t.viewState?(r.viewStateUpdateRequested=e,null):(r.viewStateUpdateRequested=null,t.onViewStateChange(e)),h=e=>{c?r.interactionStateUpdateRequested=e:(r.interactionStateUpdateRequested=null,t.onInteractionStateChange(e))},f=(0,n.useMemo)((()=>{const e={...t,style:null,width:"100%",height:"100%",layers:u.layers,views:u.views,onViewStateChange:l,onInteractionStateChange:h};return r.deck&&r.deck.setProps(e),e}),[t]);(0,n.useEffect)((()=>(r.deck=function(t,e){const r=new(e.Deck||tu)({...e,style:null,width:"100%",height:"100%",_customRender:e=>{t.redrawReason=e;const n=r.viewManager.getViewports();t.lastRenderedViewports!==n?t.forceUpdate((t=>t+1)):il(t)}});return r}(r,{...f,parent:s.current,canvas:a.current}),()=>r.deck.finalize())),[]),eu((()=>{il(r);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:e}=r;t&&l(t),e&&h(e)})),(0,n.useImperativeHandle)(e,(()=>function(t){const e={pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)};return Object.defineProperty(e,"deck",{get:()=>t.deck}),e}(r)),[]);const{viewManager:d}=r.deck||{},p=d&&d.getViewports(),{ContextProvider:g,width:m,height:y,id:v,style:b}=t,{containerStyle:_,canvasStyle:w}=(0,n.useMemo)((()=>function({width:t,height:e,style:r}){const n={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(r)for(const o in r)o in nl?i[o]=r[o]:n[o]=r[o];return{containerStyle:n,canvasStyle:i}}({width:m,height:y,style:b})),[m,y,b]);if(!r.viewStateUpdateRequested&&r.lastRenderedViewports===p||r.version!==i){r.lastRenderedViewports=p,r.version=i;const t=function({children:t,deck:e,ContextProvider:r}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const o={},s=i.views[0].id;for(const n of t){let t=s,e=n;ru(n.type,es)&&(t=n.props.id||s,e=n.props.children);const r=i.getViewport(t),a=i.getViewState(t);if(r){const{x:n,y:i,width:s,height:u}=r;e=rl(e,{x:n,y:i,width:s,height:u,viewport:r,viewState:a}),o[t]||(o[t]={viewport:r,children:[]}),o[t].children.push(e)}}return Object.keys(o).map((t=>{const{viewport:i,children:s}=o[t],{x:a,y:u,width:c,height:l}=i,h={position:"absolute",left:a,top:u,width:c,height:l},f="view-".concat(t),d=(0,n.createElement)("div",{key:f,id:f,style:h},...s);if(r){const o={viewport:i,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:r=>{r.viewId=t,e._onViewStateChange(r)}};return(0,n.createElement)(r,{key:f,value:o},d)}return d}))}({children:u.children,deck:r.deck,ContextProvider:g}),e=(0,n.createElement)("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:a,style:w});r.control=(0,n.createElement)("div",{id:"".concat(v||"deckgl","-wrapper"),ref:s,style:_},[e,t])}return c=!1,r.control}));ol.propTypes=tu.getPropTypes(o()),ol.defaultProps=tu.defaultProps;var sl=ol},7514:function(t,e,r){"use strict";var n=r(3222);function i(){}function o(){}o.resetWarningCache=i,t.exports=function(){function t(t,e,r,i,o,s){if(s!==n){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},4720:function(t,e,r){t.exports=r(7514)()},3222:function(t){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7682:function(t,e,r){"use strict";r.d(e,{DW:function(){return V},eG:function(){return k},Lu:function(){return R},Xg:function(){return N},if:function(){return $},sj:function(){return L},zX:function(){return z},ro:function(){return T},up:function(){return X},Bf:function(){return A},wl:function(){return j},lf:function(){return C},w5:function(){return S},QA:function(){return G},CT:function(){return F},es:function(){return O},aW:function(){return D}});var n=1e-6,i="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});!function(){var t=function(){var t=new i(4);return i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();function o(t,e){const r=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,t}([],e,t);var n,i,o;return n=r,i=r,o=1/r[3],n[0]=i[0]*o,n[1]=i[1]*o,n[2]=i[2]*o,n[3]=i[3]*o,r}function s(t,e){const r=t%e;return r<0?e+r:r}const a=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function u(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],b=r[0],_=r[1],w=r[2],x=r[3];return t[0]=b*n+_*a+w*h+x*g,t[1]=b*i+_*u+w*f+x*m,t[2]=b*o+_*c+w*d+x*y,t[3]=b*s+_*l+w*p+x*v,b=r[4],_=r[5],w=r[6],x=r[7],t[4]=b*n+_*a+w*h+x*g,t[5]=b*i+_*u+w*f+x*m,t[6]=b*o+_*c+w*d+x*y,t[7]=b*s+_*l+w*p+x*v,b=r[8],_=r[9],w=r[10],x=r[11],t[8]=b*n+_*a+w*h+x*g,t[9]=b*i+_*u+w*f+x*m,t[10]=b*o+_*c+w*d+x*y,t[11]=b*s+_*l+w*p+x*v,b=r[12],_=r[13],w=r[14],x=r[15],t[12]=b*n+_*a+w*h+x*g,t[13]=b*i+_*u+w*f+x*m,t[14]=b*o+_*c+w*d+x*y,t[15]=b*s+_*l+w*p+x*v,t}function c(t,e,r){var n,i,o,s,a,u,c,l,h,f,d,p,g=r[0],m=r[1],y=r[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=n*g+a*m+h*y+e[12],t[13]=i*g+u*m+f*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=s*g+l*m+p*y+e[15]),t}function l(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function h(t,e){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=t[9],d=t[10],p=t[11],g=t[12],m=t[13],y=t[14],v=t[15],b=e[0],_=e[1],w=e[2],x=e[3],E=e[4],P=e[5],M=e[6],S=e[7],O=e[8],A=e[9],T=e[10],k=e[11],C=e[12],j=e[13],I=e[14],R=e[15];return Math.abs(r-b)<=n*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-_)<=n*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-w)<=n*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-x)<=n*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-E)<=n*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(u-P)<=n*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(c-M)<=n*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(l-S)<=n*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(h-O)<=n*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(f-A)<=n*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(d-T)<=n*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(p-k)<=n*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(g-C)<=n*Math.max(1,Math.abs(g),Math.abs(C))&&Math.abs(m-j)<=n*Math.max(1,Math.abs(m),Math.abs(j))&&Math.abs(y-I)<=n*Math.max(1,Math.abs(y),Math.abs(I))&&Math.abs(v-R)<=n*Math.max(1,Math.abs(v),Math.abs(R))}function f(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function d(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function p(t,e,r,n){var i=e[0],o=e[1];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t}var g=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t};!function(){var t=function(){var t=new i(2);return i!=Float32Array&&(t[0]=0,t[1]=0),t}()}();var m=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t};!function(){var t=function(){var t=new i(3);return i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}()}();function y(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const v=Math.PI,b=v/4,_=v/180,w=180/v,x=512,E=4003e4;function P(t){return Math.pow(2,t)}function M(t){return a(t)}function S([t,e]){y(Number.isFinite(t)),y(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const r=e*_;return[x*(t*_+v)/(2*v),x*(v+Math.log(Math.tan(b+.5*r)))/(2*v)]}function O([t,e]){const r=t/x*(2*v)-v,n=2*(Math.atan(Math.exp(e/x*(2*v)-v))-b);return[r*w,n*w]}function A({latitude:t}){y(Number.isFinite(t));const e=Math.cos(t*_);return M(E*e)-9}function T({latitude:t,longitude:e,highPrecision:r=!1}){y(Number.isFinite(t)&&Number.isFinite(e));const n={},i=Math.cos(t*_),o=512/360,s=o/i,a=12790407194604047e-21/i;if(n.unitsPerMeter=[a,a,a],n.metersPerUnit=[1/a,1/a,1/a],n.unitsPerDegree=[o,s,a],n.degreesPerUnit=[.703125,1/s,1/a],r){const e=_*Math.tan(t*_)/i,r=o*e/2,u=12790407194604047e-21*e,c=u/s*a;n.unitsPerDegree2=[0,r,u],n.unitsPerMeter2=[c,0,c]}return n}function k(t,e){const[r,n,i]=t,[o,s,a]=e,{unitsPerMeter:u,unitsPerMeter2:c}=T({longitude:r,latitude:n,highPrecision:!0}),l=S(t);l[0]+=o*(u[0]+c[0]*s),l[1]+=s*(u[1]+c[1]*s);const h=O(l),f=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],f]:h}function C({height:t,pitch:e,bearing:r,altitude:n,scale:i,center:o=null}){const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var a,u;return c(s,s,[0,0,-n]),function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],f=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*n,t[5]=s*i+l*n,t[6]=a*i+h*n,t[7]=u*i+f*n,t[8]=c*i-o*n,t[9]=l*i-s*n,t[10]=h*i-a*n,t[11]=f*i-u*n}(s,s,-e*_),function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],c=e[4],l=e[5],h=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*n,t[1]=s*i+l*n,t[2]=a*i+h*n,t[3]=u*i+f*n,t[4]=c*i-o*n,t[5]=l*i-s*n,t[6]=h*i-a*n,t[7]=f*i-u*n}(s,s,r*_),l(s,s,[i/=t,i,i]),o&&c(s,s,((a=[])[0]=-(u=o)[0],a[1]=-u[1],a[2]=-u[2],a)),s}function j({width:t,height:e,fovy:r=R(1.5),altitude:n,pitch:i=0,nearZMultiplier:o=1,farZMultiplier:s=1}){void 0!==n&&(r=R(n));const a=.5*r*_,u=L(r),c=i*_,l=Math.sin(a)*u/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:t/e,focalDistance:u,near:o,far:(Math.sin(c)*l+u)*s}}function I({width:t,height:e,pitch:r,altitude:n,fovy:i,nearZMultiplier:o,farZMultiplier:s}){const{fov:a,aspect:u,near:c,far:l}=j({width:t,height:e,altitude:n,fovy:i,pitch:r,nearZMultiplier:o,farZMultiplier:s});return function(t,e,r,n,i){var o,s=1/Math.tan(e/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(n-i),t[10]=(i+n)*o,t[14]=2*i*n*o):(t[10]=-1,t[14]=-2*n),t}([],a,u,c,l)}function R(t){return 2*Math.atan(.5/t)*w}function L(t){return.5/Math.tan(.5*t*_)}function D(t,e){const[r,n,i=0]=t;return y(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)),o(e,[r,n,i,1])}function F(t,e,r=0){const[n,i,s]=t;if(y(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s)){return o(e,[n,i,s,1])}const a=o(e,[n,i,0,1]),u=o(e,[n,i,1,1]),c=a[2],l=u[2];return p([],a,u,c===l?0:((r||0)-c)/(l-c))}function N({width:t,height:e,bounds:r,minExtent:n=0,maxZoom:i=24,padding:o=0,offset:s=[0,0]}){const[[u,c],[l,h]]=r;if(Number.isFinite(o)){o={top:o,bottom:o,left:o,right:o}}else y(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));const f=new V({width:t,height:e,longitude:0,latitude:0,zoom:0}),d=f.project([u,h]),p=f.project([l,c]),g=[Math.max(Math.abs(p[0]-d[0]),n),Math.max(Math.abs(p[1]-d[1]),n)],m=[t-o.left-o.right-2*Math.abs(s[0]),e-o.top-o.bottom-2*Math.abs(s[1])];y(m[0]>0&&m[1]>0);const v=m[0]/g[0],b=m[1]/g[1],_=(o.right-o.left)/2/v,w=(o.bottom-o.top)/2/b,x=[(p[0]+d[0])/2+_,(p[1]+d[1])/2+w],E=f.unproject(x),P=Math.min(i,f.zoom+a(Math.abs(Math.min(v,b))));return y(Number.isFinite(P)),{longitude:E[0],latitude:E[1],zoom:P}}const B=Math.PI/180;function z(t,e=0){const{width:r,height:n,unproject:i}=t,o={targetZ:e},s=i([0,n],o),a=i([r,n],o);let u,c;return(t.fovy?.5*t.fovy*B:Math.atan(.5/t.altitude))>(90-t.pitch)*B-.01?(u=U(t,0,e),c=U(t,r,e)):(u=i([0,0],o),c=i([r,0],o)),[s,a,c,u]}function U(t,e,r){const{pixelUnprojectionMatrix:n}=t,i=o(n,[e,0,1,1]),s=o(n,[e,t.height,1,1]),a=O(p([],i,s,(r*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2])));return a[2]=r,a}class V{constructor({width:t,height:e,latitude:r=0,longitude:n=0,zoom:i=0,pitch:o=0,bearing:s=0,altitude:a=null,fovy:u=null,position:c=null,nearZMultiplier:l=.02,farZMultiplier:h=1.01}={width:1,height:1}){t=t||1,e=e||1,null===u&&null===a?u=R(a=1.5):null===u?u=R(a):null===a&&(a=L(u));const f=P(i);a=Math.max(.75,a);const d=T({longitude:n,latitude:r}),p=S([n,r]);var g,y,v;p[2]=0,c&&(g=p,y=p,v=m([],c,d.unitsPerMeter),g[0]=y[0]+v[0],g[1]=y[1]+v[1],g[2]=y[2]+v[2]),this.projectionMatrix=I({width:t,height:e,pitch:o,fovy:u,nearZMultiplier:l,farZMultiplier:h}),this.viewMatrix=C({height:e,scale:f,center:p,pitch:o,bearing:s,altitude:a}),this.width=t,this.height=e,this.scale=f,this.latitude=r,this.longitude=n,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=a,this.fovy=u,this.center=p,this.meterOffset=c||[0,0,0],this.distanceScales=d,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:r,viewMatrix:n}=this,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];u(i,i,r),u(i,i,n),this.viewProjectionMatrix=i;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l(o,o,[t/2,-e/2,1]),c(o,o,[1,-1,0]),u(o,o,i);const s=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=r*a-n*s,b=r*u-i*s,_=r*c-o*s,w=n*u-i*a,x=n*c-o*a,E=i*c-o*u,P=l*g-h*p,M=l*m-f*p,S=l*y-d*p,O=h*m-f*g,A=h*y-d*g,T=f*y-d*m,k=v*T-b*A+_*O+w*S-x*M+E*P;return k?(k=1/k,t[0]=(a*T-u*A+c*O)*k,t[1]=(i*A-n*T-o*O)*k,t[2]=(g*E-m*x+y*w)*k,t[3]=(f*x-h*E-d*w)*k,t[4]=(u*S-s*T-c*M)*k,t[5]=(r*T-i*S+o*M)*k,t[6]=(m*_-p*E-y*b)*k,t[7]=(l*E-f*_+d*b)*k,t[8]=(s*A-a*S+c*P)*k,t[9]=(n*S-r*A-o*P)*k,t[10]=(p*x-g*_+y*v)*k,t[11]=(h*_-l*x-d*v)*k,t[12]=(a*M-s*O-u*P)*k,t[13]=(r*O-n*M+i*P)*k,t[14]=(g*b-p*w-m*v)*k,t[15]=(l*w-h*b+f*v)*k,t):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}equals(t){return t instanceof V&&(t.width===this.width&&t.height===this.height&&h(t.projectionMatrix,this.projectionMatrix)&&h(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const r=D(this.projectPosition(t),this.pixelProjectionMatrix),[n,i]=r,o=e?i:this.height-i;return 2===t.length?[n,o]:[n,o,r[2]]}unproject(t,{topLeft:e=!0,targetZ:r}={}){const[n,i,o]=t,s=e?i:this.height-i,a=r&&r*this.distanceScales.unitsPerMeter[2],u=F([n,s,o],this.pixelUnprojectionMatrix,a),[c,l,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,l,h]:Number.isFinite(r)?[c,l,r]:[c,l]}projectPosition(t){const[e,r]=S(t);return[e,r,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,r]=O(t);return[e,r,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return S(t)}unprojectFlat(t){return O(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const r=F(e,this.pixelUnprojectionMatrix),n=f([],S(t),((i=[])[0]=-(o=r)[0],i[1]=-o[1],i));var i,o;return O(f([],this.center,n))}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}fitBounds(t,e={}){const{width:r,height:n}=this,{longitude:i,latitude:o,zoom:s}=N(Object.assign({width:r,height:n,bounds:t},e));return new V({width:r,height:n,longitude:i,latitude:o,zoom:s})}getBounds(t){const e=this.getBoundingRegion(t),r=Math.min(...e.map((t=>t[0]))),n=Math.max(...e.map((t=>t[0])));return[[r,Math.min(...e.map((t=>t[1])))],[n,Math.max(...e.map((t=>t[1])))]]}getBoundingRegion(t={}){return z(this,t.z||0)}}function G({width:t,height:e,longitude:r,latitude:n,zoom:i,pitch:o=0,bearing:u=0}){(r<-180||r>180)&&(r=s(r+180,360)-180),(u<-180||u>180)&&(u=s(u+180,360)-180);const c=a(e/512);if(i<=c)i=c,n=0;else{const t=e/2/Math.pow(2,i),r=O([0,t])[1];if(n<r)n=r;else{const e=O([0,512-t])[1];n>e&&(n=e)}}return{width:t,height:e,longitude:r,latitude:n,zoom:i,pitch:o,bearing:u}}const W=["longitude","latitude","zoom"],Z={curve:1.414,speed:1.2};function $(t,e,r,n={}){const i={},{startZoom:o,startCenterXY:s,uDelta:a,w0:u,u1:c,S:l,rho:h,rho2:d,r0:p}=Y(t,e,n);if(c<.01){for(const n of W){const o=t[n],s=e[n];i[n]=(g=r)*s+(1-g)*o}return i}var g;const m=r*l,y=Math.cosh(p)/Math.cosh(p+h*m),v=u*((Math.cosh(p)*Math.tanh(p+h*m)-Math.sinh(p))/d)/c,b=o+M(1/y),_=(E=v,(w=[])[0]=(x=a)[0]*E,w[1]=x[1]*E,w);var w,x,E;f(_,_,s);const P=O(_);return i.longitude=P[0],i.latitude=P[1],i.zoom=b,i}function X(t,e,r={}){r=Object.assign({},Z,r);const{screenSpeed:n,speed:i,maxDuration:o}=r,{S:s,rho:a}=Y(t,e,r),u=1e3*s;let c;return c=Number.isFinite(n)?u/(n/a):u/i,Number.isFinite(o)&&c>o?0:c}function Y(t,e,r){const n=(r=Object.assign({},Z,r)).curve,i=t.zoom,o=[t.longitude,t.latitude],s=P(i),a=e.zoom,u=[e.longitude,e.latitude],c=P(a-i),l=S(o),h=S(u),f=g([],h,l),p=Math.max(t.width,t.height),m=p/c,y=d(f)*s,v=Math.max(y,.01),b=n*n,_=(m*m-p*p+b*b*v*v)/(2*p*b*v),w=(m*m-p*p-b*b*v*v)/(2*m*b*v),x=Math.log(Math.sqrt(_*_+1)-_),E=Math.log(Math.sqrt(w*w+1)-w);return{startZoom:i,startCenterXY:l,uDelta:f,w0:p,u1:y,S:(E-x)/n,rho:n,rho2:b,r0:x,r1:E}}},9705:function(t,e,r){"use strict";var n=r(1540);function i(t){var e=[1/0,1/0,-1/0,-1/0];return n.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}i.default=i,e.Z=i},4102:function(t,e){"use strict";function r(t,e,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function n(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return r({type:"Point",coordinates:t},e,n)}function i(t,e,n){void 0===n&&(n={});for(var i=0,o=t;i<o.length;i++){var s=o[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:t},e,n)}function o(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:t},e,n)}function s(t,e){void 0===e&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function a(t,e,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:t},e,n)}function u(t,e,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:t},e,n)}function c(t,e,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:t},e,n)}function l(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t*n}function h(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t/n}function f(t){return 180*(t%(2*Math.PI))/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=r,e.geometry=function(t,e,r){switch(void 0===r&&(r={}),t){case"Point":return n(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return i(e).geometry;case"MultiPoint":return u(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error(t+" is invalid")}},e.point=n,e.points=function(t,e,r){return void 0===r&&(r={}),s(t.map((function(t){return n(t,e)})),r)},e.polygon=i,e.polygons=function(t,e,r){return void 0===r&&(r={}),s(t.map((function(t){return i(t,e)})),r)},e.lineString=o,e.lineStrings=function(t,e,r){return void 0===r&&(r={}),s(t.map((function(t){return o(t,e)})),r)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=u,e.multiPolygon=c,e.geometryCollection=function(t,e,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:t},e,n)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,e||0);return Math.round(t*r)/r},e.radiansToLength=l,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return f(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=f,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,r){if(void 0===e&&(e="kilometers"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("length must be a positive number");return l(h(t,e),r)},e.convertArea=function(t,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=e.areaFactors[r];if(!i)throw new Error("invalid original units");var o=e.areaFactors[n];if(!o)throw new Error("invalid final units");return t/i*o},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},1540:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4102);function i(t,e,r){if(null!==t)for(var n,o,s,a,u,c,l,h,f=0,d=0,p=t.type,g="FeatureCollection"===p,m="Feature"===p,y=g?t.features.length:1,v=0;v<y;v++){u=(h=!!(l=g?t.features[v].geometry:m?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var b=0;b<u;b++){var _=0,w=0;if(null!==(a=h?l.geometries[b]:l)){c=a.coordinates;var x=a.type;switch(f=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(c,d,v,_,w))return!1;d++,_++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(!1===e(c[n],d,v,_,w))return!1;d++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(o=0;o<c[n].length-f;o++){if(!1===e(c[n][o],d,v,_,w))return!1;d++}"MultiLineString"===x&&_++,"Polygon"===x&&w++}"Polygon"===x&&_++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(w=0,o=0;o<c[n].length;o++){for(s=0;s<c[n][o].length-f;s++){if(!1===e(c[n][o][s],d,v,_,w))return!1;d++}w++}_++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===i(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var r;switch(t.type){case"FeatureCollection":for(r=0;r<t.features.length&&!1!==e(t.features[r].properties,r);r++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function a(t,e){var r,n,i,o,s,a,u,c,l,h,f=0,d="FeatureCollection"===t.type,p="Feature"===t.type,g=d?t.features.length:1;for(r=0;r<g;r++){for(a=d?t.features[r].geometry:p?t.geometry:t,c=d?t.features[r].properties:p?t.properties:{},l=d?t.features[r].bbox:p?t.bbox:void 0,h=d?t.features[r].id:p?t.id:void 0,s=(u=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=u?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,c,l,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],f,c,l,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,c,l,h))return!1;f++}}function u(t,e){a(t,(function(t,r,i,o,s){var a,u=null===t?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n.feature(t,i,{bbox:o,id:s}),r,0)&&void 0}switch(u){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<t.coordinates.length;c++){var l={type:a,coordinates:t.coordinates[c]};if(!1===e(n.feature(l,i),r,c))return!1}}))}function c(t,e){u(t,(function(t,r,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var u,c=0,l=0,h=0;return!1!==i(t,(function(i,a,f,d,p){if(void 0===u||r>c||d>l||p>h)return u=i,c=r,l=d,h=p,void(s=0);var g=n.lineString([u,i],t.properties);if(!1===e(g,r,o,p,s))return!1;s++,u=i}))&&void 0}}}))}function l(t,e){if(!t)throw new Error("geojson is required");u(t,(function(t,r,i){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,r,i,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(n.lineString(s[a],t.properties),r,i,a))return!1}}}))}e.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},e.coordEach=i,e.coordReduce=function(t,e,r,n){var o=r;return i(t,(function(t,n,i,s,a){o=0===n&&void 0===r?t:e(o,t,n,i,s,a)}),n),o},e.featureEach=s,e.featureReduce=function(t,e,r){var n=r;return s(t,(function(t,i){n=0===i&&void 0===r?t:e(n,t,i)})),n},e.findPoint=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),u=u||t.features[i].properties,r=t.features[i].geometry;break;case"Feature":u=u||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var c=r.coordinates;switch(r.type){case"Point":return n.point(c,u,e);case"MultiPoint":return o<0&&(o=c.length+o),n.point(c[o],u,e);case"LineString":return a<0&&(a=c.length+a),n.point(c[a],u,e);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a),n.point(c[s][a],u,e);case"MultiLineString":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),n.point(c[o][a],u,e);case"MultiPolygon":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s),a<0&&(a=c[o][s].length-a),n.point(c[o][s][a],u,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var r,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),u=u||t.features[i].properties,r=t.features[i].geometry;break;case"Feature":u=u||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var c=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=c.length+a-1),n.lineString([c[a],c[a+1]],u,e);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a-1),n.lineString([c[s][a],c[s][a+1]],u,e);case"MultiLineString":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a-1),n.lineString([c[o][a],c[o][a+1]],u,e);case"MultiPolygon":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s),a<0&&(a=c[o][s].length-a-1),n.lineString([c[o][s][a],c[o][s][a+1]],u,e)}throw new Error("geojson is invalid")},e.flattenEach=u,e.flattenReduce=function(t,e,r){var n=r;return u(t,(function(t,i,o){n=0===i&&0===o&&void 0===r?t:e(n,t,i,o)})),n},e.geomEach=a,e.geomReduce=function(t,e,r){var n=r;return a(t,(function(t,i,o,s,a){n=0===i&&void 0===r?t:e(n,t,i,o,s,a)})),n},e.lineEach=l,e.lineReduce=function(t,e,r){var n=r;return l(t,(function(t,i,o,s){n=0===i&&void 0===r?t:e(n,t,i,o,s)})),n},e.propEach=o,e.propReduce=function(t,e,r){var n=r;return o(t,(function(t,i){n=0===i&&void 0===r?t:e(n,t,i)})),n},e.segmentEach=c,e.segmentReduce=function(t,e,r){var n=r,i=!1;return c(t,(function(t,o,s,a,u){n=!1===i&&void 0===r?t:e(n,t,o,s,a,u),i=!0})),n}},1924:function(t,e,r){"use strict";var n=r(210),i=r(5559),o=i(n("String.prototype.indexOf"));t.exports=function(t,e){var r=n(t,!!e);return"function"===typeof r&&o(t,".prototype.")>-1?i(r):r}},5559:function(t,e,r){"use strict";var n=r(8612),i=r(210),o=i("%Function.prototype.apply%"),s=i("%Function.prototype.call%"),a=i("%Reflect.apply%",!0)||n.call(s,o),u=i("%Object.getOwnPropertyDescriptor%",!0),c=i("%Object.defineProperty%",!0),l=i("%Math.max%");if(c)try{c({},"a",{value:1})}catch(f){c=null}t.exports=function(t){var e=a(n,s,arguments);if(u&&c){var r=u(e,"length");r.configurable&&c(e,"length",{value:1+l(0,t.length-(arguments.length-1))})}return e};var h=function(){return a(n,o,arguments)};c?c(t.exports,"apply",{value:h}):t.exports.apply=h},2273:function(t,e,r){"use strict";var n=r(1662),i=r(3842),o=r(6960),s=r(8639).orient2d;function a(t,e,r){e=Math.max(0,void 0===e?2:e),r=r||0;var i=function(t){for(var e=t[0],r=t[0],n=t[0],i=t[0],s=0;s<t.length;s++){var a=t[s];a[0]<e[0]&&(e=a),a[0]>n[0]&&(n=a),a[1]<r[1]&&(r=a),a[1]>i[1]&&(i=a)}var u=[e,r,n,i],c=u.slice();for(s=0;s<t.length;s++)o(t[s],u)||c.push(t[s]);return function(t){t.sort(b);for(var e=[],r=0;r<t.length;r++){for(;e.length>=2&&d(e[e.length-2],e[e.length-1],t[r])<=0;)e.pop();e.push(t[r])}for(var n=[],i=t.length-1;i>=0;i--){for(;n.length>=2&&d(n[n.length-2],n[n.length-1],t[i])<=0;)n.pop();n.push(t[i])}return n.pop(),e.pop(),e.concat(n)}(c)}(t),s=new n(16);s.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},s.compareMinX=function(t,e){return t[0]-e[0]},s.compareMinY=function(t,e){return t[1]-e[1]},s.load(t);for(var a,c=[],l=0;l<i.length;l++){var h=i[l];s.remove(h),a=g(h,a),c.push(a)}var f=new n(16);for(l=0;l<c.length;l++)f.insert(p(c[l]));for(var y=e*e,v=r*r;c.length;){var _=c.shift(),w=_.p,x=_.next.p,E=m(w,x);if(!(E<v)){var P=E/y;(h=u(s,_.prev.p,w,x,_.next.next.p,P,f))&&Math.min(m(h,w),m(h,x))<=P&&(c.push(_),c.push(g(h,_)),s.remove(h),f.remove(_),f.insert(p(_)),f.insert(p(_.next)))}}_=a;var M=[];do{M.push(_.p),_=_.next}while(_!==a);return M.push(_.p),M}function u(t,e,r,n,o,s,a){for(var u=new i([],c),h=t.data;h;){for(var d=0;d<h.children.length;d++){var p=h.children[d],g=h.leaf?y(p,r,n):l(r,n,p);g>s||u.push({node:p,dist:g})}for(;u.length&&!u.peek().node.children;){var m=u.pop(),v=m.node,b=y(v,e,r),_=y(v,n,o);if(m.dist<b&&m.dist<_&&f(r,v,a)&&f(n,v,a))return v}(h=u.pop())&&(h=h.node)}return null}function c(t,e){return t.dist-e.dist}function l(t,e,r){if(h(t,r)||h(e,r))return 0;var n=v(t[0],t[1],e[0],e[1],r.minX,r.minY,r.maxX,r.minY);if(0===n)return 0;var i=v(t[0],t[1],e[0],e[1],r.minX,r.minY,r.minX,r.maxY);if(0===i)return 0;var o=v(t[0],t[1],e[0],e[1],r.maxX,r.minY,r.maxX,r.maxY);if(0===o)return 0;var s=v(t[0],t[1],e[0],e[1],r.minX,r.maxY,r.maxX,r.maxY);return 0===s?0:Math.min(n,i,o,s)}function h(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function f(t,e,r){for(var n,i,o,s,a=Math.min(t[0],e[0]),u=Math.min(t[1],e[1]),c=Math.max(t[0],e[0]),l=Math.max(t[1],e[1]),h=r.search({minX:a,minY:u,maxX:c,maxY:l}),f=0;f<h.length;f++)if(n=h[f].p,i=h[f].next.p,o=t,n!==(s=e)&&i!==o&&d(n,i,o)>0!==d(n,i,s)>0&&d(o,s,n)>0!==d(o,s,i)>0)return!1;return!0}function d(t,e,r){return s(t[0],t[1],e[0],e[1],r[0],r[1])}function p(t){var e=t.p,r=t.next.p;return t.minX=Math.min(e[0],r[0]),t.minY=Math.min(e[1],r[1]),t.maxX=Math.max(e[0],r[0]),t.maxY=Math.max(e[1],r[1]),t}function g(t,e){var r={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(r.next=e.next,r.prev=e,e.next.prev=r,e.next=r):(r.prev=r,r.next=r),r}function m(t,e){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function y(t,e,r){var n=e[0],i=e[1],o=r[0]-n,s=r[1]-i;if(0!==o||0!==s){var a=((t[0]-n)*o+(t[1]-i)*s)/(o*o+s*s);a>1?(n=r[0],i=r[1]):a>0&&(n+=o*a,i+=s*a)}return(o=t[0]-n)*o+(s=t[1]-i)*s}function v(t,e,r,n,i,o,s,a){var u,c,l,h,f=r-t,d=n-e,p=s-i,g=a-o,m=t-i,y=e-o,v=f*f+d*d,b=f*p+d*g,_=p*p+g*g,w=f*m+d*y,x=p*m+g*y,E=v*_-b*b,P=E,M=E;0===E?(c=0,P=1,h=x,M=_):(h=v*x-b*w,(c=b*x-_*w)<0?(c=0,h=x,M=_):c>P&&(c=P,h=x+b,M=_)),h<0?(h=0,-w<0?c=0:-w>v?c=P:(c=-w,P=v)):h>M&&(h=M,-w+b<0?c=0:-w+b>v?c=P:(c=-w+b,P=v));var S=(1-(l=0===h?0:h/M))*i+l*s-((1-(u=0===c?0:c/P))*t+u*r),O=(1-l)*o+l*a-((1-u)*e+u*n);return S*S+O*O}function b(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}i.default&&(i=i.default),t.exports=a,t.exports.default=a},1662:function(t){t.exports=function(){"use strict";function t(t,n,i,o,s){!function t(r,n,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,u=n-i+1,c=Math.log(a),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(a-l)/a)*(u-a/2<0?-1:1);t(r,n,Math.max(i,Math.floor(n-u*l/a+h)),Math.min(o,Math.floor(n+(a-u)*l/a+h)),s)}var f=r[n],d=i,p=o;for(e(r,i,n),s(r[o],f)>0&&e(r,i,o);d<p;){for(e(r,d,p),d++,p--;s(r[d],f)<0;)d++;for(;s(r[p],f)>0;)p--}0===s(r[i],f)?e(r,i,p):e(r,++p,o),p<=n&&(i=p+1),n<=p&&(o=p-1)}}(t,n,i||0,o||t.length-1,s||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,r,n,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var s=t.children[o];a(i,t.leaf?n(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,r,n,i,o){for(var s=[r,n];s.length;)if(!((n=s.pop())-(r=s.pop())<=i)){var a=r+Math.ceil((n-r)/i/2)*i;t(e,a,r,n,o),s.push(r,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!d(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;d(t,a)&&(e.leaf?r.push(s):f(t,a)?this._all(s,r):i.push(s))}e=i.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],o=e.leaf?this.toBBox(i):i;if(d(t,o)){if(e.leaf||f(t,o))return!0;r.push(i)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=p([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,o,s=this.data,a=this.toBBox(t),u=[],c=[];s||u.length;){if(s||(s=u.pop(),n=u[u.length-1],r=c.pop(),o=!0),s.leaf){var l=i(t,s.children,e);if(-1!==l)return s.children.splice(l,1),u.push(s),this._condense(u),this}o||s.leaf||!f(s,a)?n?(r++,s=n.children[r],o=!1):s=null:(u.push(s),c.push(r),r=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var i,s=r-e+1,a=this._maxEntries;if(s<=a)return o(i=p(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(i=p([])).leaf=!1,i.height=n;var u=Math.ceil(s/a),c=u*Math.ceil(Math.sqrt(a));g(t,e,r,c,this.compareMinX);for(var l=e;l<=r;l+=c){var h=Math.min(l+c-1,r);g(t,l,h,u,this.compareMinY);for(var f=l;f<=h;f+=u){var d=Math.min(f+u-1,h);i.children.push(this._build(t,f,d,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var u=e.children[a],c=l(u),h=(f=t,d=u,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-c);h<o?(o=h,i=c<i?c:i,s=u):h===o&&c<i&&(i=c,s=u)}e=s||e.children[0]}var f,d;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),a(o,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var s=this._chooseSplitIndex(r,i,n),a=p(r.children.splice(s,r.children.length-s));a.height=r.height,a.leaf=r.leaf,o(r,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},n.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,i,o,a,u,c,h,f=1/0,d=1/0,p=e;p<=r-e;p++){var g=s(t,0,p,this.toBBox),m=s(t,p,r,this.toBBox),y=(i=g,o=m,a=void 0,u=void 0,c=void 0,h=void 0,a=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),c=Math.min(i.maxX,o.maxX),h=Math.min(i.maxY,o.maxY),Math.max(0,c-a)*Math.max(0,h-u)),v=l(g)+l(m);y<f?(f=y,n=p,d=v<d?v:d):y===f&&v<d&&(d=v,n=p)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=s(t,0,e,i),u=s(t,r-e,r,i),c=h(o)+h(u),l=e;l<r-e;l++){var f=t.children[l];a(o,t.leaf?i(f):f),c+=h(o)}for(var d=r-e-1;d>=e;d--){var p=t.children[d];a(u,t.leaf?i(p):p),c+=h(u)}return c},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}()},251:function(t,e,r){var n=r(2215),i=r(2584),o=r(609),s=r(8420),a=r(2847),u=r(8923),c=Date.prototype.getTime;function l(t,e,r){var d=r||{};return!!(d.strict?o(t,e):t===e)||(!t||!e||"object"!==typeof t&&"object"!==typeof e?d.strict?o(t,e):t==e:function(t,e,r){var o,d;if(typeof t!==typeof e)return!1;if(h(t)||h(e))return!1;if(t.prototype!==e.prototype)return!1;if(i(t)!==i(e))return!1;var p=s(t),g=s(e);if(p!==g)return!1;if(p||g)return t.source===e.source&&a(t)===a(e);if(u(t)&&u(e))return c.call(t)===c.call(e);var m=f(t),y=f(e);if(m!==y)return!1;if(m||y){if(t.length!==e.length)return!1;for(o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}if(typeof t!==typeof e)return!1;try{var v=n(t),b=n(e)}catch(_){return!1}if(v.length!==b.length)return!1;for(v.sort(),b.sort(),o=v.length-1;o>=0;o--)if(v[o]!=b[o])return!1;for(o=v.length-1;o>=0;o--)if(!l(t[d=v[o]],e[d],r))return!1;return!0}(t,e,d))}function h(t){return null===t||void 0===t}function f(t){return!(!t||"object"!==typeof t||"number"!==typeof t.length)&&("function"===typeof t.copy&&"function"===typeof t.slice&&!(t.length>0&&"number"!==typeof t[0]))}t.exports=l},4289:function(t,e,r){"use strict";var n=r(2215),i="function"===typeof Symbol&&"symbol"===typeof Symbol("foo"),o=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,u=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(r){return!1}}(),c=function(t,e,r,n){var i;(!(e in t)||"function"===typeof(i=n)&&"[object Function]"===o.call(i)&&n())&&(u?a(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r)},l=function(t,e){var r=arguments.length>2?arguments[2]:{},o=n(e);i&&(o=s.call(o,Object.getOwnPropertySymbols(e)));for(var a=0;a<o.length;a+=1)c(t,o[a],e[o[a]],r[o[a]])};l.supportsDescriptors=!!u,t.exports=l},8317:function(t){function e(t,e,r,n){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,r,n)}e.prototype.run=function(t,e,r,n){this._init(t,e,r,n);for(var i=0;i<this._datasetLength;i++)if(1!==this._visited[i]){this._visited[i]=1;var o=this._regionQuery(i);if(o.length<this.minPts)this.noise.push(i);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(i,s),this._expandCluster(s,o)}}return this.clusters},e.prototype._init=function(t,e,r,n){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),r&&(this.minPts=r),n&&(this.distance=n)},e.prototype._expandCluster=function(t,e){for(var r=0;r<e.length;r++){var n=e[r];if(1!==this._visited[n]){this._visited[n]=1;var i=this._regionQuery(n);i.length>=this.minPts&&(e=this._mergeArrays(e,i))}1!==this._assigned[n]&&this._addToCluster(n,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],r=0;r<this._datasetLength;r++){this.distance(this.dataset[t],this.dataset[r])<this.epsilon&&e.push(r)}return e},e.prototype._mergeArrays=function(t,e){for(var r=e.length,n=0;n<r;n++){var i=e[n];t.indexOf(i)<0&&t.push(i)}return t},e.prototype._euclideanDistance=function(t,e){for(var r=0,n=Math.min(t.length,e.length);n--;)r+=(t[n]-e[n])*(t[n]-e[n]);return Math.sqrt(r)},t.exports&&(t.exports=e)},3781:function(t){function e(t,e,r){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,r)}e.prototype.init=function(t,e,r){this.assignments=[],this.centroids=[],"undefined"!==typeof t&&(this.dataset=t),"undefined"!==typeof e&&(this.k=e),"undefined"!==typeof r&&(this.distance=r)},e.prototype.run=function(t,e){this.init(t,e);for(var r=this.dataset.length,n=0;n<this.k;n++)this.centroids[n]=this.randomCentroid();for(var i=!0;i;){i=this.assign();for(var o=0;o<this.k;o++){for(var s=new Array(l),a=0,u=0;u<l;u++)s[u]=0;for(var c=0;c<r;c++){var l=this.dataset[c].length;if(o===this.assignments[c]){for(u=0;u<l;u++)s[u]+=this.dataset[c][u];a++}}if(a>0){for(u=0;u<l;u++)s[u]/=a;this.centroids[o]=s}else this.centroids[o]=this.randomCentroid(),i=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,r=this.dataset.length-1;do{e=Math.round(Math.random()*r),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,r=this.dataset.length,n=0;n<r;n++)(t=this.argmin(this.dataset[n],this.centroids,this.distance))!=this.assignments[n]&&(this.assignments[n]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),r=0;r<this.assignments.length;r++)"undefined"===typeof e[t=this.assignments[r]]&&(e[t]=[]),e[t].push(r);return e},e.prototype.argmin=function(t,e,r){for(var n,i=Number.MAX_VALUE,o=0,s=e.length,a=0;a<s;a++)(n=r(t,e[a]))<i&&(i=n,o=a);return o},e.prototype.distance=function(t,e){for(var r=0,n=Math.min(t.length,e.length);n--;){var i=t[n]-e[n];r+=i*i}return Math.sqrt(r)},t.exports&&(t.exports=e)},3763:function(t,e,r){if(t.exports)var n=r(7985);function i(t,e,r,n){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,r,n)}i.prototype.run=function(t,e,r,i){this._init(t,e,r,i);for(var o=0,s=this.dataset.length;o<s;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var a=this.clusters.length-1;this._orderedList.push(o);var u=new n(null,null,"asc"),c=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,c,u),this._expandCluster(a,u))}return this.clusters},i.prototype.getReachabilityPlot=function(){for(var t=[],e=0,r=this._orderedList.length;e<r;e++){var n=this._orderedList[e],i=this._reachability[n];t.push([n,i])}return t},i.prototype._init=function(t,e,r,n){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),r&&(this.minPts=r),n&&(this.distance=n)},i.prototype._updateQueue=function(t,e,r){var n=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===n._processed[e]){var i=n.distance(n.dataset[t],n.dataset[e]),o=Math.max(n._coreDistance,i);void 0===n._reachability[e]?(n._reachability[e]=o,r.insert(e,o)):o<n._reachability[e]&&(n._reachability[e]=o,r.remove(e),r.insert(e,o))}}))},i.prototype._expandCluster=function(t,e){for(var r=e.getElements(),n=0,i=r.length;n<i;n++){var o=r[n];if(void 0===this._processed[o]){var s=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,s,e),this._expandCluster(t,e))}}},i.prototype._distanceToCore=function(t){for(var e=this.epsilon,r=0;r<e;r++){if(this._regionQuery(t,r).length>=this.minPts)return r}},i.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var r=[],n=0,i=this.dataset.length;n<i;n++)this.distance(this.dataset[t],this.dataset[n])<e&&r.push(n);return r},i.prototype._euclideanDistance=function(t,e){for(var r=0,n=Math.min(t.length,e.length);n--;)r+=(t[n]-e[n])*(t[n]-e[n]);return Math.sqrt(r)},t.exports&&(t.exports=i)},7985:function(t){function e(t,e,r){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,r)}e.prototype.insert=function(t,e){for(var r=this._queue.length,n=r;n--;){var i=this._priorities[n];"desc"===this._sorting?e>i&&(r=n):e<i&&(r=n)}this._insertAt(t,e,r)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;){if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,r=this._queue.length;e<r;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,r){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var n=0;n<t.length;n++)this.insert(t[n],e[n])}r&&(this._sorting=r)},e.prototype._insertAt=function(t,e,r){this._queue.length===r?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(r,0,t),this._priorities.splice(r,0,e))},t.exports&&(t.exports=e)},2606:function(t,e,r){t.exports&&(t.exports={DBSCAN:r(8317),KMEANS:r(3781),OPTICS:r(3763),PriorityQueue:r(7985)})},9187:function(t){"use strict";function e(t,e,o){o=o||2;var s,a,u,h,f,p,g,m=e&&e.length,y=m?e[0]*o:t.length,v=r(t,0,y,o,!0),b=[];if(!v||v.next===v.prev)return b;if(m&&(v=function(t,e,i,o){var s,a,u,h=[];for(s=0,a=e.length;s<a;s++)(u=r(t,e[s]*o,s<a-1?e[s+1]*o:t.length,o,!1))===u.next&&(u.steiner=!0),h.push(d(u));for(h.sort(c),s=0;s<h.length;s++)i=n(i=l(h[s],i),i.next);return i}(t,e,v,o)),t.length>80*o){s=u=t[0],a=h=t[1];for(var _=o;_<y;_+=o)(f=t[_])<s&&(s=f),(p=t[_+1])<a&&(a=p),f>u&&(u=f),p>h&&(h=p);g=0!==(g=Math.max(u-s,h-a))?1/g:0}return i(v,b,o,s,a,g),b}function r(t,e,r,n,i){var o,s;if(i===S(t,e,r,n)>0)for(o=e;o<r;o+=n)s=E(o,t[o],t[o+1],s);else for(o=r-n;o>=e;o-=n)s=E(o,t[o],t[o+1],s);return s&&y(s,s.next)&&(P(s),s=s.next),s}function n(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!y(n,n.next)&&0!==m(n.prev,n,n.next))n=n.next;else{if(P(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function i(t,e,r,c,l,h,d){if(t){!d&&h&&function(t,e,r,n){var i=t;do{null===i.z&&(i.z=f(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,s,a,u,c=1;do{for(r=t,t=null,o=null,s=0;r;){for(s++,n=r,a=0,e=0;e<c&&(a++,n=n.nextZ);e++);for(u=c;a>0||u>0&&n;)0!==a&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,c*=2}while(s>1)}(i)}(t,c,l,h);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,h?s(t,c,l,h):o(t))e.push(p.i/r),e.push(t.i/r),e.push(g.i/r),P(t),t=g.next,m=g.next;else if((t=g)===m){d?1===d?i(t=a(n(t),e,r),e,r,c,l,h,2):2===d&&u(t,e,r,c,l,h):i(n(t),e,r,c,l,h,1);break}}}function o(t){var e=t.prev,r=t,n=t.next;if(m(e,r,n)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(p(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(t,e,r,n){var i=t.prev,o=t,s=t.next;if(m(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=f(a,u,e,r,n),d=f(c,l,e,r,n),g=t.prevZ,y=t.nextZ;g&&g.z>=h&&y&&y.z<=d;){if(g!==t.prev&&g!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,y!==t.prev&&y!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;g&&g.z>=h;){if(g!==t.prev&&g!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;y&&y.z<=d;){if(y!==t.prev&&y!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function a(t,e,r){var i=t;do{var o=i.prev,s=i.next.next;!y(o,s)&&v(o,i,i.next,s)&&w(o,s)&&w(s,o)&&(e.push(o.i/r),e.push(i.i/r),e.push(s.i/r),P(i),P(i.next),i=t=s),i=i.next}while(i!==t);return n(i)}function u(t,e,r,o,s,a){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&g(u,c)){var l=x(u,c);return u=n(u,u.next),l=n(l,l.next),i(u,e,r,o,s,a),void i(l,e,r,o,s,a)}c=c.next}u=u.next}while(u!==t)}function c(t,e){return t.x-e.x}function l(t,e){var r=function(t,e){var r,n=e,i=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s){if(s=a,a===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===s)return r;var u,c=r,l=r.x,f=r.y,d=1/0;n=r;do{i>=n.x&&n.x>=l&&i!==n.x&&p(o<f?i:s,o,l,f,o<f?s:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),w(n,t)&&(u<d||u===d&&(n.x>r.x||n.x===r.x&&h(r,n)))&&(r=n,d=u)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var i=x(r,t),o=n(r,r.next);return n(i,i.next),e===r?o:e}function h(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function f(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function p(t,e,r,n,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(n-a)-(r-s)*(e-a)>=0&&(r-s)*(o-a)-(i-s)*(n-a)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&v(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!==r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||y(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,r,n){var i=_(m(t,e,r)),o=_(m(t,e,n)),s=_(m(r,n,t)),a=_(m(r,n,e));return i!==o&&s!==a||(!(0!==i||!b(t,r,e))||(!(0!==o||!b(t,n,e))||(!(0!==s||!b(r,t,n))||!(0!==a||!b(r,e,n)))))}function b(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function _(t){return t>0?1:t<0?-1:0}function w(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function x(t,e){var r=new M(t.i,t.x,t.y),n=new M(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function E(t,e,r,n){var i=new M(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function P(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function M(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S(t,e,r,n){for(var i=0,o=e,s=r-n;o<r;o+=n)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,s=Math.abs(S(t,0,o,r));if(i)for(var a=0,u=e.length;a<u;a++){var c=e[a]*r,l=a<u-1?e[a+1]*r:t.length;s-=Math.abs(S(t,c,l,r))}var h=0;for(a=0;a<n.length;a+=3){var f=n[a]*r,d=n[a+1]*r,p=n[a+2]*r;h+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[i][o][s]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r}},7648:function(t){"use strict";var e="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,i="[object Function]";t.exports=function(t){var o=this;if("function"!==typeof o||n.call(o)!==i)throw new TypeError(e+o);for(var s,a=r.call(arguments,1),u=function(){if(this instanceof s){var e=o.apply(this,a.concat(r.call(arguments)));return Object(e)===e?e:this}return o.apply(t,a.concat(r.call(arguments)))},c=Math.max(0,o.length-a.length),l=[],h=0;h<c;h++)l.push("$"+h);if(s=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(u),o.prototype){var f=function(){};f.prototype=o.prototype,s.prototype=new f,f.prototype=null}return s}},8612:function(t,e,r){"use strict";var n=r(7648);t.exports=Function.prototype.bind||n},9657:function(t,e,r){var n=r(251),i=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:a};function o(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function s(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function a(t,e){return n(t,e,{strict:!0})}i.prototype.compare=function(t,e){if(t.type!==e.type||!s(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var r=this,n=o(t),i=o(e);return n.every((function(t){return this.some((function(e){return r.compare(t,e)}))}),i)}}return!1},i.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r].toFixed(this.precision)!==e[r].toFixed(this.precision))return!1;return!0},i.prototype.compareLine=function(t,e,r,n){if(!s(t,e))return!1;var i=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!n||this.compareCoord(i[0],o[0])||(o=this.fixStartIndex(o,i))){var a=this.compareCoord(i[r],o[r]);return this.direction||a?this.comparePath(i,o):!!this.compareCoord(i[r],o[o.length-(1+r)])&&this.comparePath(i.slice().reverse(),o)}},i.prototype.fixStartIndex=function(t,e){for(var r,n=-1,i=0;i<t.length;i++)if(this.compareCoord(t[i],e[0])){n=i;break}return n>=0&&(r=[].concat(t.slice(n,t.length),t.slice(1,n+1))),r},i.prototype.comparePath=function(t,e){var r=this;return t.every((function(t,e){return r.compareCoord(t,this[e])}),e)},i.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var r=t.coordinates.slice(1,t.coordinates.length),n=e.coordinates.slice(1,e.coordinates.length),i=this;return r.every((function(t){return this.some((function(e){return i.compareLine(t,e,1,!0)}))}),n)}return!1},i.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},i.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},i.prototype.removePseudo=function(t){return t},t.exports=i},1787:function(t,e,r){var n=r(4056),i=r(4102),o=r(1540),s=r(9705).Z,a=o.featureEach,u=(o.coordEach,i.polygon,i.featureCollection);function c(t){var e=new n(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),n.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),n.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),n.prototype.remove.call(this,t,e)},e.clear=function(){return n.prototype.clear.call(this)},e.search=function(t){var e=n.prototype.search.call(this,this.toBBox(t));return u(e)},e.collides=function(t){return n.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=n.prototype.all.call(this);return u(t)},e.toJSON=function(){return n.prototype.toJSON.call(this)},e.fromJSON=function(t){return n.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=c,t.exports.default=c},4056:function(t){t.exports=function(){"use strict";function t(t,n,i,o,s){!function t(r,n,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,u=n-i+1,c=Math.log(a),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(a-l)/a)*(u-a/2<0?-1:1);t(r,n,Math.max(i,Math.floor(n-u*l/a+h)),Math.min(o,Math.floor(n+(a-u)*l/a+h)),s)}var f=r[n],d=i,p=o;for(e(r,i,n),s(r[o],f)>0&&e(r,i,o);d<p;){for(e(r,d,p),d++,p--;s(r[d],f)<0;)d++;for(;s(r[p],f)>0;)p--}0===s(r[i],f)?e(r,i,p):e(r,++p,o),p<=n&&(i=p+1),n<=p&&(o=p-1)}}(t,n,i||0,o||t.length-1,s||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,r,n,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var s=t.children[o];a(i,t.leaf?n(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,r,n,i,o){for(var s=[r,n];s.length;)if(!((n=s.pop())-(r=s.pop())<=i)){var a=r+Math.ceil((n-r)/i/2)*i;t(e,a,r,n,o),s.push(r,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!d(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;d(t,a)&&(e.leaf?r.push(s):f(t,a)?this._all(s,r):i.push(s))}e=i.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],o=e.leaf?this.toBBox(i):i;if(d(t,o)){if(e.leaf||f(t,o))return!0;r.push(i)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=p([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,o,s=this.data,a=this.toBBox(t),u=[],c=[];s||u.length;){if(s||(s=u.pop(),n=u[u.length-1],r=c.pop(),o=!0),s.leaf){var l=i(t,s.children,e);if(-1!==l)return s.children.splice(l,1),u.push(s),this._condense(u),this}o||s.leaf||!f(s,a)?n?(r++,s=n.children[r],o=!1):s=null:(u.push(s),c.push(r),r=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var i,s=r-e+1,a=this._maxEntries;if(s<=a)return o(i=p(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(i=p([])).leaf=!1,i.height=n;var u=Math.ceil(s/a),c=u*Math.ceil(Math.sqrt(a));g(t,e,r,c,this.compareMinX);for(var l=e;l<=r;l+=c){var h=Math.min(l+c-1,r);g(t,l,h,u,this.compareMinY);for(var f=l;f<=h;f+=u){var d=Math.min(f+u-1,h);i.children.push(this._build(t,f,d,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var u=e.children[a],c=l(u),h=(f=t,d=u,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-c);h<o?(o=h,i=c<i?c:i,s=u):h===o&&c<i&&(i=c,s=u)}e=s||e.children[0]}var f,d;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),a(o,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var s=this._chooseSplitIndex(r,i,n),a=p(r.children.splice(s,r.children.length-s));a.height=r.height,a.leaf=r.leaf,o(r,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},n.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,i,o,a,u,c,h,f=1/0,d=1/0,p=e;p<=r-e;p++){var g=s(t,0,p,this.toBBox),m=s(t,p,r,this.toBBox),y=(i=g,o=m,a=void 0,u=void 0,c=void 0,h=void 0,a=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),c=Math.min(i.maxX,o.maxX),h=Math.min(i.maxY,o.maxY),Math.max(0,c-a)*Math.max(0,h-u)),v=l(g)+l(m);y<f?(f=y,n=p,d=v<d?v:d):y===f&&v<d&&(d=v,n=p)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=s(t,0,e,i),u=s(t,r-e,r,i),c=h(o)+h(u),l=e;l<r-e;l++){var f=t.children[l];a(o,t.leaf?i(f):f),c+=h(o)}for(var d=r-e-1;d>=e;d--){var p=t.children[d];a(u,t.leaf?i(p):p),c+=h(u)}return c},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}()},4868:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=u(r(420)),i=u(r(6594)),o=u(r(451)),s=u(r(7672)),a=r(4057);function u(t){return t&&t.__esModule?t:{default:t}}var c=function(t,e,r){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6371e3,c=(0,n.default)(t),l=(0,i.default)(t),h=e/u,f=(0,o.default)(r),d=(0,o.default)(c),p=(0,o.default)(l),g=Math.asin(Math.sin(d)*Math.cos(h)+Math.cos(d)*Math.sin(h)*Math.cos(f)),m=p+Math.atan2(Math.sin(f)*Math.sin(h)*Math.cos(d),Math.cos(h)-Math.sin(d)*Math.sin(g)),y=(0,s.default)(m);return(y<a.MINLON||y>a.MAXLON)&&(m=(m+3*Math.PI)%(2*Math.PI)-Math.PI,y=(0,s.default)(m)),{latitude:(0,s.default)(g),longitude:y}};e.default=c},4057:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.areaConversion=e.timeConversion=e.distanceConversion=e.altitudeKeys=e.latitudeKeys=e.longitudeKeys=e.MAXLON=e.MINLON=e.MAXLAT=e.MINLAT=e.earthRadius=e.sexagesimalPattern=void 0;e.sexagesimalPattern=/^([0-9]{1,3})\xb0\s*([0-9]{1,3}(?:\.(?:[0-9]{1,}))?)['\u2032]\s*(([0-9]{1,3}(\.([0-9]{1,}))?)["\u2033]\s*)?([NEOSW]?)$/;e.earthRadius=6378137;e.MINLAT=-90;e.MAXLAT=90;e.MINLON=-180;e.MAXLON=180;e.longitudeKeys=["lng","lon","longitude",0];e.latitudeKeys=["lat","latitude",1];e.altitudeKeys=["alt","altitude","elevation","elev",2];e.distanceConversion={m:1,km:.001,cm:100,mm:1e3,mi:1/1609.344,sm:1/1852.216,ft:100/30.48,in:100/2.54,yd:1/.9144};e.timeConversion={m:60,h:3600,d:86400};var r={m2:1,km2:1e-6,ha:1e-4,a:.01,ft2:10.763911,yd2:1.19599,in2:1550.0031};e.areaConversion=r,r.sqm=r.m2,r.sqkm=r.km2,r.sqft=r.ft2,r.sqyd=r.yd2,r.sqin=r.in2},5241:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(4057),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",r=n.areaConversion[e];if(r)return t*r;throw new Error("Invalid unit used for area conversion.")};e.default=i},4638:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(4057),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",r=n.distanceConversion[e];if(r)return t*r;throw new Error("Invalid unit used for distance conversion.")};e.default=i},55:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(4057),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"kmh";switch(e){case"kmh":return t*n.timeConversion.h*n.distanceConversion.km;case"mph":return t*n.timeConversion.h*n.distanceConversion.mi;default:return t}};e.default=i},8412:function(t,e){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(u){i=!0,o=u}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t){var e=r(t.toString().split("."),2),n=e[0],i=e[1],o=Math.abs(Number(n)),s=60*Number("0."+(i||0)),a=s.toString().split("."),u=Math.floor(s),c=r(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=Math.pow(10,e);return Math.round(t*r)/r}(60*Number("0."+(a[1]||0))).toString().split("."),2),l=c[0],h=c[1],f=void 0===h?"0":h;return o+"\xb0 "+u.toString().padStart(2,"0")+"' "+l.padStart(2,"0")+"."+f.padEnd(1,"0")+'"'};e.default=i},6789:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(6620))&&n.__esModule?n:{default:n};var o=function(t,e){return(0,i.default)(t,e)[0]};e.default=o},8324:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(451)),i=a(r(420)),o=a(r(6594)),s=r(4057);function a(t){return t&&t.__esModule?t:{default:t}}var u=function(t){var e=0;if(t.length>2){for(var r,a,u,c=0;c<t.length;c++){c===t.length-2?(r=t.length-2,a=t.length-1,u=0):c===t.length-1?(r=t.length-1,a=0,u=1):(r=c,a=c+1,u=c+2);var l=(0,o.default)(t[r]),h=(0,i.default)(t[a]),f=(0,o.default)(t[u]);e+=((0,n.default)(f)-(0,n.default)(l))*Math.sin((0,n.default)(h))}e=e*s.earthRadius*s.earthRadius/2}return Math.abs(e)};e.default=u},3954:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(r(420)),i=o(r(6594));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(t){if(!1===Array.isArray(t)||0===t.length)throw new Error("No points were given.");return t.reduce((function(t,e){var r=(0,n.default)(e),o=(0,i.default)(e);return{maxLat:Math.max(r,t.maxLat),minLat:Math.min(r,t.minLat),maxLng:Math.max(o,t.maxLng),minLng:Math.min(o,t.minLng)}}),{maxLat:-1/0,minLat:1/0,maxLng:-1/0,minLng:1/0})};e.default=s},6914:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=u(r(420)),i=u(r(6594)),o=u(r(451)),s=u(r(7672)),a=r(4057);function u(t){return t&&t.__esModule?t:{default:t}}var c=function(t,e){var r,u,c=(0,n.default)(t),l=(0,i.default)(t),h=(0,o.default)(c),f=(0,o.default)(l),d=e/a.earthRadius,p=h-d,g=h+d,m=(0,o.default)(a.MAXLAT),y=(0,o.default)(a.MINLAT),v=(0,o.default)(a.MAXLON),b=(0,o.default)(a.MINLON);if(p>y&&g<m){var _=Math.asin(Math.sin(d)/Math.cos(h));(r=f-_)<b&&(r+=2*Math.PI),(u=f+_)>v&&(u-=2*Math.PI)}else p=Math.max(p,y),g=Math.min(g,m),r=b,u=v;return[{latitude:(0,s.default)(p),longitude:(0,s.default)(r)},{latitude:(0,s.default)(g),longitude:(0,s.default)(u)}]};e.default=c},2219:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(420)),i=a(r(6594)),o=a(r(451)),s=a(r(7672));function a(t){return t&&t.__esModule?t:{default:t}}var u=function(t){if(!1===Array.isArray(t)||0===t.length)return!1;var e=t.length,r=t.reduce((function(t,e){var r=(0,o.default)((0,n.default)(e)),s=(0,o.default)((0,i.default)(e));return{X:t.X+Math.cos(r)*Math.cos(s),Y:t.Y+Math.cos(r)*Math.sin(s),Z:t.Z+Math.sin(r)}}),{X:0,Y:0,Z:0}),a=r.X/e,u=r.Y/e,c=r.Z/e;return{longitude:(0,s.default)(Math.atan2(u,a)),latitude:(0,s.default)(Math.atan2(c,Math.sqrt(a*a+u*u)))}};e.default=u},5146:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(3954))&&n.__esModule?n:{default:n};var o=function(t){var e=(0,i.default)(t),r=e.minLat+(e.maxLat-e.minLat)/2,n=e.minLng+(e.maxLng-e.minLng)/2;return{latitude:parseFloat(r.toFixed(6)),longitude:parseFloat(n.toFixed(6))}};e.default=o},9816:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(2392))&&n.__esModule?n:{default:n};var o=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.default,n="function"===typeof r?r(t,e):(0,i.default)(t,e);if(isNaN(n))throw new Error("Could not calculate bearing for given points. Check your bearing function");switch(Math.round(n/22.5)){case 1:return"NNE";case 2:return"NE";case 3:return"ENE";case 4:return"E";case 5:return"ESE";case 6:return"SE";case 7:return"SSE";case 8:return"S";case 9:return"SSW";case 10:return"SW";case 11:return"WSW";case 12:return"W";case 13:return"WNW";case 14:return"NW";case 15:return"NNW";default:return"N"}};e.default=o},4179:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(t,e){return e.reduce((function(e,r){if("undefined"===typeof t||null===t)throw new Error("'".concat(t,"' is no valid coordinate."));return Object.prototype.hasOwnProperty.call(t,r)&&"undefined"!==typeof r&&"undefined"===typeof e?(e=r,r):e}),void 0)};e.default=r},5456:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=r(4057),o=(n=r(4179))&&n.__esModule?n:{default:n};function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{longitude:i.longitudeKeys,latitude:i.latitudeKeys,altitude:i.altitudeKeys},r=(0,o.default)(t,e.longitude),n=(0,o.default)(t,e.latitude),s=(0,o.default)(t,e.altitude);return a({latitude:n,longitude:r},s?{altitude:s}:{})};e.default=c},691:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=u(r(420)),i=u(r(6594)),o=u(r(451)),s=u(r(6533)),a=r(4057);function u(t){return t&&t.__esModule?t:{default:t}}var c=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;r="undefined"===typeof r||isNaN(r)?1:r;var u=(0,n.default)(t),c=(0,i.default)(t),l=(0,n.default)(e),h=(0,i.default)(e),f=Math.acos((0,s.default)(Math.sin((0,o.default)(l))*Math.sin((0,o.default)(u))+Math.cos((0,o.default)(l))*Math.cos((0,o.default)(u))*Math.cos((0,o.default)(c)-(0,o.default)(h))))*a.earthRadius;return Math.round(f/r)*r};e.default=c},6947:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(r(691)),i=o(r(6533));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=(0,n.default)(e,t,o),a=(0,n.default)(t,r,o),u=(0,n.default)(e,r,o),c=Math.acos((0,i.default)((s*s+u*u-a*a)/(2*s*u))),l=Math.acos((0,i.default)((a*a+u*u-s*s)/(2*a*u)));return c>Math.PI/2?s:l>Math.PI/2?a:Math.sin(c)*s};e.default=s},5043:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(420)),i=a(r(6594)),o=a(r(451)),s=a(r(7672));function a(t){return t&&t.__esModule?t:{default:t}}var u=function(t,e){var r=(0,n.default)(e),a=(0,i.default)(e),u=(0,n.default)(t),c=(0,i.default)(t);return((0,s.default)(Math.atan2(Math.sin((0,o.default)(a)-(0,o.default)(c))*Math.cos((0,o.default)(r)),Math.cos((0,o.default)(u))*Math.sin((0,o.default)(r))-Math.sin((0,o.default)(u))*Math.cos((0,o.default)(r))*Math.cos((0,o.default)(a)-(0,o.default)(c))))+360)%360};e.default=u},420:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(4057),i=s(r(4179)),o=s(r(8290));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(t,e){var r=(0,i.default)(t,n.latitudeKeys);if("undefined"!==typeof r&&null!==r){var s=t[r];return!0===e?s:(0,o.default)(s)}};e.default=a},6594:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(4057),i=s(r(4179)),o=s(r(8290));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(t,e){var r=(0,i.default)(t,n.longitudeKeys);if("undefined"!==typeof r&&null!==r){var s=t[r];return!0===e?s:(0,o.default)(s)}};e.default=a},6037:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(691))&&n.__esModule?n:{default:n};function o(t){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.default;return t.reduce((function(t,r){return"object"===o(t)&&null!==t.last&&(t.distance+=e(r,t.last)),t.last=r,t}),{last:null,distance:0}).distance};e.default=s},4288:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(420)),i=a(r(6594)),o=a(r(451)),s=r(4057);function a(t){return t&&t.__esModule?t:{default:t}}var u=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;r="undefined"===typeof r||isNaN(r)?1:r;var a,u,c,l,h,f,d,p=(0,n.default)(t),g=(0,i.default)(t),m=(0,n.default)(e),y=(0,i.default)(e),v=6356752.314245,b=1/298.257223563,_=(0,o.default)(y-g),w=Math.atan((1-b)*Math.tan((0,o.default)(parseFloat(p)))),x=Math.atan((1-b)*Math.tan((0,o.default)(parseFloat(m)))),E=Math.sin(w),P=Math.cos(w),M=Math.sin(x),S=Math.cos(x),O=_,A=100;do{var T=Math.sin(O),k=Math.cos(O);if(0===(f=Math.sqrt(S*T*(S*T)+(P*M-E*S*k)*(P*M-E*S*k))))return 0;a=E*M+P*S*k,u=Math.atan2(f,a),h=a-2*E*M/(l=1-(c=P*S*T/f)*c),isNaN(h)&&(h=0);var C=b/16*l*(4+b*(4-3*l));d=O,O=_+(1-C)*b*c*(u+C*f*(h+C*a*(2*h*h-1)))}while(Math.abs(O-d)>1e-12&&--A>0);if(0===A)return NaN;var j=l*(s.earthRadius*s.earthRadius-v*v)/(v*v),I=1+j/16384*(4096+j*(j*(320-175*j)-768)),R=j/1024*(256+j*(j*(74-47*j)-128)),L=R*f*(h+R/4*(a*(2*h*h-1)-R/6*h*(4*f*f-3)*(4*h*h-3))),D=v*I*(u-L);return Math.round(D/r)*r};e.default=u},2392:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(420)),i=a(r(6594)),o=a(r(451)),s=a(r(7672));function a(t){return t&&t.__esModule?t:{default:t}}var u=function(t,e){var r=(0,o.default)((0,i.default)(e))-(0,o.default)((0,i.default)(t)),a=Math.log(Math.tan((0,o.default)((0,n.default)(e))/2+Math.PI/4)/Math.tan((0,o.default)((0,n.default)(t))/2+Math.PI/4));return Math.abs(r)>Math.PI&&(r=r>0?-1*(2*Math.PI-r):2*Math.PI+r),((0,s.default)(Math.atan2(r,a))+360)%360};e.default=u},4866:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(t){return/^NNE|NE|NNW|N$/.test(t)?"N":/^ENE|E|ESE|SE$/.test(t)?"E":/^SSE|S|SSW|SW$/.test(t)?"S":/^WSW|W|WNW|NW$/.test(t)?"W":void 0};e.default=r},6587:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(691))&&n.__esModule?n:{default:n};var o=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.default,n=r(t,e),o=Number(e.time)-Number(t.time),s=n/o*1e3;return s};e.default=o},7698:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={computeDestinationPoint:!0,convertArea:!0,convertDistance:!0,convertSpeed:!0,decimalToSexagesimal:!0,findNearest:!0,getAreaOfPolygon:!0,getBounds:!0,getBoundsOfDistance:!0,getCenter:!0,getCenterOfBounds:!0,getCompassDirection:!0,getCoordinateKey:!0,getCoordinateKeys:!0,getDistance:!0,getDistanceFromLine:!0,getGreatCircleBearing:!0,getLatitude:!0,getLongitude:!0,getPathLength:!0,getPreciseDistance:!0,getRhumbLineBearing:!0,getRoughCompassDirection:!0,getSpeed:!0,isDecimal:!0,isPointInLine:!0,isPointInPolygon:!0,isPointNearLine:!0,isPointWithinRadius:!0,isSexagesimal:!0,isValidCoordinate:!0,isValidLatitude:!0,isValidLongitude:!0,orderByDistance:!0,sexagesimalToDecimal:!0,toDecimal:!0,toRad:!0,toDeg:!0,wktToPolygon:!0};Object.defineProperty(e,"computeDestinationPoint",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"convertArea",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"convertDistance",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"convertSpeed",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"decimalToSexagesimal",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"findNearest",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"getAreaOfPolygon",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"getBounds",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"getBoundsOfDistance",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"getCenter",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"getCenterOfBounds",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"getCompassDirection",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(e,"getCoordinateKey",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(e,"getCoordinateKeys",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(e,"getDistance",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(e,"getDistanceFromLine",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(e,"getGreatCircleBearing",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(e,"getLatitude",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(e,"getLongitude",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(e,"getPathLength",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(e,"getPreciseDistance",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(e,"getRhumbLineBearing",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(e,"getRoughCompassDirection",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(e,"getSpeed",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(e,"isDecimal",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(e,"isPointInLine",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(e,"isPointInPolygon",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(e,"isPointNearLine",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(e,"isPointWithinRadius",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(e,"isSexagesimal",{enumerable:!0,get:function(){return I.default}}),Object.defineProperty(e,"isValidCoordinate",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(e,"isValidLatitude",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(e,"isValidLongitude",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(e,"orderByDistance",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(e,"sexagesimalToDecimal",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(e,"toDecimal",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(e,"toRad",{enumerable:!0,get:function(){return z.default}}),Object.defineProperty(e,"toDeg",{enumerable:!0,get:function(){return U.default}}),Object.defineProperty(e,"wktToPolygon",{enumerable:!0,get:function(){return V.default}});var i=W(r(4868)),o=W(r(5241)),s=W(r(4638)),a=W(r(55)),u=W(r(8412)),c=W(r(6789)),l=W(r(8324)),h=W(r(3954)),f=W(r(6914)),d=W(r(2219)),p=W(r(5146)),g=W(r(9816)),m=W(r(4179)),y=W(r(5456)),v=W(r(691)),b=W(r(6947)),_=W(r(5043)),w=W(r(420)),x=W(r(6594)),E=W(r(6037)),P=W(r(4288)),M=W(r(2392)),S=W(r(4866)),O=W(r(6587)),A=W(r(7182)),T=W(r(1521)),k=W(r(813)),C=W(r(8e3)),j=W(r(3741)),I=W(r(1496)),R=W(r(43)),L=W(r(2807)),D=W(r(6749)),F=W(r(6620)),N=W(r(6160)),B=W(r(8290)),z=W(r(451)),U=W(r(7672)),V=W(r(9553)),G=r(4057);function W(t){return t&&t.__esModule?t:{default:t}}Object.keys(G).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return G[t]}}))}))},7182:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(t){var e=t.toString().trim();return!isNaN(parseFloat(e))&&parseFloat(e)===Number(e)};e.default=r},1521:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(691))&&n.__esModule?n:{default:n};var o=function(t,e,r){return(0,i.default)(e,t)+(0,i.default)(t,r)===(0,i.default)(e,r)};e.default=o},813:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(r(420)),i=o(r(6594));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e){for(var r=!1,o=e.length,s=-1,a=o-1;++s<o;a=s)((0,i.default)(e[s])<=(0,i.default)(t)&&(0,i.default)(t)<(0,i.default)(e[a])||(0,i.default)(e[a])<=(0,i.default)(t)&&(0,i.default)(t)<(0,i.default)(e[s]))&&(0,n.default)(t)<((0,n.default)(e[a])-(0,n.default)(e[s]))*((0,i.default)(t)-(0,i.default)(e[s]))/((0,i.default)(e[a])-(0,i.default)(e[s]))+(0,n.default)(e[s])&&(r=!r);return r};e.default=s},8e3:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(6947))&&n.__esModule?n:{default:n};var o=function(t,e,r,n){return(0,i.default)(t,e,r)<n};e.default=o},3741:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(691))&&n.__esModule?n:{default:n};var o=function(t,e,r){return(0,i.default)(t,e)<r};e.default=o},1496:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(4057),i=function(t){return n.sexagesimalPattern.test(t.toString().trim())};e.default=i},43:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(r(5456)),i=s(r(2807)),o=s(r(6749));function s(t){return t&&t.__esModule?t:{default:t}}var a=function(t){var e=(0,n.default)(t),r=e.latitude,s=e.longitude;if(Array.isArray(t)&&t.length>=2)return(0,o.default)(t[0])&&(0,i.default)(t[1]);if("undefined"===typeof r||"undefined"===typeof s)return!1;var a=t[s],u=t[r];return"undefined"!==typeof u&&"undefined"!==typeof a&&(!1!==(0,i.default)(u)&&!1!==(0,o.default)(a))};e.default=a},2807:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(7182)),i=a(r(1496)),o=a(r(6160)),s=r(4057);function a(t){return t&&t.__esModule?t:{default:t}}var u=function t(e){return(0,n.default)(e)?!(parseFloat(e)>s.MAXLAT||e<s.MINLAT):!!(0,i.default)(e)&&t((0,o.default)(e))};e.default=u},6749:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(7182)),i=a(r(1496)),o=a(r(6160)),s=r(4057);function a(t){return t&&t.__esModule?t:{default:t}}var u=function t(e){return(0,n.default)(e)?!(parseFloat(e)>s.MAXLON||e<s.MINLON):!!(0,i.default)(e)&&t((0,o.default)(e))};e.default=u},6620:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(691))&&n.__esModule?n:{default:n};var o=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.default;return r="function"===typeof r?r:i.default,e.slice().sort((function(e,n){return r(t,e)-r(t,n)}))};e.default=o},6533:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(t){return t>1?1:t<-1?-1:t};e.default=r},6160:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(4057),i=function(t){var e=new RegExp(n.sexagesimalPattern).exec(t.toString().trim());if("undefined"===typeof e||null===e)throw new Error("Given value is not in sexagesimal format");var r=Number(e[2])/60||0,i=Number(e[4])/3600||0,o=parseFloat(e[1])+r+i;return["S","W"].includes(e[7])?-o:o};e.default=i},8290:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=u(r(7182)),i=u(r(1496)),o=u(r(6160)),s=u(r(43)),a=u(r(5456));function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){h(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var f=function t(e){if((0,n.default)(e))return Number(e);if((0,i.default)(e))return(0,o.default)(e);if((0,s.default)(e)){var r=(0,a.default)(e);return Array.isArray(e)?e.map((function(e,r){return[0,1].includes(r)?t(e):e})):l(l(l({},e),r.latitude&&h({},r.latitude,t(e[r.latitude]))),r.longitude&&h({},r.longitude,t(e[r.longitude])))}return Array.isArray(e)?e.map((function(e){return(0,s.default)(e)?t(e):e})):e};e.default=f},7672:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(t){return 180*t/Math.PI};e.default=r},451:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(t){return t*Math.PI/180};e.default=r},9553:function(t,e){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(u){i=!0,o=u}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t){if(!t.startsWith("POLYGON"))throw new Error("Invalid wkt.");return t.slice(t.indexOf("(")+2,t.indexOf(")")).split(", ").map((function(t){var e=r(t.split(" "),2),n=e[0],i=e[1];return{longitude:parseFloat(n),latitude:parseFloat(i)}}))};e.default=i},210:function(t,e,r){"use strict";var n,i=SyntaxError,o=Function,s=TypeError,a=function(t){try{return o('"use strict"; return ('+t+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(A){u=null}var c=function(){throw new s},l=u?function(){try{return c}catch(t){try{return u(arguments,"callee").get}catch(e){return c}}}():c,h=r(1405)(),f=Object.getPrototypeOf||function(t){return t.__proto__},d={},p="undefined"===typeof Uint8Array?n:f(Uint8Array),g={"%AggregateError%":"undefined"===typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"===typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":h?f([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"===typeof Atomics?n:Atomics,"%BigInt%":"undefined"===typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"===typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"===typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"===typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"===typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":d,"%Int8Array%":"undefined"===typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"===typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"===typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h?f(f([][Symbol.iterator]())):n,"%JSON%":"object"===typeof JSON?JSON:n,"%Map%":"undefined"===typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!==typeof Map&&h?f((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"===typeof Promise?n:Promise,"%Proxy%":"undefined"===typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"===typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"===typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!==typeof Set&&h?f((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h?f(""[Symbol.iterator]()):n,"%Symbol%":h?Symbol:n,"%SyntaxError%":i,"%ThrowTypeError%":l,"%TypedArray%":p,"%TypeError%":s,"%Uint8Array%":"undefined"===typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"===typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"===typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"===typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"===typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"===typeof WeakSet?n:WeakSet},m=function t(e){var r;if("%AsyncFunction%"===e)r=a("async function () {}");else if("%GeneratorFunction%"===e)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===e)r=a("async function* () {}");else if("%AsyncGenerator%"===e){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===e){var i=t("%AsyncGenerator%");i&&(r=f(i.prototype))}return g[e]=r,r},y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},v=r(8612),b=r(7642),_=v.call(Function.call,Array.prototype.concat),w=v.call(Function.apply,Array.prototype.splice),x=v.call(Function.call,String.prototype.replace),E=v.call(Function.call,String.prototype.slice),P=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,M=/\\(\\)?/g,S=function(t){var e=E(t,0,1),r=E(t,-1);if("%"===e&&"%"!==r)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==e)throw new i("invalid intrinsic syntax, expected opening `%`");var n=[];return x(t,P,(function(t,e,r,i){n[n.length]=r?x(i,M,"$1"):e||t})),n},O=function(t,e){var r,n=t;if(b(y,n)&&(n="%"+(r=y[n])[0]+"%"),b(g,n)){var o=g[n];if(o===d&&(o=m(n)),"undefined"===typeof o&&!e)throw new s("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new i("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!==typeof t||0===t.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!==typeof e)throw new s('"allowMissing" argument must be a boolean');var r=S(t),n=r.length>0?r[0]:"",o=O("%"+n+"%",e),a=o.name,c=o.value,l=!1,h=o.alias;h&&(n=h[0],w(r,_([0,1],h)));for(var f=1,d=!0;f<r.length;f+=1){var p=r[f],m=E(p,0,1),y=E(p,-1);if(('"'===m||"'"===m||"`"===m||'"'===y||"'"===y||"`"===y)&&m!==y)throw new i("property names with quotes must have matching quotes");if("constructor"!==p&&d||(l=!0),b(g,a="%"+(n+="."+p)+"%"))c=g[a];else if(null!=c){if(!(p in c)){if(!e)throw new s("base intrinsic for "+t+" exists, but the property is not available.");return}if(u&&f+1>=r.length){var v=u(c,p);c=(d=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:c[p]}else d=b(c,p),c=c[p];d&&!l&&(g[a]=c)}}return c}},840:function(t,e,r){var n;!function(i,o,s,a){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),h=Math.round,f=Math.abs,d=Date.now;function p(t,e,r){return setTimeout(w(t,r),e)}function g(t,e,r){return!!Array.isArray(t)&&(m(t,r[e],r),!0)}function m(t,e,r){var n;if(t)if(t.forEach)t.forEach(e,r);else if(t.length!==a)for(n=0;n<t.length;)e.call(r,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(r,t[n],n,t)}function y(t,e,r){var n="DEPRECATED METHOD: "+e+"\n"+r+" AT \n";return function(){var e=new Error("get-stack-trace"),r=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,n,r),t.apply(this,arguments)}}u="function"!==typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(n!==a&&null!==n)for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e}:Object.assign;var v=y((function(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;)(!r||r&&t[n[i]]===a)&&(t[n[i]]=e[n[i]]),i++;return t}),"extend","Use `assign`."),b=y((function(t,e){return v(t,e,!0)}),"merge","Use `assign`.");function _(t,e,r){var n,i=e.prototype;(n=t.prototype=Object.create(i)).constructor=t,n._super=i,r&&u(n,r)}function w(t,e){return function(){return t.apply(e,arguments)}}function x(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function E(t,e){return t===a?e:t}function P(t,e,r){m(A(e),(function(e){t.addEventListener(e,r,!1)}))}function M(t,e,r){m(A(e),(function(e){t.removeEventListener(e,r,!1)}))}function S(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function O(t,e){return t.indexOf(e)>-1}function A(t){return t.trim().split(/\s+/g)}function T(t,e,r){if(t.indexOf&&!r)return t.indexOf(e);for(var n=0;n<t.length;){if(r&&t[n][r]==e||!r&&t[n]===e)return n;n++}return-1}function k(t){return Array.prototype.slice.call(t,0)}function C(t,e,r){for(var n=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];T(i,s)<0&&n.push(t[o]),i[o]=s,o++}return r&&(n=e?n.sort((function(t,r){return t[e]>r[e]})):n.sort()),n}function j(t,e){for(var r,n,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((n=(r=c[o])?r+i:e)in t)return n;o++}return a}var I=1;function R(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var L="ontouchstart"in i,D=j(i,"PointerEvent")!==a,F=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N="touch",B="mouse",z=24,U=["x","y"],V=["clientX","clientY"];function G(t,e){var r=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){x(t.options.enable,[t])&&r.handler(e)},this.init()}function W(t,e,r){var n=r.pointers.length,i=r.changedPointers.length,o=1&e&&n-i===0,s=12&e&&n-i===0;r.isFirst=!!o,r.isFinal=!!s,o&&(t.session={}),r.eventType=e,function(t,e){var r=t.session,n=e.pointers,i=n.length;r.firstInput||(r.firstInput=Z(e));i>1&&!r.firstMultiple?r.firstMultiple=Z(e):1===i&&(r.firstMultiple=!1);var o=r.firstInput,s=r.firstMultiple,u=s?s.center:o.center,c=e.center=$(n);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=q(u,c),e.distance=H(u,c),function(t,e){var r=e.center,n=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},n=t.offsetDelta={x:r.x,y:r.y});e.deltaX=i.x+(r.x-n.x),e.deltaY=i.y+(r.y-n.y)}(r,e),e.offsetDirection=Y(e.deltaX,e.deltaY);var l=X(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=f(l.x)>f(l.y)?l.x:l.y,e.scale=s?(h=s.pointers,p=n,H(p[0],p[1],V)/H(h[0],h[1],V)):1,e.rotation=s?function(t,e){return q(e[1],e[0],V)+q(t[1],t[0],V)}(s.pointers,n):0,e.maxPointers=r.prevInput?e.pointers.length>r.prevInput.maxPointers?e.pointers.length:r.prevInput.maxPointers:e.pointers.length,function(t,e){var r,n,i,o,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(u>25||s.velocity===a)){var c=e.deltaX-s.deltaX,l=e.deltaY-s.deltaY,h=X(u,c,l);n=h.x,i=h.y,r=f(h.x)>f(h.y)?h.x:h.y,o=Y(c,l),t.lastInterval=e}else r=s.velocity,n=s.velocityX,i=s.velocityY,o=s.direction;e.velocity=r,e.velocityX=n,e.velocityY=i,e.direction=o}(r,e);var h,p;var g=t.element;S(e.srcEvent.target,g)&&(g=e.srcEvent.target);e.target=g}(t,r),t.emit("hammer.input",r),t.recognize(r),t.session.prevInput=r}function Z(t){for(var e=[],r=0;r<t.pointers.length;)e[r]={clientX:h(t.pointers[r].clientX),clientY:h(t.pointers[r].clientY)},r++;return{timeStamp:d(),pointers:e,center:$(e),deltaX:t.deltaX,deltaY:t.deltaY}}function $(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var r=0,n=0,i=0;i<e;)r+=t[i].clientX,n+=t[i].clientY,i++;return{x:h(r/e),y:h(n/e)}}function X(t,e,r){return{x:e/t||0,y:r/t||0}}function Y(t,e){return t===e?1:f(t)>=f(e)?t<0?2:4:e<0?8:16}function H(t,e,r){r||(r=U);var n=e[r[0]]-t[r[0]],i=e[r[1]]-t[r[1]];return Math.sqrt(n*n+i*i)}function q(t,e,r){r||(r=U);var n=e[r[0]]-t[r[0]],i=e[r[1]]-t[r[1]];return 180*Math.atan2(i,n)/Math.PI}G.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(R(this.element),this.evWin,this.domHandler)}};var K={mousedown:1,mousemove:2,mouseup:4},Q="mousedown",J="mousemove mouseup";function tt(){this.evEl=Q,this.evWin=J,this.pressed=!1,G.apply(this,arguments)}_(tt,G,{handler:function(t){var e=K[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:B,srcEvent:t}))}});var et={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},rt={2:N,3:"pen",4:B,5:"kinect"},nt="pointerdown",it="pointermove pointerup pointercancel";function ot(){this.evEl=nt,this.evWin=it,G.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(nt="MSPointerDown",it="MSPointerMove MSPointerUp MSPointerCancel"),_(ot,G,{handler:function(t){var e=this.store,r=!1,n=t.type.toLowerCase().replace("ms",""),i=et[n],o=rt[t.pointerType]||t.pointerType,s=o==N,a=T(e,t.pointerId,"pointerId");1&i&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&i&&(r=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),r&&e.splice(a,1))}});var st={touchstart:1,touchmove:2,touchend:4,touchcancel:8},at="touchstart",ut="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=at,this.evWin=ut,this.started=!1,G.apply(this,arguments)}function lt(t,e){var r=k(t.touches),n=k(t.changedTouches);return 12&e&&(r=C(r.concat(n),"identifier",!0)),[r,n]}_(ct,G,{handler:function(t){var e=st[t.type];if(1===e&&(this.started=!0),this.started){var r=lt.call(this,t,e);12&e&&r[0].length-r[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:r[0],changedPointers:r[1],pointerType:N,srcEvent:t})}}});var ht={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ft="touchstart touchmove touchend touchcancel";function dt(){this.evTarget=ft,this.targetIds={},G.apply(this,arguments)}function pt(t,e){var r=k(t.touches),n=this.targetIds;if(3&e&&1===r.length)return n[r[0].identifier]=!0,[r,r];var i,o,s=k(t.changedTouches),a=[],u=this.target;if(o=r.filter((function(t){return S(t.target,u)})),1===e)for(i=0;i<o.length;)n[o[i].identifier]=!0,i++;for(i=0;i<s.length;)n[s[i].identifier]&&a.push(s[i]),12&e&&delete n[s[i].identifier],i++;return a.length?[C(o.concat(a),"identifier",!0),a]:void 0}_(dt,G,{handler:function(t){var e=ht[t.type],r=pt.call(this,t,e);r&&this.callback(this.manager,e,{pointers:r[0],changedPointers:r[1],pointerType:N,srcEvent:t})}});function gt(){G.apply(this,arguments);var t=w(this.handler,this);this.touch=new dt(this.manager,t),this.mouse=new tt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function mt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,yt.call(this,e)):12&t&&yt.call(this,e)}function yt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var r={x:e.clientX,y:e.clientY};this.lastTouches.push(r);var n=this.lastTouches;setTimeout((function(){var t=n.indexOf(r);t>-1&&n.splice(t,1)}),2500)}}function vt(t){for(var e=t.srcEvent.clientX,r=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var i=this.lastTouches[n],o=Math.abs(e-i.x),s=Math.abs(r-i.y);if(o<=25&&s<=25)return!0}return!1}_(gt,G,{handler:function(t,e,r){var n=r.pointerType==N,i=r.pointerType==B;if(!(i&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)){if(n)mt.call(this,e,r);else if(i&&vt.call(this,r))return;this.callback(t,e,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var bt=j(l.style,"touchAction"),_t=bt!==a,wt="compute",xt="auto",Et="manipulation",Pt="none",Mt="pan-x",St="pan-y",Ot=function(){if(!_t)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(r){t[r]=!e||i.CSS.supports("touch-action",r)})),t}();function At(t,e){this.manager=t,this.set(e)}At.prototype={set:function(t){t==wt&&(t=this.compute()),_t&&this.manager.element.style&&Ot[t]&&(this.manager.element.style[bt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){x(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(O(t,Pt))return Pt;var e=O(t,Mt),r=O(t,St);if(e&&r)return Pt;if(e||r)return e?Mt:St;if(O(t,Et))return Et;return xt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,r=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,i=O(n,Pt)&&!Ot.none,o=O(n,St)&&!Ot["pan-y"],s=O(n,Mt)&&!Ot["pan-x"];if(i){var a=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(a&&u&&c)return}if(!s||!o)return i||o&&6&r||s&&r&z?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Tt=32;function kt(t){this.options=u({},this.defaults,t||{}),this.id=I++,this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Ct(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function jt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function It(t,e){var r=e.manager;return r?r.get(t):t}function Rt(){kt.apply(this,arguments)}function Lt(){Rt.apply(this,arguments),this.pX=null,this.pY=null}function Dt(){Rt.apply(this,arguments)}function Ft(){kt.apply(this,arguments),this._timer=null,this._input=null}function Nt(){Rt.apply(this,arguments)}function Bt(){Rt.apply(this,arguments)}function zt(){kt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ut(t,e){return(e=e||{}).recognizers=E(e.recognizers,Ut.defaults.preset),new Vt(t,e)}kt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=It(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=It(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===T(e,t=It(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=It(t,this);var e=T(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,r=this.state;function n(r){e.manager.emit(r,t)}r<8&&n(e.options.event+Ct(r)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),r>=8&&n(e.options.event+Ct(r))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Tt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!x(this.options.enable,[this,e]))return this.reset(),void(this.state=Tt);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},_(Rt,kt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,r=t.eventType,n=6&e,i=this.attrTest(t);return n&&(8&r||!i)?16|e:n||i?4&r?8|e:2&e?4|e:2:Tt}}),_(Lt,Rt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(St),t&z&&e.push(Mt),e},directionTest:function(t){var e=this.options,r=!0,n=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,r=o!=this.pX,n=Math.abs(t.deltaX)):(i=0===s?1:s<0?8:16,r=s!=this.pY,n=Math.abs(t.deltaY))),t.direction=i,r&&n>e.threshold&&i&e.direction},attrTest:function(t){return Rt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=jt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),_(Dt,Rt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Pt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),_(Ft,kt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xt]},process:function(t){var e=this.options,r=t.pointers.length===e.pointers,n=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!n||!r||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Tt},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),_(Nt,Rt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Pt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),_(Bt,Rt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Lt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,r=this.options.direction;return 30&r?e=t.overallVelocity:6&r?e=t.overallVelocityX:r&z&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&r&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&f(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=jt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),_(zt,kt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Et]},process:function(t){var e=this.options,r=t.pointers.length===e.pointers,n=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(n&&i&&r){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||H(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Tt},failTimeout:function(){return this._timer=p((function(){this.state=Tt}),this.options.interval,this),Tt},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ut.VERSION="2.0.7",Ut.defaults={domEvents:!1,touchAction:wt,enable:!0,inputTarget:null,inputClass:null,preset:[[Nt,{enable:!1}],[Dt,{enable:!1},["rotate"]],[Bt,{direction:6}],[Lt,{direction:6},["swipe"]],[zt],[zt,{event:"doubletap",taps:2},["tap"]],[Ft]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Vt(t,e){var r;this.options=u({},Ut.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((r=this).options.inputClass||(D?ot:F?dt:L?gt:tt))(r,W),this.touchAction=new At(this,this.options.touchAction),Gt(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Gt(t,e){var r,n=t.element;n.style&&(m(t.options.cssProps,(function(i,o){r=j(n.style,o),e?(t.oldCssProps[r]=n.style[r],n.style[r]=i):n.style[r]=t.oldCssProps[r]||""})),e||(t.oldCssProps={}))}Vt.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var r;this.touchAction.preventDefaults(t);var n=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<n.length;)r=n[o],2===e.stopped||i&&r!=i&&!r.canRecognizeWith(i)?r.reset():r.recognize(t),!i&&14&r.state&&(i=e.curRecognizer=r),o++}},get:function(t){if(t instanceof kt)return t;for(var e=this.recognizers,r=0;r<e.length;r++)if(e[r].options.event==t)return e[r];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,r=T(e,t);-1!==r&&(e.splice(r,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var r=this.handlers;return m(A(t),(function(t){r[t]=r[t]||[],r[t].push(e)})),this}},off:function(t,e){if(t!==a){var r=this.handlers;return m(A(t),(function(t){e?r[t]&&r[t].splice(T(r[t],e),1):delete r[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var r=o.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=e,e.target.dispatchEvent(r)}(t,e);var r=this.handlers[t]&&this.handlers[t].slice();if(r&&r.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<r.length;)r[n](e),n++}},destroy:function(){this.element&&Gt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Ut,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Tt,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:z,DIRECTION_ALL:30,Manager:Vt,Input:G,TouchAction:At,TouchInput:dt,MouseInput:tt,PointerEventInput:ot,TouchMouseInput:gt,SingleTouchInput:ct,Recognizer:kt,AttrRecognizer:Rt,Tap:zt,Pan:Lt,Swipe:Bt,Pinch:Dt,Rotate:Nt,Press:Ft,on:P,off:M,each:m,merge:b,extend:v,assign:u,inherit:_,bindFn:w,prefixed:j}),("undefined"!==typeof i?i:"undefined"!==typeof self?self:{}).Hammer=Ut,(n=function(){return Ut}.call(e,r,e,t))===a||(t.exports=n)}(window,document)},1405:function(t,e,r){"use strict";var n="undefined"!==typeof Symbol&&Symbol,i=r(5419);t.exports=function(){return"function"===typeof n&&("function"===typeof Symbol&&("symbol"===typeof n("foo")&&("symbol"===typeof Symbol("bar")&&i())))}},5419:function(t){"use strict";t.exports=function(){if("function"!==typeof Symbol||"function"!==typeof Object.getOwnPropertySymbols)return!1;if("symbol"===typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),r=Object(e);if("string"===typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(e in t[e]=42,t)return!1;if("function"===typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"===typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"===typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(t,e);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},6410:function(t,e,r){"use strict";var n=r(5419);t.exports=function(){return n()&&!!Symbol.toStringTag}},7642:function(t,e,r){"use strict";var n=r(8612);t.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},8679:function(t,e,r){"use strict";var n=r(9864),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function u(t){return n.isMemo(t)?s:a[t.$$typeof]||i}a[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[n.Memo]=s;var c=Object.defineProperty,l=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;t.exports=function t(e,r,n){if("string"!==typeof r){if(p){var i=d(r);i&&i!==p&&t(e,i,n)}var s=l(r);h&&(s=s.concat(h(r)));for(var a=u(e),g=u(r),m=0;m<s.length;++m){var y=s[m];if(!o[y]&&(!n||!n[y])&&(!g||!g[y])&&(!a||!a[y])){var v=f(r,y);try{c(e,y,v)}catch(b){}}}}return e}},2584:function(t,e,r){"use strict";var n=r(6410)(),i=r(1924)("Object.prototype.toString"),o=function(t){return!(n&&t&&"object"===typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===i(t)},s=function(t){return!!o(t)||null!==t&&"object"===typeof t&&"number"===typeof t.length&&t.length>=0&&"[object Array]"!==i(t)&&"[object Function]"===i(t.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,t.exports=a?o:s},8923:function(t,e,r){"use strict";var n=Date.prototype.getDay,i=Object.prototype.toString,o=r(6410)();t.exports=function(t){return"object"===typeof t&&null!==t&&(o?function(t){try{return n.call(t),!0}catch(e){return!1}}(t):"[object Date]"===i.call(t))}},8420:function(t,e,r){"use strict";var n,i,o,s,a=r(1924),u=r(6410)();if(u){n=a("Object.prototype.hasOwnProperty"),i=a("RegExp.prototype.exec"),o={};var c=function(){throw o};s={toString:c,valueOf:c},"symbol"===typeof Symbol.toPrimitive&&(s[Symbol.toPrimitive]=c)}var l=a("Object.prototype.toString"),h=Object.getOwnPropertyDescriptor;t.exports=u?function(t){if(!t||"object"!==typeof t)return!1;var e=h(t,"lastIndex");if(!(e&&n(e,"value")))return!1;try{i(t,s)}catch(r){return r===o}}:function(t){return!(!t||"object"!==typeof t&&"function"!==typeof t)&&"[object RegExp]"===l(t)}},2317:function(t,e,r){"use strict";r.d(e,{Q:function(){return B}});var n=r(840),i=r.n(n);const o={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const r=this.store;t.button>0&&"pointerdown"===t.type&&(function(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}(r,(e=>e.pointerId===t.pointerId))||r.push(t)),e.call(this,t)}}(i().PointerEventInput),i().MouseInput.prototype.handler=function(t){let e=o[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const s=i().Manager;var a=i();const u=a?[[a.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[a.Rotate,{enable:!1}],[a.Pinch,{enable:!1}],[a.Swipe,{enable:!1}],[a.Pan,{threshold:0,enable:!1}],[a.Press,{enable:!1}],[a.Tap,{event:"doubletap",taps:2,enable:!1}],[a.Tap,{event:"anytap",enable:!1}],[a.Tap,{enable:!1}]]:null,c={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},l={doubletap:["tap"]},h={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},f={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},d={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},p={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},g="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",m="undefined"!==typeof window?window:r.g;"undefined"!==typeof r.g?r.g:window,"undefined"!==typeof document&&document;let y=!1;try{const t={get passive(){return y=!0,!0}};m.addEventListener("test",t,t),m.removeEventListener("test",t,t)}catch(z){}const v=-1!==g.indexOf("firefox"),{WHEEL_EVENTS:b}=f,_="wheel",w=4.000244140625;class x{constructor(t,e,r={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},r),this.events=b.concat(r.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!y&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===_&&(this.options.enable=e)}handleEvent(t){if(!this.options.enable)return;let e=t.deltaY;m.WheelEvent&&(v&&t.deltaMode===m.WheelEvent.DOM_DELTA_PIXEL&&(e/=m.devicePixelRatio),t.deltaMode===m.WheelEvent.DOM_DELTA_LINE&&(e*=40));const r={x:t.clientX,y:t.clientY};0!==e&&e%w===0&&(e=Math.floor(e/w)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,r)}_onWheel(t,e,r){this.callback({type:_,center:r,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}const{MOUSE_EVENTS:E}=f,P="pointermove",M="pointerover",S="pointerout",O="pointerleave";class A{constructor(t,e,r={}){this.element=t,this.callback=e,this.pressed=!1,this.options=Object.assign({enable:!0},r),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=E.concat(r.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===P&&(this.enableMoveEvent=e),t===M&&(this.enableOverEvent=e),t===S&&(this.enableOutEvent=e),t===O&&(this.enableLeaveEvent=e)}handleEvent(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:M,srcEvent:t,pointerType:"mouse",target:t.target})}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:S,srcEvent:t,pointerType:"mouse",target:t.target})}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:O,srcEvent:t,pointerType:"mouse",target:t.target})}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:P,srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:T}=f,k="keydown",C="keyup";class j{constructor(t,e,r={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},r),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=T.concat(r.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=r.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===k&&(this.enableDownEvent=e),t===C&&(this.enableUpEvent=e)}handleEvent(t){const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:k,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:C,srcEvent:t,key:t.key,target:t.target}))}}const I="contextmenu";class R{constructor(t,e,r={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},r),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===I&&(this.options.enable=e)}handleEvent(t){this.options.enable&&this.callback({type:I,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const L={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};const D={srcElement:"root",priority:0};class F{constructor(t){this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(t,e,r,n=!1,i=!1){const{handlers:o,handlersByElement:s}=this;r&&("object"!==typeof r||r.addEventListener)&&(r={srcElement:r}),r=r?Object.assign({},D,r):D;let a=s.get(r.srcElement);a||(a=[],s.set(r.srcElement,a));const u={type:t,handler:e,srcElement:r.srcElement,priority:r.priority};n&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let c=a.length-1;for(;c>=0&&!(a[c].priority>=u.priority);)c--;a.splice(c+1,0,u)}remove(t,e){const{handlers:r,handlersByElement:n}=this;for(let i=r.length-1;i>=0;i--){const o=r[i];if(o.type===t&&o.handler===e){r.splice(i,1);const t=n.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&n.delete(o.srcElement)}}this._active=r.some((t=>!t.passive))}handleEvent(t){if(this.isEmpty())return;const e=this._normalizeEvent(t);let r=t.srcEvent.target;for(;r&&r!==e.rootElement;){if(this._emit(e,r),e.handled)return;r=r.parentNode}this._emit(e,"root")}_emit(t,e){const r=this.handlersByElement.get(e);if(r){let e=!1;const n=()=>{t.handled=!0},i=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<r.length;s++){const{type:a,handler:u,once:c}=r[s];if(u(Object.assign({},t,{type:a,stopPropagation:n,stopImmediatePropagation:i})),c&&o.push(r[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:r}=o[t];this.remove(e,r)}}}_normalizeEvent(t){const e=this.eventManager.element;return Object.assign({},t,function(t){const e=L[t.srcEvent.type];if(!e)return null;const{buttons:r,button:n,which:i}=t.srcEvent;let o=!1,s=!1,a=!1;return 4===e||2===e&&!Number.isFinite(r)?(o=1===i,s=2===i,a=3===i):2===e?(o=Boolean(1&r),s=Boolean(4&r),a=Boolean(2&r)):1===e&&(o=0===n,s=1===n,a=2===n),{leftButton:o,middleButton:s,rightButton:a}}(t),function(t,e){const{srcEvent:r}=t;if(!t.center&&!Number.isFinite(r.clientX))return null;const n=t.center||{x:r.clientX,y:r.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-i.left-e.clientLeft)/o,y:(n.y-i.top-e.clientTop)/s}}}(t,e),{handled:!1,rootElement:e})}}const N={events:null,recognizers:null,recognizerOptions:{},Manager:s,touchAction:"none",tabIndex:0};class B{constructor(t=null,e={}){this.options=Object.assign({},N,e),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);const{events:r}=e;r&&this.on(r)}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,r=e.Manager;this.manager=new r(t,{touchAction:e.touchAction,recognizers:e.recognizers||u}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(c).forEach((t=>{const e=this.manager.get(t);e&&c[t].forEach((t=>{e.recognizeWith(t)}))}));for(const n in e.recognizerOptions){const t=this.manager.get(n);if(t){const r=e.recognizerOptions[n];delete r.enable,t.set(r)}}this.wheelInput=new x(t,this._onOtherEvent,{enable:!1}),this.moveInput=new A(t,this._onOtherEvent,{enable:!1}),this.keyInput=new j(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new R(t,this._onOtherEvent,{enable:!1});for(const[n,i]of this.events)i.isEmpty()||(this._toggleRecognizer(i.recognizerName,!0),this.manager.on(n,i.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,r){this._addEventHandler(t,e,r,!1)}once(t,e,r){this._addEventHandler(t,e,r,!0)}watch(t,e,r){this._addEventHandler(t,e,r,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:r}=this;if(!r)return;const n=r.get(t);if(n&&n.options.enable!==e){n.set({enable:e});const i=l[t];i&&!this.options.recognizers&&i.forEach((i=>{const o=r.get(i);e?(o.requireFailure(t),n.dropRequireFailure(i)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,r,n,i){if("string"!==typeof t){r=e;for(const e in t)this._addEventHandler(e,t[e],r,n,i);return}const{manager:o,events:s}=this,a=p[t]||t;let u=s.get(a);u||(u=new F(this),s.set(a,u),u.recognizerName=d[a]||a,o&&o.on(a,u.handleEvent)),u.add(t,e,r,n,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(t,e){if("string"!==typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:r}=this,n=p[t]||t,i=r.get(n);if(i&&(i.remove(t,e),i.isEmpty())){const{recognizerName:t}=i;let e=!1;for(const n of r.values())if(n.recognizerName===t&&!n.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}_onBasicInput(t){const{srcEvent:e}=t,r=h[e.type];r&&this.manager.emit(r,t)}_onOtherEvent(t){this.manager.emit(t.type,t)}}},724:function(){},9008:function(t,e,r){t.exports=r(639)},4244:function(t){"use strict";var e=function(t){return t!==t};t.exports=function(t,r){return 0===t&&0===r?1/t===1/r:t===r||!(!e(t)||!e(r))}},609:function(t,e,r){"use strict";var n=r(4289),i=r(5559),o=r(4244),s=r(5624),a=r(2281),u=i(s(),Object);n(u,{getPolyfill:s,implementation:o,shim:a}),t.exports=u},5624:function(t,e,r){"use strict";var n=r(4244);t.exports=function(){return"function"===typeof Object.is?Object.is:n}},2281:function(t,e,r){"use strict";var n=r(5624),i=r(4289);t.exports=function(){var t=n();return i(Object,{is:t},{is:function(){return Object.is!==t}}),t}},8987:function(t,e,r){"use strict";var n;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=r(1414),a=Object.prototype.propertyIsEnumerable,u=!a.call({toString:null},"toString"),c=a.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(t){var e=t.constructor;return e&&e.prototype===t},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"===typeof window)return!1;for(var t in window)try{if(!f["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"===typeof window[t])try{h(window[t])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(t){var e=null!==t&&"object"===typeof t,r="[object Function]"===o.call(t),n=s(t),a=e&&"[object String]"===o.call(t),f=[];if(!e&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var p=c&&r;if(a&&t.length>0&&!i.call(t,0))for(var g=0;g<t.length;++g)f.push(String(g));if(n&&t.length>0)for(var m=0;m<t.length;++m)f.push(String(m));else for(var y in t)p&&"prototype"===y||!i.call(t,y)||f.push(String(y));if(u)for(var v=function(t){if("undefined"===typeof window||!d)return h(t);try{return h(t)}catch(e){return!1}}(t),b=0;b<l.length;++b)v&&"constructor"===l[b]||!i.call(t,l[b])||f.push(l[b]);return f}}t.exports=n},2215:function(t,e,r){"use strict";var n=Array.prototype.slice,i=r(1414),o=Object.keys,s=o?function(t){return o(t)}:r(8987),a=Object.keys;s.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return i(t)?a(n.call(t)):a(t)}):Object.keys=s;return Object.keys||s},t.exports=s},1414:function(t){"use strict";var e=Object.prototype.toString;t.exports=function(t){var r=e.call(t),n="[object Arguments]"===r;return n||(n="[object Array]"!==r&&null!==t&&"object"===typeof t&&"number"===typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),n}},1895:function(t){t.exports=function(t,e,r,n){var i=t[0],o=t[1],s=!1;void 0===r&&(r=0),void 0===n&&(n=e.length);for(var a=(n-r)/2,u=0,c=a-1;u<a;c=u++){var l=e[r+2*u+0],h=e[r+2*u+1],f=e[r+2*c+0],d=e[r+2*c+1];h>o!==d>o&&i<(f-l)*(o-h)/(d-h)+l&&(s=!s)}return s}},6960:function(t,e,r){var n=r(1895),i=r(8139);t.exports=function(t,e,r,o){return e.length>0&&Array.isArray(e[0])?i(t,e,r,o):n(t,e,r,o)},t.exports.nested=i,t.exports.flat=n},8139:function(t){t.exports=function(t,e,r,n){var i=t[0],o=t[1],s=!1;void 0===r&&(r=0),void 0===n&&(n=e.length);for(var a=n-r,u=0,c=a-1;u<a;c=u++){var l=e[u+r][0],h=e[u+r][1],f=e[c+r][0],d=e[c+r][1];h>o!==d>o&&i<(f-l)*(o-h)/(d-h)+l&&(s=!s)}return s}},2676:function(t,e,r){var n=r(4155);t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}var i=function(){function t(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return t}();function o(t,e){return t>e?1:t<e?-1:0}function s(t,e,r){for(var n=new i(null,null),o=n,s=n;;){var a=r(t,e.key);if(a<0){if(null===e.left)break;if(r(t,e.left.key)<0){var u=e.left;if(e.left=u.right,u.right=e,null===(e=u).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(r(t,e.right.key)>0&&(u=e.right,e.right=u.left,u.left=e,null===(e=u).right))break;o.right=e,o=e,e=e.right}}return o.right=e.left,s.left=e.right,e.left=n.right,e.right=n.left,e}function a(t,e,r,n){var o=new i(t,e);if(null===r)return o.left=o.right=null,o;var a=n(t,(r=s(t,r,n)).key);return a<0?(o.left=r.left,o.right=r,r.left=null):a>=0&&(o.right=r.right,o.left=r,r.right=null),o}function u(t,e,r){var n=null,i=null;if(e){var o=r((e=s(t,e,r)).key,t);0===o?(n=e.left,i=e.right):o<0?(i=e.right,e.right=null,n=e):(n=e.left,e.left=null,i=e)}return{left:n,right:i}}function c(t,e,r){return null===e?t:(null===t||((e=s(t.key,e,r)).left=t),e)}function l(t,e,r,n,i){if(t){n(e+(r?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+i(t)+"\n");var o=e+(r?"    ":"\u2502   ");t.left&&l(t.left,o,!1,n,i),t.right&&l(t.right,o,!0,n,i)}}var h=function(){function t(t){void 0===t&&(t=o),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=a(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var r=new i(t,e);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var n=this._comparator,o=s(t,this._root,n),a=n(t,o.key);return 0===a?this._root=o:(a<0?(r.left=o.left,r.right=o,o.left=null):a>0&&(r.right=o.right,r.left=o,o.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,r){var n;return null===e?null:0===r(t,(e=s(t,e,r)).key)?(null===e.left?n=e.right:(n=s(t,e.left,r)).right=e.right,this._size--,n):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=s(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,r=this._comparator;e;){var n=r(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=s(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,r=this._comparator;e;){var n=r(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var r=this._root,n=[],i=!1;!i;)null!==r?(n.push(r),r=r.left):0!==n.length?(r=n.pop(),t.call(e,r),r=r.right):i=!0;return this},t.prototype.range=function(t,e,r,n){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(o((s=i.pop()).key,e)>0)break;if(o(s.key,t)>=0&&r.call(n,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var r=e.key;return t.push(r)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var r=e.data;return t.push(r)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,r=!1,n=0,i=[];!r;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),n===t)return e;n++,e=e.right}else r=!0;return null},t.prototype.next=function(t){var e=this._root,r=null;if(t.right){for(r=t.right;r.left;)r=r.left;return r}for(var n=this._comparator;e;){var i=n(t.key,e.key);if(0===i)break;i<0?(r=e,e=e.left):e=e.right}return r},t.prototype.prev=function(t){var e=this._root,r=null;if(null!==t.left){for(r=t.left;r.right;)r=r.right;return r}for(var n=this._comparator;e;){var i=n(t.key,e.key);if(0===i)break;i<0?e=e.left:(r=e,e=e.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return p(this._root)},t.prototype.load=function(t,e,r){void 0===e&&(e=[]),void 0===r&&(r=!1);var n=t.length,i=this._comparator;if(r&&y(t,e,0,n-1,i),null===this._root)this._root=f(t,e,0,n),this._size=n;else{var o=m(this.toList(),d(t,e),i);n=this._size+n,this._root=g({head:o},0,n)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return l(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,r){var n=this._comparator,i=u(t,this._root,n),o=i.left,s=i.right;n(t,e)<0?s=a(e,r,s,n):o=a(e,r,o,n),this._root=c(o,s,n)},t.prototype.split=function(t){return u(t,this._root,this._comparator)},t}();function f(t,e,r,n){var o=n-r;if(o>0){var s=r+Math.floor(o/2),a=t[s],u=e[s],c=new i(a,u);return c.left=f(t,e,r,s),c.right=f(t,e,s+1,n),c}return null}function d(t,e){for(var r=new i(null,null),n=r,o=0;o<t.length;o++)n=n.next=new i(t[o],e[o]);return n.next=null,r.next}function p(t){for(var e=t,r=[],n=!1,o=new i(null,null),s=o;!n;)e?(r.push(e),e=e.left):r.length>0?e=(e=s=s.next=r.pop()).right:n=!0;return s.next=null,o.next}function g(t,e,r){var n=r-e;if(n>0){var i=e+Math.floor(n/2),o=g(t,e,i),s=t.head;return s.left=o,t.head=t.head.next,s.right=g(t,i+1,r),s}return null}function m(t,e,r){for(var n=new i(null,null),o=n,s=t,a=e;null!==s&&null!==a;)r(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return null!==s?o.next=s:null!==a&&(o.next=a),n.next}function y(t,e,r,n,i){if(!(r>=n)){for(var o=t[r+n>>1],s=r-1,a=n+1;;){do{s++}while(i(t[s],o)<0);do{a--}while(i(t[a],o)>0);if(s>=a)break;var u=t[s];t[s]=t[a],t[a]=u,u=e[s],e[s]=e[a],e[a]=u}y(t,e,r,a,i),y(t,e,a+1,n,i)}}var v=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},b=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var r=t.ll.x<e.ll.x?e.ll.x:t.ll.x,n=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:r,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},_=Number.EPSILON;void 0===_&&(_=Math.pow(2,-52));var w=_*_,x=function(t,e){if(-_<t&&t<_&&-_<e&&e<_)return 0;var r=t-e;return r*r<w*t*e?0:t<e?-1:1},E=function(){function e(){t(this,e),this.reset()}return r(e,[{key:"reset",value:function(){this.xRounder=new P,this.yRounder=new P}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),P=function(){function e(){t(this,e),this.tree=new h,this.round(0)}return r(e,[{key:"round",value:function(t){var e=this.tree.add(t),r=this.tree.prev(e);if(null!==r&&0===x(e.key,r.key))return this.tree.remove(t),r.key;var n=this.tree.next(e);return null!==n&&0===x(e.key,n.key)?(this.tree.remove(t),n.key):t}}]),e}(),M=new E,S=function(t,e){return t.x*e.y-t.y*e.x},O=function(t,e){return t.x*e.x+t.y*e.y},A=function(t,e,r){var n={x:e.x-t.x,y:e.y-t.y},i={x:r.x-t.x,y:r.y-t.y},o=S(n,i);return x(o,0)},T=function(t){return Math.sqrt(O(t,t))},k=function(t,e,r){var n={x:e.x-t.x,y:e.y-t.y},i={x:r.x-t.x,y:r.y-t.y};return S(i,n)/T(i)/T(n)},C=function(t,e,r){var n={x:e.x-t.x,y:e.y-t.y},i={x:r.x-t.x,y:r.y-t.y};return O(i,n)/T(i)/T(n)},j=function(t,e,r){return 0===e.y?null:{x:t.x+e.x/e.y*(r-t.y),y:r}},I=function(t,e,r){return 0===e.x?null:{x:r,y:t.y+e.y/e.x*(r-t.x)}},R=function(t,e,r,n){if(0===e.x)return I(r,n,t.x);if(0===n.x)return I(t,e,r.x);if(0===e.y)return j(r,n,t.y);if(0===n.y)return j(t,e,r.y);var i=S(e,n);if(0==i)return null;var o={x:r.x-t.x,y:r.y-t.y},s=S(o,e)/i,a=S(o,n)/i;return{x:(t.x+a*e.x+(r.x+s*n.x))/2,y:(t.y+a*e.y+(r.y+s*n.y))/2}},L=function(){function e(r,n){t(this,e),void 0===r.events?r.events=[this]:r.events.push(this),this.point=r,this.isLeft=n}return r(e,null,[{key:"compare",value:function(t,r){var n=e.comparePoints(t.point,r.point);return 0!==n?n:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:F.compare(t.segment,r.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),r(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,r=0,n=e.length;r<n;r++){var i=e[r];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var r=this.point.events[e];if(void 0===r.segment.consumedBy)for(var n=e+1;n<t;n++){var i=this.point.events[n];void 0===i.consumedBy&&r.otherSE.point.events===i.otherSE.point.events&&r.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,r=this.point.events.length;e<r;e++){var n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,r=new Map,n=function(n){var i=n.otherSE;r.set(n,{sine:k(e.point,t.point,i.point),cosine:C(e.point,t.point,i.point)})};return function(t,e){r.has(t)||n(t),r.has(e)||n(e);var i=r.get(t),o=i.sine,s=i.cosine,a=r.get(e),u=a.sine,c=a.cosine;return o>=0&&u>=0?s<c?1:s>c?-1:0:o<0&&u<0?s<c?-1:s>c?1:0:u<o?-1:u>o?1:0}}}]),e}(),D=0,F=function(){function e(r,n,i,o){t(this,e),this.id=++D,this.leftSE=r,r.segment=this,r.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=r,this.rings=i,this.windings=o}return r(e,null,[{key:"compare",value:function(t,e){var r=t.leftSE.point.x,n=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<r)return 1;if(i<n)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,u=t.rightSE.point.y,c=e.rightSE.point.y;if(r<n){if(a<s&&a<u)return 1;if(a>s&&a>u)return-1;var l=t.comparePoint(e.leftSE.point);if(l<0)return 1;if(l>0)return-1;var h=e.comparePoint(t.rightSE.point);return 0!==h?h:-1}if(r>n){if(s<a&&s<c)return-1;if(s>a&&s>c)return 1;var f=e.comparePoint(t.leftSE.point);if(0!==f)return f;var d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(i<o){var p=e.comparePoint(t.rightSE.point);if(0!==p)return p}if(i>o){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(i!==o){var m=u-s,y=i-r,v=c-a,b=o-n;if(m>y&&v<b)return 1;if(m<y&&v>b)return-1}return i>o?1:i<o||u<c?-1:u>c?1:t.id<e.id?-1:t.id>e.id?1:0}}]),r(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,r=this.rightSE.point,n=this.vector();if(e.x===r.x)return t.x===e.x?0:t.x<e.x?1:-1;var i=(t.y-e.y)/n.y,o=e.x+i*n.x;if(t.x===o)return 0;var s=(t.x-e.x)/n.x,a=e.y+s*n.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),r=t.bbox(),n=b(e,r);if(null===n)return null;var i=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,u=v(e,s)&&0===this.comparePoint(s),c=v(r,i)&&0===t.comparePoint(i),l=v(e,a)&&0===this.comparePoint(a),h=v(r,o)&&0===t.comparePoint(o);if(c&&u)return h&&!l?o:!h&&l?a:null;if(c)return l&&i.x===a.x&&i.y===a.y?null:i;if(u)return h&&o.x===s.x&&o.y===s.y?null:s;if(h&&l)return null;if(h)return o;if(l)return a;var f=R(i,this.vector(),s,t.vector());return null===f?null:v(n,f)?M.round(f.x,f.y):null}},{key:"split",value:function(t){var r=[],n=void 0!==t.events,i=new L(t,!0),o=new L(t,!1),s=this.rightSE;this.replaceRightSE(o),r.push(o),r.push(i);var a=new e(i,s,this.rings.slice(),this.windings.slice());return L.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),L.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),o.checkForConsuming()),r}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,r=this.windings.length;e<r;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var r=this,n=t;r.consumedBy;)r=r.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var i=e.compare(r,n);if(0!==i){if(i>0){var o=r;r=n,n=o}if(r.prev===n){var s=r;r=n,n=s}for(var a=0,u=n.rings.length;a<u;a++){var c=n.rings[a],l=n.windings[a],h=r.rings.indexOf(c);-1===h?(r.rings.push(c),r.windings.push(l)):r.windings[h]+=l}n.rings=null,n.windings=null,n.consumedBy=r,n.leftSE.consumedBy=r.leftSE,n.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,r=this._afterState.windings,n=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var s=this.rings[i],a=this.windings[i],u=e.indexOf(s);-1===u?(e.push(s),r.push(a)):r[u]+=a}for(var c=[],l=[],h=0,f=e.length;h<f;h++)if(0!==r[h]){var d=e[h],p=d.poly;if(-1===l.indexOf(p))if(d.isExterior)c.push(p);else{-1===l.indexOf(p)&&l.push(p);var g=c.indexOf(d.poly);-1!==g&&c.splice(g,1)}}for(var m=0,y=c.length;m<y;m++){var v=c[m].multiPoly;-1===n.indexOf(v)&&n.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(X.type){case"union":var r=0===t.length,n=0===e.length;this._isInResult=r!==n;break;case"intersection":var i,o;t.length<e.length?(i=t.length,o=e.length):(i=e.length,o=t.length),this._isInResult=o===X.numMultiPolys&&i<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2===1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(X.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,r,n){var i,o,s,a=L.comparePoints(t,r);if(a<0)i=t,o=r,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));i=r,o=t,s=-1}return new e(new L(i,!0),new L(o,!1),[n],[s])}}]),e}(),N=function(){function e(r,n,i){if(t(this,e),!Array.isArray(r)||0===r.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=i,this.segments=[],"number"!==typeof r[0][0]||"number"!==typeof r[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=M.round(r[0][0],r[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,a=1,u=r.length;a<u;a++){if("number"!==typeof r[a][0]||"number"!==typeof r[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var c=M.round(r[a][0],r[a][1]);c.x===s.x&&c.y===s.y||(this.segments.push(F.fromRing(s,c,this)),c.x<this.bbox.ll.x&&(this.bbox.ll.x=c.x),c.y<this.bbox.ll.y&&(this.bbox.ll.y=c.y),c.x>this.bbox.ur.x&&(this.bbox.ur.x=c.x),c.y>this.bbox.ur.y&&(this.bbox.ur.y=c.y),s=c)}o.x===s.x&&o.y===s.y||this.segments.push(F.fromRing(s,o,this))}return r(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,r=this.segments.length;e<r;e++){var n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}]),e}(),B=function(){function e(r,n){if(t(this,e),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new N(r[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,o=r.length;i<o;i++){var s=new N(r[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}return r(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,r=this.interiorRings.length;e<r;e++)for(var n=this.interiorRings[e].getSweepEvents(),i=0,o=n.length;i<o;i++)t.push(n[i]);return t}}]),e}(),z=function(){function e(r,n){if(t(this,e),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"===typeof r[0][0][0]&&(r=[r])}catch(a){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,o=r.length;i<o;i++){var s=new B(r[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}return r(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,r=this.polys.length;e<r;e++)for(var n=this.polys[e].getSweepEvents(),i=0,o=n.length;i<o;i++)t.push(n[i]);return t}}]),e}(),U=function(){function e(r){t(this,e),this.events=r;for(var n=0,i=r.length;n<i;n++)r[n].segment.ringOut=this;this.poly=null}return r(e,null,[{key:"factory",value:function(t){for(var r=[],n=0,i=t.length;n<i;n++){var o=t[n];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,u=o.rightSE,c=[a],l=a.point,h=[];s=a,a=u,c.push(a),a.point!==l;)for(;;){var f=a.getAvailableLinkedEvents();if(0===f.length){var d=c[0].point,p=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(p.x,", ").concat(p.y,"]."))}if(1===f.length){u=f[0].otherSE;break}for(var g=null,m=0,y=h.length;m<y;m++)if(h[m].point===a.point){g=m;break}if(null===g){h.push({index:c.length,point:a.point});var v=a.getLeftmostComparator(s);u=f.sort(v)[0].otherSE;break}var b=h.splice(g)[0],_=c.splice(b.index);_.unshift(_[0].otherSE),r.push(new e(_.reverse()))}r.push(new e(c))}}return r}}]),r(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],r=1,n=this.events.length-1;r<n;r++){var i=this.events[r].point,o=this.events[r+1].point;0!==A(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;var s=e[0],a=e[1];0===A(s,t,a)&&e.shift(),e.push(e[0]);for(var u=this.isExteriorRing()?1:-1,c=this.isExteriorRing()?0:e.length-1,l=this.isExteriorRing()?e.length:-1,h=[],f=c;f!=l;f+=u)h.push([e[f].x,e[f].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,r=this.events.length;e<r;e++){var n=this.events[e];L.compare(t,n)>0&&(t=n)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=o.prevInResult(),o=i?i.prevInResult():null}}}]),e}(),V=function(){function e(r){t(this,e),this.exteriorRing=r,r.poly=this,this.interiorRings=[]}return r(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,r=this.interiorRings.length;e<r;e++){var n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}]),e}(),G=function(){function e(r){t(this,e),this.rings=r,this.polys=this._composePolys(r)}return r(e,[{key:"getGeom",value:function(){for(var t=[],e=0,r=this.polys.length;e<r;e++){var n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}},{key:"_composePolys",value:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];if(!i.poly)if(i.isExteriorRing())e.push(new V(i));else{var o=i.enclosingRing();o.poly||e.push(new V(o)),o.poly.addInterior(i)}}return e}}]),e}(),W=function(){function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F.compare;t(this,e),this.queue=r,this.tree=new h(n),this.segments=[]}return r(e,[{key:"process",value:function(t){var e=t.segment,r=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),r;var n=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!n)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=n,o=n,s=void 0,a=void 0;void 0===s;)null===(i=this.tree.prev(i))?s=null:void 0===i.key.consumedBy&&(s=i.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var u=null;if(s){var c=s.getIntersection(e);if(null!==c&&(e.isAnEndpoint(c)||(u=c),!s.isAnEndpoint(c)))for(var l=this._splitSafely(s,c),h=0,f=l.length;h<f;h++)r.push(l[h])}var d=null;if(a){var p=a.getIntersection(e);if(null!==p&&(e.isAnEndpoint(p)||(d=p),!a.isAnEndpoint(p)))for(var g=this._splitSafely(a,p),m=0,y=g.length;m<y;m++)r.push(g[m])}if(null!==u||null!==d){var v=null;v=null===u?d:null===d||L.comparePoints(u,d)<=0?u:d,this.queue.remove(e.rightSE),r.push(e.rightSE);for(var b=e.split(v),_=0,w=b.length;_<w;_++)r.push(b[_])}r.length>0?(this.tree.remove(e),r.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var x=s.getIntersection(a);if(null!==x){if(!s.isAnEndpoint(x))for(var E=this._splitSafely(s,x),P=0,M=E.length;P<M;P++)r.push(E[P]);if(!a.isAnEndpoint(x))for(var S=this._splitSafely(a,x),O=0,A=S.length;O<A;O++)r.push(S[O])}}this.tree.remove(e)}return r}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var r=t.rightSE;this.queue.remove(r);var n=t.split(e);return n.push(r),void 0===t.consumedBy&&this.tree.insert(t),n}}]),e}(),Z="undefined"!==typeof n&&n.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,$="undefined"!==typeof n&&n.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,X=new(function(){function e(){t(this,e)}return r(e,[{key:"run",value:function(t,e,r){X.type=t,M.reset();for(var n=[new z(e,!0)],i=0,o=r.length;i<o;i++)n.push(new z(r[i],!1));if(X.numMultiPolys=n.length,"difference"===X.type)for(var s=n[0],a=1;a<n.length;)null!==b(n[a].bbox,s.bbox)?a++:n.splice(a,1);if("intersection"===X.type)for(var u=0,c=n.length;u<c;u++)for(var l=n[u],f=u+1,d=n.length;f<d;f++)if(null===b(l.bbox,n[f].bbox))return[];for(var p=new h(L.compare),g=0,m=n.length;g<m;g++)for(var y=n[g].getSweepEvents(),v=0,_=y.length;v<_;v++)if(p.insert(y[v]),p.size>Z)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new W(p),x=p.size,E=p.pop();E;){var P=E.key;if(p.size===x){var S=P.segment;throw new Error("Unable to pop() ".concat(P.isLeft?"left":"right"," SweepEvent ")+"[".concat(P.point.x,", ").concat(P.point.y,"] from segment #").concat(S.id," ")+"[".concat(S.leftSE.point.x,", ").concat(S.leftSE.point.y,"] -> ")+"[".concat(S.rightSE.point.x,", ").concat(S.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(p.size>Z)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>$)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var O=w.process(P),A=0,T=O.length;A<T;A++){var k=O[A];void 0===k.consumedBy&&p.insert(k)}x=p.size,E=p.pop()}M.reset();var C=U.factory(w.segments);return new G(C).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return X.run("union",t,r)},intersection:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return X.run("intersection",t,r)},xor:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return X.run("xor",t,r)},difference:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return X.run("difference",t,r)}}}()},4155:function(t){var e,r,n=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"===typeof setTimeout?setTimeout:i}catch(t){e=i}try{r="function"===typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var a,u=[],c=!1,l=-1;function h(){c&&a&&(c=!1,a.length?u=a.concat(u):l=-1,u.length&&f())}function f(){if(!c){var t=s(h);c=!0;for(var e=u.length;e;){for(a=u,u=[];++l<e;)a&&a[l].run();l=-1,e=u.length}a=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new d(t,e)),1!==u.length||c||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},5510:function(t,e,r){"use strict";t.exports=i,t.exports.default=i;var n=r(4291);function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,r,n,i){i||(i=m(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,s=e;s<r;s++)o=t.children[s],u(i,t.leaf?n(o):o);return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){var r=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-r)*Math.max(0,o-n)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function g(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(t,e,r,i,o){for(var s,a=[e,r];a.length;)(r=a.pop())-(e=a.pop())<=i||(s=e+Math.ceil((r-e)/i/2)*i,n(t,s,e,r,o),a.push(e,s,s,r))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],n=this.toBBox;if(!g(t,e))return r;for(var i,o,s,a,u=[];e;){for(i=0,o=e.children.length;i<o;i++)s=e.children[i],g(t,a=e.leaf?n(s):s)&&(e.leaf?r.push(s):p(t,a)?this._all(s,r):u.push(s));e=u.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!g(t,e))return!1;for(var n,i,o,s,a=[];e;){for(n=0,i=e.children.length;n<i;n++)if(o=e.children[n],g(t,s=e.leaf?r(o):o)){if(e.leaf||p(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(!t)return this;for(var r,n,i,s,a=this.data,u=this.toBBox(t),c=[],l=[];a||c.length;){if(a||(a=c.pop(),n=c[c.length-1],r=l.pop(),s=!0),a.leaf&&-1!==(i=o(t,a.children,e)))return a.children.splice(i,1),c.push(a),this._condense(c),this;s||a.leaf||!p(a,u)?n?(r++,a=n.children[r],s=!1):a=null:(c.push(a),l.push(r),r=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:c,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,n){var i,o=r-e+1,a=this._maxEntries;if(o<=a)return s(i=m(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(i=m([])).leaf=!1,i.height=n;var u,c,l,h,f=Math.ceil(o/a),d=f*Math.ceil(Math.sqrt(a));for(y(t,e,r,d,this.compareMinX),u=e;u<=r;u+=d)for(y(t,u,l=Math.min(u+d-1,r),f,this.compareMinY),c=u;c<=l;c+=f)h=Math.min(c+f-1,l),i.children.push(this._build(t,c,h,n-1));return s(i,this.toBBox),i},_chooseSubtree:function(t,e,r,n){for(var i,o,s,a,u,c,l,f,d,p;n.push(e),!e.leaf&&n.length-1!==r;){for(l=f=1/0,i=0,o=e.children.length;i<o;i++)u=h(s=e.children[i]),d=t,p=s,(c=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-u)<f?(f=c,l=u<l?u:l,a=s):c===f&&u<l&&(l=u,a=s);e=a||e.children[0]}return e},_insert:function(t,e,r){var n=this.toBBox,i=r?t:n(t),o=[],s=this._chooseSubtree(i,this.data,e,o);for(s.children.push(t),u(s,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var o=this._chooseSplitIndex(r,i,n),a=m(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,s(r,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},_splitRoot:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var n,i,o,s,u,c,l,f;for(c=l=1/0,n=e;n<=r-e;n++)s=d(i=a(t,0,n,this.toBBox),o=a(t,n,r,this.toBBox)),u=h(i)+h(o),s<c?(c=s,f=n,l=u<l?u:l):s===c&&u<l&&(l=u,f=n);return f},_chooseSplitAxis:function(t,e,r){var n=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},_allDistMargin:function(t,e,r,n){t.children.sort(n);var i,o,s=this.toBBox,c=a(t,0,e,s),l=a(t,r-e,r,s),h=f(c)+f(l);for(i=e;i<r-e;i++)o=t.children[i],u(c,t.leaf?s(o):o),h+=f(c);for(i=r-e-1;i>=e;i--)o=t.children[i],u(l,t.leaf?s(o):o),h+=f(l);return h},_adjustParentBBoxes:function(t,e,r){for(var n=r;n>=0;n--)u(e[n],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)0===t[r].children.length?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():s(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},4291:function(t){t.exports=function(){"use strict";function t(t,r,i,o,s){e(t,r,i||0,o||t.length-1,s||n)}function e(t,n,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,u=n-i+1,c=Math.log(a),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(a-l)/a)*(u-a/2<0?-1:1);e(t,n,Math.max(i,Math.floor(n-u*l/a+h)),Math.min(o,Math.floor(n+(a-u)*l/a+h)),s)}var f=t[n],d=i,p=o;for(r(t,i,n),s(t[o],f)>0&&r(t,i,o);d<p;){for(r(t,d,p),d++,p--;s(t[d],f)<0;)d++;for(;s(t[p],f)>0;)p--}0===s(t[i],f)?r(t,i,p):r(t,++p,o),p<=n&&(i=p+1),n<=p&&(o=p-1)}}function r(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function n(t,e){return t<e?-1:t>e?1:0}return t}()},9921:function(t,e){"use strict";var r="function"===typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,a=r?Symbol.for("react.profiler"):60114,u=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,l=r?Symbol.for("react.async_mode"):60111,h=r?Symbol.for("react.concurrent_mode"):60111,f=r?Symbol.for("react.forward_ref"):60112,d=r?Symbol.for("react.suspense"):60113,p=r?Symbol.for("react.suspense_list"):60120,g=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,y=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,b=r?Symbol.for("react.responder"):60118,_=r?Symbol.for("react.scope"):60119;function w(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case n:switch(t=t.type){case l:case h:case o:case a:case s:case d:return t;default:switch(t=t&&t.$$typeof){case c:case f:case m:case g:case u:return t;default:return e}}case i:return e}}}function x(t){return w(t)===h}e.AsyncMode=l,e.ConcurrentMode=h,e.ContextConsumer=c,e.ContextProvider=u,e.Element=n,e.ForwardRef=f,e.Fragment=o,e.Lazy=m,e.Memo=g,e.Portal=i,e.Profiler=a,e.StrictMode=s,e.Suspense=d,e.isAsyncMode=function(t){return x(t)||w(t)===l},e.isConcurrentMode=x,e.isContextConsumer=function(t){return w(t)===c},e.isContextProvider=function(t){return w(t)===u},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===n},e.isForwardRef=function(t){return w(t)===f},e.isFragment=function(t){return w(t)===o},e.isLazy=function(t){return w(t)===m},e.isMemo=function(t){return w(t)===g},e.isPortal=function(t){return w(t)===i},e.isProfiler=function(t){return w(t)===a},e.isStrictMode=function(t){return w(t)===s},e.isSuspense=function(t){return w(t)===d},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===o||t===h||t===a||t===s||t===d||t===p||"object"===typeof t&&null!==t&&(t.$$typeof===m||t.$$typeof===g||t.$$typeof===u||t.$$typeof===c||t.$$typeof===f||t.$$typeof===v||t.$$typeof===b||t.$$typeof===_||t.$$typeof===y)},e.typeOf=w},9864:function(t,e,r){"use strict";t.exports=r(9921)},8782:function(t,e,r){"use strict";function n(){return(n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){if(t){if("string"===typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}function s(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(e,{mh:function(){return Ze},Hw:function(){return Fe},ZP:function(){return ke}});var a=r(4942),u=r(7294),c=r(1581);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(t);!(s=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);s=!0);}catch(u){a=!0,i=u}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=r(7682),f=function(){if("undefined"!==typeof Map)return Map;function t(t,e){var r=-1;return t.some((function(t,n){return t[0]===e&&(r=n,!0)})),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var r=t(this.__entries__,e),n=this.__entries__[r];return n&&n[1]},e.prototype.set=function(e,r){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=r:this.__entries__.push([e,r])},e.prototype.delete=function(e){var r=this.__entries__,n=t(r,e);~n&&r.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var r=0,n=this.__entries__;r<n.length;r++){var i=n[r];t.call(e,i[1],i[0])}},e}()}(),d="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,p="undefined"!==typeof r.g&&r.g.Math===Math?r.g:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),g="function"===typeof requestAnimationFrame?requestAnimationFrame.bind(p):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var m=["top","right","bottom","left","width","height","size","weight"],y="undefined"!==typeof MutationObserver,v=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var r=!1,n=!1,i=0;function o(){r&&(r=!1,t()),n&&a()}function s(){g(o)}function a(){var t=Date.now();if(r){if(t-i<2)return;n=!0}else r=!0,n=!1,setTimeout(s,e);i=t}return a}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,r=e.indexOf(t);~r&&e.splice(r,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){d&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),y?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){d&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,r=void 0===e?"":e;m.some((function(t){return!!~r.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),b=function(t,e){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},_=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||p},w=O(0,0,0,0);function x(t){return parseFloat(t)||0}function E(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.reduce((function(e,r){return e+x(t["border-"+r+"-width"])}),0)}function P(t){var e=t.clientWidth,r=t.clientHeight;if(!e&&!r)return w;var n=_(t).getComputedStyle(t),i=function(t){for(var e={},r=0,n=["top","right","bottom","left"];r<n.length;r++){var i=n[r],o=t["padding-"+i];e[i]=x(o)}return e}(n),o=i.left+i.right,s=i.top+i.bottom,a=x(n.width),u=x(n.height);if("border-box"===n.boxSizing&&(Math.round(a+o)!==e&&(a-=E(n,"left","right")+o),Math.round(u+s)!==r&&(u-=E(n,"top","bottom")+s)),!function(t){return t===_(t).document.documentElement}(t)){var c=Math.round(a+o)-e,l=Math.round(u+s)-r;1!==Math.abs(c)&&(a-=c),1!==Math.abs(l)&&(u-=l)}return O(i.left,i.top,a,u)}var M="undefined"!==typeof SVGGraphicsElement?function(t){return t instanceof _(t).SVGGraphicsElement}:function(t){return t instanceof _(t).SVGElement&&"function"===typeof t.getBBox};function S(t){return d?M(t)?function(t){var e=t.getBBox();return O(0,0,e.width,e.height)}(t):P(t):w}function O(t,e,r,n){return{x:t,y:e,width:r,height:n}}var A=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=O(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=S(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),T=function(t,e){var r=function(t){var e=t.x,r=t.y,n=t.width,i=t.height,o="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return b(s,{x:e,y:r,width:n,height:i,top:r,right:e+n,bottom:i+r,left:e}),s}(e);b(this,{target:t,contentRect:r})},k=function(){function t(t,e,r){if(this.activeObservations_=[],this.observations_=new f,"function"!==typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=r}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(t instanceof _(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new A(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(t instanceof _(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new T(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),C="undefined"!==typeof WeakMap?new WeakMap:new f,j=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=v.getInstance(),n=new k(e,r,this);C.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){j.prototype[t]=function(){var e;return(e=C.get(this))[t].apply(e,arguments)}}));var I="undefined"!==typeof p.ResizeObserver?p.ResizeObserver:j;function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function D(t,e,r){return e&&L(t.prototype,e),r&&L(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}"undefined"!==typeof window?window:r.g,"undefined"!==typeof r.g?r.g:window;var F="undefined"!==typeof document?document:{};function N(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function B(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?N(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function z(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"===typeof t)return U(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(t,e)}(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var V=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function G(t){if(!t)return null;if("string"===typeof t)return t;t.toJS&&(t=t.toJS());var e,r={},n=z(t.layers);try{for(n.s();!(e=n.n()).done;){var i=e.value;r[i.id]=i}}catch(s){n.e(s)}finally{n.f()}var o=t.layers.map((function(t){var e=r[t.ref],n=null;if("interactive"in t&&delete(n=B({},t)).interactive,e){delete(n=n||B({},t)).ref;var i,o=z(V);try{for(o.s();!(i=o.n()).done;){var a=i.value;a in e&&(n[a]=e[a])}}catch(s){o.e(s)}finally{o.f()}}return n||t}));return B(B({},t),{},{layers:o})}var W=r(4155);var Z={container:c.object,gl:c.object,mapboxApiAccessToken:c.string,mapboxApiUrl:c.string,attributionControl:c.bool,preserveDrawingBuffer:c.bool,reuseMaps:c.bool,transformRequest:c.func,mapOptions:c.object,mapStyle:c.oneOfType([c.string,c.object]),preventStyleDiffing:c.bool,visible:c.bool,asyncRender:c.bool,onLoad:c.func,onError:c.func,width:c.number,height:c.number,viewState:c.object,longitude:c.number,latitude:c.number,zoom:c.number,bearing:c.number,pitch:c.number,altitude:c.number},$={container:F.body,mapboxApiAccessToken:function(){var t=null;if("undefined"!==typeof window&&window.location){var e=window.location.search.match(/access_token=([^&\/]*)/);t=e&&e[1]}t||"undefined"===typeof W||(t=t||W.env.MapboxAccessToken||W.env.REACT_APP_MAPBOX_ACCESS_TOKEN);return t||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function X(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&c.checkPropTypes(Z,t,"prop",e)}var Y=function(){function t(e){var r=this;if(R(this,t),(0,a.Z)(this,"props",$),(0,a.Z)(this,"width",0),(0,a.Z)(this,"height",0),(0,a.Z)(this,"_fireLoadEvent",(function(){r.props.onLoad({type:"load",target:r._map})})),(0,a.Z)(this,"_handleError",(function(t){r.props.onError(t)})),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}return D(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"redraw",value:function(){var t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(e){this._map=t.savedMap;var r=this._map.getContainer(),n=e.container;for(n.classList.add("mapboxgl-map");r.childNodes.length>0;)n.appendChild(r.childNodes[0]);this._map._container=n,t.savedMap=null,e.mapStyle&&this._map.setStyle(G(e.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap)this._reuse(e);else{if(e.gl){var r=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=r,e.gl}}var n={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:G(e.mapStyle),interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(n.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},n,e.mapOptions)),this._map.once("load",this._fireLoadEvent),this._map.on("error",this._handleError)}return this}},{key:"_destroy",value:function(){this._map&&(this.props.reuseMaps&&!t.savedMap?(t.savedMap=this._map,this._map.off("load",this._fireLoadEvent),this._map.off("error",this._handleError),this._map.off("styledata",this._fireLoadEvent)):this._map.remove(),this._map=null)}},{key:"_initialize",value:function(t){var e=this;X(t=Object.assign({},$,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||$.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);var r=t.container;Object.defineProperty(r,"offsetWidth",{get:function(){return e.width}}),Object.defineProperty(r,"clientWidth",{get:function(){return e.width}}),Object.defineProperty(r,"offsetHeight",{get:function(){return e.height}}),Object.defineProperty(r,"clientHeight",{get:function(){return e.height}});var n=this._map.getCanvas();n&&(n.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){if(this._map){X(e=Object.assign({},this.props,e),"Mapbox");var r=this._updateMapViewport(t,e),n=this._updateMapSize(t,e);this._updateMapStyle(t,e),e.asyncRender||!r&&!n||this.redraw(),this.props=e}}},{key:"_updateMapStyle",value:function(t,e){t.mapStyle!==e.mapStyle&&this._map.setStyle(G(e.mapStyle),{diff:!e.preventStyleDiffing})}},{key:"_updateMapSize",value:function(t,e){var r=t.width!==e.width||t.height!==e.height;return r&&(this.width=e.width,this.height=e.height,this._map.resize()),r}},{key:"_updateMapViewport",value:function(t,e){var r=this._getViewState(t),n=this._getViewState(e),i=n.latitude!==r.latitude||n.longitude!==r.longitude||n.zoom!==r.zoom||n.pitch!==r.pitch||n.bearing!==r.bearing||n.altitude!==r.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(n)),n.altitude!==r.altitude&&(this._map.transform.altitude=n.altitude)),i}},{key:"_getViewState",value:function(t){var e=t.viewState||t,r=e.longitude,n=e.latitude,i=e.zoom,o=e.pitch,s=void 0===o?0:o,a=e.bearing,u=void 0===a?0:a,c=e.altitude;return{longitude:r,latitude:n,zoom:i,pitch:s,bearing:u,altitude:void 0===c?1.5:c}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if("undefined"!==typeof F)try{var e=F.createElement("div");e.className="mapboxgl-map",e.style.display="none",F.body.appendChild(e);var r="static"!==window.getComputedStyle(e).position;if(!r){var n=F.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),F.head.appendChild(n)}}catch(i){}}},{key:"_viewStateToMapboxProps",value:function(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}]),t}();(0,a.Z)(Y,"initialized",!1),(0,a.Z)(Y,"propTypes",Z),(0,a.Z)(Y,"defaultProps",$),(0,a.Z)(Y,"savedMap",null);var H=r(6158),q=r.n(H);function K(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Q(t,e){if(t===e)return!0;if(K(t)&&K(e)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;++r)if(!Q(t[r],e[r]))return!1;return!0}return Math.abs(t-e)<=1e-7}function J(t,e,r){return Math.max(e,Math.min(r,t))}function tt(t,e,r){return K(t)?t.map((function(t,n){return tt(t,e[n],r)})):r*e+(1-r)*t}function et(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}function rt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function nt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var it={minZoom:0,maxZoom:24,minPitch:0,maxPitch:85},ot=0,st=0,at=1.5,ut=function(){function t(e){var r=e.width,n=e.height,i=e.latitude,o=e.longitude,s=e.zoom,a=e.bearing,u=void 0===a?st:a,c=e.pitch,l=void 0===c?ot:c,h=e.altitude,f=void 0===h?at:h,d=e.maxZoom,p=void 0===d?it.maxZoom:d,g=e.minZoom,m=void 0===g?it.minZoom:g,y=e.maxPitch,v=void 0===y?it.maxPitch:y,b=e.minPitch,_=void 0===b?it.minPitch:b,w=e.transitionDuration,x=e.transitionEasing,E=e.transitionInterpolator,P=e.transitionInterruption,M=e.startPanLngLat,S=e.startZoomLngLat,O=e.startRotatePos,A=e.startBearing,T=e.startPitch,k=e.startZoom;R(this,t),et(Number.isFinite(r),"`width` must be supplied"),et(Number.isFinite(n),"`height` must be supplied"),et(Number.isFinite(o),"`longitude` must be supplied"),et(Number.isFinite(i),"`latitude` must be supplied"),et(Number.isFinite(s),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:r,height:n,latitude:i,longitude:o,zoom:s,bearing:u,pitch:l,altitude:f,maxZoom:p,minZoom:m,maxPitch:v,minPitch:_,transitionDuration:w,transitionEasing:x,transitionInterpolator:E,transitionInterruption:P}),this._state={startPanLngLat:M,startZoomLngLat:S,startRotatePos:O,startBearing:A,startPitch:T,startZoom:k}}return D(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,r=t.startPos,n=this._state.startPanLngLat||this._unproject(r);if(!n)return this;var i=l(this._calculateNewLngLat({startPanLngLat:n,pos:e}),2),o=i[0],s=i[1];return this._getUpdatedMapState({longitude:o,latitude:s})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e,r=t.pos,n=t.deltaAngleX,i=void 0===n?0:n,o=t.deltaAngleY,s=void 0===o?0:o,a=this._state,u=a.startRotatePos,c=a.startBearing,l=a.startPitch;return Number.isFinite(c)&&Number.isFinite(l)?(e=r?this._calculateNewPitchAndBearing(nt(nt({},this._getRotationParams(r,u)),{},{startBearing:c,startPitch:l})):{bearing:c+i,pitch:l+s},this._getUpdatedMapState(e)):this}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,r=t.startPos,n=t.scale;et(n>0,"`scale` must be a positive number");var i=this._state,o=i.startZoom,s=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,s=this._unproject(r)||this._unproject(e)),et(s,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var a=this._calculateNewZoom({scale:n,startZoom:o||0}),u=l(new h.DW(Object.assign({},this._viewportProps,{zoom:a})).getMapCenterByLngLatPosition({lngLat:s,pos:e}),2),c=u[0],f=u[1];return this._getUpdatedMapState({zoom:a,longitude:c,latitude:f})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(e){return new t(Object.assign({},this._viewportProps,this._state,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,r=t.minZoom,n=t.zoom;t.zoom=J(n,r,e);var i=t.maxPitch,o=t.minPitch,s=t.pitch;return t.pitch=J(s,o,i),Object.assign(t,(0,h.QA)(t)),t}},{key:"_unproject",value:function(t){var e=new h.DW(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,r=t.pos;return new h.DW(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:r})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,r=t.startZoom,n=this._viewportProps,i=n.maxZoom,o=n.minZoom;return J(r+Math.log2(e),o,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,r=t.deltaScaleY,n=t.startBearing,i=t.startPitch;r=J(r,-1,1);var o=this._viewportProps,s=o.minPitch,a=o.maxPitch,u=i;return r>0?u=i+r*(a-i):r<0&&(u=i-r*(s-i)),{pitch:u,bearing:n+180*e}}},{key:"_getRotationParams",value:function(t,e){var r=t[0]-e[0],n=t[1]-e[1],i=t[1],o=e[1],s=this._viewportProps,a=s.width,u=s.height,c=r/a,l=0;return n>0?Math.abs(u-o)>5&&(l=n/(o-u)*1.2):n<0&&o>5&&(l=1-i/o),{deltaScaleX:c,deltaScaleY:l=Math.min(1,Math.max(-1,l))}}}]),t}();function ct(t){return t[0].toLowerCase()+t.slice(1)}function lt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ht(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var ft=(0,u.createContext)({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),dt=ft.Provider;ft.Provider=function(t){var e=t.value,r=t.children,n=l((0,u.useState)(null),2),i=n[0],o=n[1],s=(0,u.useContext)(ft);return e=ht(ht({setMap:o},s),{},{map:s&&s.map||i},e),u.createElement(dt,{value:e},r)};var pt=ft,gt="undefined"!==typeof window?u.useLayoutEffect:u.useEffect;function mt(t,e){var r=e.longitude,n=e.latitude;return t&&t.queryTerrainElevation&&t.queryTerrainElevation([r,n])||0}function yt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function vt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?yt(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var bt="A valid API access token is required to use Mapbox data";function _t(t){var e=t.map,r=t.props,n=t.width,i=t.height,o=vt(vt(vt({},r),r.viewState),{},{width:n,height:i});return o.position=[0,0,mt(e,o)],new h.DW(o)}var wt={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},xt=Object.assign({},Y.propTypes,{width:c.oneOfType([c.number,c.string]),height:c.oneOfType([c.number,c.string]),onResize:c.func,disableTokenWarning:c.bool,visible:c.bool,className:c.string,style:c.object,visibilityConstraints:c.object}),Et=Object.assign({},Y.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:it});function Pt(){return u.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},u.createElement("h3",{key:"header"},bt),u.createElement("div",{key:"text"},"For information on setting up your basemap, read"),u.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}var Mt=(0,u.forwardRef)((function(t,e){var r=l((0,u.useState)(!0),2),n=r[0],i=r[1],o=l((0,u.useState)({width:0,height:0}),2),s=o[0],a=o[1],c=(0,u.useRef)(null),h=(0,u.useRef)(null),f=(0,u.useRef)(null),d=(0,u.useRef)(null),p=(0,u.useContext)(pt);gt((function(){if(Mt.supported()){var e=new Y(vt(vt(vt({},t),s),{},{mapboxgl:q(),container:h.current,onError:function(e){401===(e.error&&e.error.status||e.status)&&n&&(console.error(bt),i(!1)),t.onError(e)}}));c.current=e,p&&p.setMap&&p.setMap(e.getMap());var r=new I((function(e){if(e[0].contentRect){var r=e[0].contentRect,n=r.width,i=r.height;a({width:n,height:i}),t.onResize({width:n,height:i})}}));return r.observe(f.current),function(){e.finalize(),c.current=null,r.disconnect()}}}),[]),gt((function(){c.current&&c.current.setProps(vt(vt({},t),s))}));var g=c.current&&c.current.getMap();(0,u.useImperativeHandle)(e,(function(){return function(t){return{getMap:function(){return t.current&&t.current.getMap()},queryRenderedFeatures:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.current&&t.current.getMap();return n&&n.queryRenderedFeatures(e,r)}}}(c)}),[]);var m=(0,u.useCallback)((function(t){var e=t.target;e===d.current&&e.scrollTo(0,0)}),[]),y=g&&u.createElement(dt,{value:vt(vt({},p),{},{viewport:p.viewport||_t(vt({map:g,props:t},s)),map:g,container:p.container||f.current})},u.createElement("div",{key:"map-overlays",className:"overlays",ref:d,style:wt,onScroll:m},t.children)),v=t.className,b=t.width,_=t.height,w=t.style,x=t.visibilityConstraints,E=Object.assign({position:"relative"},w,{width:b,height:_}),P=t.visible&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:it;for(var r in e){var n=r.slice(0,3),i=ct(r.slice(3));if("min"===n&&t[i]<e[r])return!1;if("max"===n&&t[i]>e[r])return!1}return!0}(t.viewState||t,x),M=Object.assign({},wt,{visibility:P?"inherit":"hidden"});return u.createElement("div",{key:"map-container",ref:f,style:E},u.createElement("div",{key:"map-mapbox",ref:h,style:M,className:v}),y,!n&&!t.disableTokenWarning&&u.createElement(Pt,null))}));Mt.supported=function(){return q()&&q().supported()},Mt.propTypes=xt,Mt.defaultProps=Et;var St=Mt;function Ot(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"===typeof t)return At(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return At(t,e)}(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Tt=function(){function t(){R(this,t),(0,a.Z)(this,"propNames",[])}return D(t,[{key:"arePropsEqual",value:function(t,e){var r,n=Ot(this.propNames||[]);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(!Q(t[i],e[i]))return!1}}catch(o){n.e(o)}finally{n.f()}return!0}},{key:"initializeProps",value:function(t,e){return{start:t,end:e}}},{key:"interpolateProps",value:function(t,e,r){et(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(t,e){return e.transitionDuration}}]),t}();function kt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ct(t,e){return(Ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function jt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ct(t,e)}function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){if(e&&("object"===It(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return kt(t)}function Lt(t){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dt={longitude:1,bearing:1};function Ft(t){return Number.isFinite(t)||Array.isArray(t)}function Nt(t,e,r){return function(t){return t in Dt}(t)&&Math.abs(r-e)>180&&(r=r<0?r+360:r-360),r}function Bt(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"===typeof t)return zt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zt(t,e)}(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ut(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Lt(t);if(e){var i=Lt(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Rt(this,r)}}var Vt=["longitude","latitude","zoom","bearing","pitch"],Gt=["latitude","longitude","zoom","width","height"],Wt=["bearing","pitch"],Zt={speed:1.2,curve:1.414};!function(t){jt(r,t);var e=Ut(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return R(this,r),t=e.call(this),(0,a.Z)(kt(t),"propNames",Vt),t.props=Object.assign({},Zt,n),t}D(r,[{key:"initializeProps",value:function(t,e){var r,n={},i={},o=Bt(Gt);try{for(o.s();!(r=o.n()).done;){var s=r.value,a=t[s],u=e[s];et(Ft(a)&&Ft(u),"".concat(s," must be supplied for transition")),n[s]=a,i[s]=Nt(s,a,u)}}catch(p){o.e(p)}finally{o.f()}var c,l=Bt(Wt);try{for(l.s();!(c=l.n()).done;){var h=c.value,f=t[h]||0,d=e[h]||0;n[h]=f,i[h]=Nt(h,f,d)}}catch(p){l.e(p)}finally{l.f()}return{start:n,end:i}}},{key:"interpolateProps",value:function(t,e,r){var n,i=(0,h.if)(t,e,r,this.props),o=Bt(Wt);try{for(o.s();!(n=o.n()).done;){var s=n.value;i[s]=tt(t[s],e[s],r)}}catch(a){o.e(a)}finally{o.f()}return i}},{key:"getDuration",value:function(t,e){var r=e.transitionDuration;return"auto"===r&&(r=(0,h.up)(t,e,this.props)),r}}])}(Tt);function $t(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"===typeof t)return Xt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xt(t,e)}(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function Xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Yt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Lt(t);if(e){var i=Lt(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Rt(this,r)}}var Ht=["longitude","latitude","zoom","bearing","pitch"],qt=function(t){jt(r,t);var e=Yt(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return R(this,r),t=e.call(this),Array.isArray(n)&&(n={transitionProps:n}),t.propNames=n.transitionProps||Ht,n.around&&(t.around=n.around),t}return D(r,[{key:"initializeProps",value:function(t,e){var r={},n={};if(this.around){r.around=this.around;var i=new h.DW(t).unproject(this.around);Object.assign(n,e,{around:new h.DW(e).project(i),aroundLngLat:i})}var o,s=$t(this.propNames);try{for(s.s();!(o=s.n()).done;){var a=o.value,u=t[a],c=e[a];et(Ft(u)&&Ft(c),"".concat(a," must be supplied for transition")),r[a]=u,n[a]=Nt(a,u,c)}}catch(l){s.e(l)}finally{s.f()}return{start:r,end:n}}},{key:"interpolateProps",value:function(t,e,r){var n,i={},o=$t(this.propNames);try{for(o.s();!(n=o.n()).done;){var s=n.value;i[s]=tt(t[s],e[s],r)}}catch(f){o.e(f)}finally{o.f()}if(e.around){var a=l(new h.DW(Object.assign({},e,i)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:tt(t.around,e.around,r)}),2),u=a[0],c=a[1];i.longitude=u,i.latitude=c}return i}}]),r}(Tt),Kt=function(){};var Qt=1,Jt=2,te=3,ee=4,re={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new qt,transitionInterruption:Qt,onTransitionStart:Kt,onTransitionInterrupt:Kt,onTransitionEnd:Kt},ne=function(){function t(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(this,t),(0,a.Z)(this,"_animationFrame",null),(0,a.Z)(this,"_onTransitionFrame",(function(){e._animationFrame=requestAnimationFrame(e._onTransitionFrame),e._updateViewport()})),this.props=null,this.onViewportChange=r.onViewportChange||Kt,this.onStateChange=r.onStateChange||Kt,this.time=r.getTime||Date.now}return D(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(t){var e=this.props;if(this.props=t,!e||this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){var r=Object.assign({},e),n=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this.state.interruption===Jt?Object.assign(r,this.state.endProps):Object.assign(r,this.state.propsInTransition),this.state.interruption===ee)){var i=this.time(),o=(i-this.state.startTime)/this.state.duration;n.transitionDuration=this.state.duration-(i-this.state.startTime),n.transitionEasing=function(t,e){var r=t(e);return function(n){return 1/(1-r)*(t(n*(1-e)+e)-r)}}(this.state.easing,o),n.transitionInterpolator=r.transitionInterpolator}return n.onTransitionStart(),this._triggerTransition(r,n),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(t){var e=t.transitionDuration,r=t.transitionInterpolator;return(e>0||"auto"===e)&&Boolean(r)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return!t||(this._isTransitionInProgress()?this.state.interruption===te||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}},{key:"_triggerTransition",value:function(t,e){et(this._isTransitionEnabled(e)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var r=e.transitionInterpolator,n=r.getDuration?r.getDuration(t,e):e.transitionDuration;if(0!==n){var i=e.transitionInterpolator.initializeProps(t,e),o={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:n,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(o)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var t=this.time(),e=this.state,r=e.startTime,n=e.duration,i=e.easing,o=e.interpolator,s=e.startProps,a=e.endProps,u=!1,c=(t-r)/n;c>=1&&(c=1,u=!0),c=i(c);var l=o.interpolateProps(s,a,c),h=new ut(Object.assign({},this.props,l));this.state.propsInTransition=h.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),u&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();(0,a.Z)(ne,"defaultProps",re);var ie=r(2317);function oe(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function se(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?oe(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var ae={transitionDuration:0},ue={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new qt,transitionInterruption:Qt},ce=300,le=function(t){return 1-(1-t)*(1-t)},he=["wheel"],fe=["panstart","panmove","panend"],de=["pinchstart","pinchmove","pinchend"],pe=["tripanstart","tripanmove","tripanend"],ge=["doubletap"],me=["keydown"],ye=function(){function t(){var e=this;R(this,t),(0,a.Z)(this,"events",[]),(0,a.Z)(this,"scrollZoom",!0),(0,a.Z)(this,"dragPan",!0),(0,a.Z)(this,"dragRotate",!0),(0,a.Z)(this,"doubleClickZoom",!0),(0,a.Z)(this,"touchZoom",!0),(0,a.Z)(this,"touchRotate",!1),(0,a.Z)(this,"keyboard",!0),(0,a.Z)(this,"_interactionState",{isDragging:!1}),(0,a.Z)(this,"_events",{}),(0,a.Z)(this,"_setInteractionState",(function(t){Object.assign(e._interactionState,t),e.onStateChange&&e.onStateChange(e._interactionState)})),(0,a.Z)(this,"_onTransition",(function(t,r){e.onViewportChange(t,e._interactionState,r)})),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new ne({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return D(t,[{key:"handleEvent",value:function(t){this.mapState=this.getMapState();var e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"blockEvents",value:function(t){var e=this,r=setTimeout((function(){e._eventStartBlocked===r&&(e._eventStartBlocked=null)}),t);this._eventStartBlocked=r}},{key:"updateViewport",value:function(t,e,r){var n=this.mapState instanceof ut?this.mapState.getViewportProps():this.mapState,i=se(se({},t.getViewportProps()),e),o=Object.keys(i).some((function(t){return n[t]!==i[t]}));this._state=t.getState(),this._setInteractionState(r),o&&this.onViewportChange(i,this._interactionState,n)}},{key:"getMapState",value:function(t){return new ut(se(se(se({},this.mapStateProps),this._state),t))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(t){var e=t.onViewportChange,r=t.onStateChange,n=t.eventManager,i=void 0===n?this.eventManager:n,o=t.isInteractive,s=void 0===o||o,a=t.scrollZoom,u=void 0===a?this.scrollZoom:a,c=t.dragPan,l=void 0===c?this.dragPan:c,h=t.dragRotate,f=void 0===h?this.dragRotate:h,d=t.doubleClickZoom,p=void 0===d?this.doubleClickZoom:d,g=t.touchZoom,m=void 0===g?this.touchZoom:g,y=t.touchRotate,v=void 0===y?this.touchRotate:y,b=t.keyboard,_=void 0===b?this.keyboard:b;this.onViewportChange=e,this.onStateChange=r;var w=this.mapStateProps||{},x=w.height!==t.height||w.width!==t.width;this.mapStateProps=t,x&&(this.mapState=w,this.updateViewport(new ut(t))),this._transitionManager.processViewportChange(t),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(he,s&&Boolean(u)),this.toggleEvents(fe,s&&Boolean(l||f)),this.toggleEvents(de,s&&Boolean(m||v)),this.toggleEvents(pe,s&&Boolean(v)),this.toggleEvents(ge,s&&Boolean(p)),this.toggleEvents(me,s&&Boolean(_)),this.scrollZoom=u,this.dragPan=l,this.dragRotate=f,this.doubleClickZoom=p,this.touchZoom=m,this.touchRotate=v,this.keyboard=_}},{key:"toggleEvents",value:function(t,e){var r=this;this.eventManager&&t.forEach((function(t){r._events[t]!==e&&(r._events[t]=e,e?r.eventManager.on(t,r.handleEvent):r.eventManager.off(t,r.handleEvent))}))}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t);this._panRotate=this.isFunctionKeyPressed(t)||t.rightButton;var r=this._panRotate?this.mapState.rotateStart({pos:e}):this.mapState.panStart({pos:e});return this.updateViewport(r,ae,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotate(t):this._onPanMove(t))}},{key:"_onPanEnd",value:function(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotateEnd(t):this._onPanMoveEnd(t))}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),r=this.mapState.pan({pos:e});return this.updateViewport(r,ae,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(t){if(this.dragPan){var e=this.dragPan.inertia,r=void 0===e?ce:e;if(r&&t.velocity){var n=this.getCenter(t),i=[n[0]+t.velocityX*r/2,n[1]+t.velocityY*r/2],o=this.mapState.pan({pos:i}).panEnd();return this.updateViewport(o,se(se({},ue),{},{transitionDuration:r,transitionEasing:le}),{isDragging:!1,isPanning:!0}),!0}}var s=this.mapState.panEnd();return this.updateViewport(s,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=this.getCenter(t),r=this.mapState.rotate({pos:e});return this.updateViewport(r,ae,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(t){if(this.dragRotate){var e=this.dragRotate.inertia,r=void 0===e?ce:e;if(r&&t.velocity){var n=this.getCenter(t),i=[n[0]+t.velocityX*r/2,n[1]+t.velocityY*r/2],o=this.mapState.rotate({pos:i}).rotateEnd();return this.updateViewport(o,se(se({},ue),{},{transitionDuration:r,transitionEasing:le}),{isDragging:!1,isRotating:!0}),!0}}var s=this.mapState.panEnd();return this.updateViewport(s,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;var e=this.scrollZoom,r=e.speed,n=void 0===r?.01:r,i=e.smooth,o=void 0!==i&&i;t.preventDefault();var s=this.getCenter(t),a=t.delta,u=2/(1+Math.exp(-Math.abs(a*n)));a<0&&0!==u&&(u=1/u);var c=this.mapState.zoom({pos:s,scale:u});return c.getViewportProps().zoom!==this.mapStateProps.zoom&&(this.updateViewport(c,se(se({},ue),{},{transitionInterpolator:new qt({around:s}),transitionDuration:o?250:1}),{isPanning:!0,isZooming:!0}),!0)}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t),r=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(r,ae,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.isDragging())return!1;if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.mapState;if(this.touchZoom){var r=t.scale,n=this.getCenter(t);e=e.zoom({pos:n,scale:r})}if(this.touchRotate){var i=t.rotation;e=e.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(e,ae,{isDragging:!0,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:Boolean(this.touchRotate)}),this._lastPinchEvent=t,!0}},{key:"_onPinchEnd",value:function(t){if(!this.isDragging())return!1;if(this.touchZoom){var e=this.touchZoom.inertia,r=void 0===e?ce:e,n=this._lastPinchEvent;if(r&&n&&t.scale!==n.scale){var i=this.getCenter(t),o=this.mapState.rotateEnd(),s=Math.log2(t.scale),a=(s-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),u=Math.pow(2,s+a*r/2);return o=o.zoom({pos:i,scale:u}).zoomEnd(),this.updateViewport(o,se(se({},ue),{},{transitionInterpolator:new qt({around:i}),transitionDuration:r,transitionEasing:le}),{isDragging:!1,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:!1}),this.blockEvents(r),!0}}var c=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(c,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(t){var e=this.getCenter(t),r=this.mapState.rotateStart({pos:e});return this.updateViewport(r,ae,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(t){if(!this.isDragging())return!1;if(!this.touchRotate)return!1;var e=this.getCenter(t);e[0]-=t.deltaX;var r=this.mapState.rotate({pos:e});return this.updateViewport(r,ae,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(t){if(!this.isDragging())return!1;if(this.touchRotate){var e=this.touchRotate.inertia,r=void 0===e?ce:e;if(r&&t.velocityY){var n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*r/2],o=this.mapState.rotate({pos:i});return this.updateViewport(o,se(se({},ue),{},{transitionDuration:r,transitionEasing:le}),{isDragging:!1,isRotating:!0}),this.blockEvents(r),!1}}var s=this.mapState.rotateEnd();return this.updateViewport(s,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t),r=this.isFunctionKeyPressed(t),n=this.mapState.zoom({pos:e,scale:r?.5:2});return this.updateViewport(n,Object.assign({},ue,{transitionInterpolator:new qt({around:e})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,r=this.isFunctionKeyPressed(t),n=this.keyboard,i=n.zoomSpeed,o=void 0===i?2:i,s=n.moveSpeed,a=void 0===s?100:s,u=n.rotateSpeedX,c=void 0===u?15:u,l=n.rotateSpeedY,h=void 0===l?10:l,f=this.mapStateProps;switch(t.srcEvent.keyCode){case 189:e=r?this.getMapState({zoom:f.zoom-Math.log2(o)-1}):this.getMapState({zoom:f.zoom-Math.log2(o)});break;case 187:e=r?this.getMapState({zoom:f.zoom+Math.log2(o)+1}):this.getMapState({zoom:f.zoom+Math.log2(o)});break;case 37:e=r?this.getMapState({bearing:f.bearing-c}):this.mapState.pan({pos:[a,0],startPos:[0,0]});break;case 39:e=r?this.getMapState({bearing:f.bearing+c}):this.mapState.pan({pos:[-a,0],startPos:[0,0]});break;case 38:e=r?this.getMapState({pitch:f.pitch+h}):this.mapState.pan({pos:[0,a],startPos:[0,0]});break;case 40:e=r?this.getMapState({pitch:f.pitch-h}):this.mapState.pan({pos:[0,-a],startPos:[0,0]});break;default:return!1}return this.updateViewport(e,ue)}}]),t}();function ve(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function be(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ve(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var _e=Object.assign({},St.propTypes,{maxZoom:c.number,minZoom:c.number,maxPitch:c.number,minPitch:c.number,onViewStateChange:c.func,onViewportChange:c.func,onInteractionStateChange:c.func,transitionDuration:c.oneOfType([c.number,c.string]),transitionInterpolator:c.object,transitionInterruption:c.number,transitionEasing:c.func,onTransitionStart:c.func,onTransitionInterrupt:c.func,onTransitionEnd:c.func,scrollZoom:c.oneOfType([c.bool,c.object]),dragPan:c.oneOfType([c.bool,c.object]),dragRotate:c.oneOfType([c.bool,c.object]),doubleClickZoom:c.bool,touchZoom:c.oneOfType([c.bool,c.object]),touchRotate:c.oneOfType([c.bool,c.object]),keyboard:c.oneOfType([c.bool,c.object]),onHover:c.func,onClick:c.func,onDblClick:c.func,onContextMenu:c.func,onMouseDown:c.func,onMouseMove:c.func,onMouseUp:c.func,onTouchStart:c.func,onTouchMove:c.func,onTouchEnd:c.func,onMouseEnter:c.func,onMouseLeave:c.func,onMouseOut:c.func,onWheel:c.func,touchAction:c.string,eventRecognizerOptions:c.object,clickRadius:c.number,interactiveLayerIds:c.array,getCursor:c.func,controller:c.instanceOf(ye)}),we=Object.assign({},St.defaultProps,it,ne.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:function(t){var e=t.isDragging,r=t.isHovering;return e?"grabbing":r?"pointer":"grab"}});function xe(t){if(t.lngLat||!t.offsetCenter)return t;var e=t.offsetCenter,r=e.x,n=e.y;if(!Number.isFinite(r)||!Number.isFinite(n))return t;var i=[r,n];if(t.point=i,this.map){var o=this.map.unproject(i);t.lngLat=[o.lng,o.lat]}return t}function Ee(t){var e=this.map;if(!e||!t)return null;var r={},n=this.props.clickRadius;this.props.interactiveLayerIds&&(r.layers=this.props.interactiveLayerIds);try{return e.queryRenderedFeatures(n?[[t[0]-n,t[1]+n],[t[0]+n,t[1]-n]]:t,r)}catch(i){return null}}function Pe(t,e){var r=this.props[t];r&&r(xe.call(this,e))}function Me(t){Pe.call(this,"touch"===t.pointerType?"onTouchStart":"onMouseDown",t)}function Se(t){Pe.call(this,"touch"===t.pointerType?"onTouchEnd":"onMouseUp",t)}function Oe(t){if(Pe.call(this,"touch"===t.pointerType?"onTouchMove":"onMouseMove",t),!this.state.isDragging){var e,r=this.props,n=r.onHover,i=r.interactiveLayerIds;t=xe.call(this,t),(i||n)&&(e=Ee.call(this,t.point));var o=Boolean(i&&e&&e.length>0),s=o&&!this.state.isHovering,a=!o&&this.state.isHovering;(n||s)&&(t.features=e,n&&n(t)),s&&Pe.call(this,"onMouseEnter",t),a&&Pe.call(this,"onMouseLeave",t),(s||a)&&this.setState({isHovering:o})}}function Ae(t){var e=this.props,r=e.onClick,n=e.onNativeClick,i=e.onDblClick,o=e.doubleClickZoom,s=[],a=i||o;switch(t.type){case"anyclick":s.push(n),a||s.push(r);break;case"click":a&&s.push(r)}(s=s.filter(Boolean)).length&&((t=xe.call(this,t)).features=Ee.call(this,t.point),s.forEach((function(e){return e(t)})))}var Te=(0,u.forwardRef)((function(t,e){var r=(0,u.useContext)(pt),i=(0,u.useMemo)((function(){return t.controller||new ye}),[]),o=(0,u.useMemo)((function(){return new ie.Q(null,{touchAction:t.touchAction,recognizerOptions:t.eventRecognizerOptions})}),[]),a=(0,u.useRef)(null),c=(0,u.useRef)(null),l=(0,u.useRef)({width:0,height:0,state:{isHovering:!1,isDragging:!1}}).current;l.props=t,l.map=c.current&&c.current.getMap(),l.setState=function(e){l.state=be(be({},l.state),e),a.current.style.cursor=t.getCursor(l.state)};var h,f,d=!0,p=function(t,e,r){if(d)h=[t,e,r];else{var n=l.props,i=n.onViewStateChange,o=n.onViewportChange;Object.defineProperty(t,"position",{get:function(){return[0,0,mt(l.map,t)]}}),i&&i({viewState:t,interactionState:e,oldViewState:r}),o&&o(t,e,r)}};(0,u.useImperativeHandle)(e,(function(){return function(t){return{getMap:t.current&&t.current.getMap,queryRenderedFeatures:t.current&&t.current.queryRenderedFeatures}}(c)}),[]);var g=(0,u.useMemo)((function(){return be(be({},r),{},{eventManager:o,container:r.container||a.current})}),[r,a.current]);g.onViewportChange=p,g.viewport=r.viewport||_t(l),l.viewport=g.viewport;var m=function(t){var e=t.isDragging,r=void 0!==e&&e;if(r!==l.state.isDragging&&l.setState({isDragging:r}),d)f=t;else{var n=l.props.onInteractionStateChange;n&&n(t)}},y=function(){l.width&&l.height&&i.setOptions(be(be(be({},l.props),l.props.viewState),{},{isInteractive:Boolean(l.props.onViewStateChange||l.props.onViewportChange),onViewportChange:p,onStateChange:m,eventManager:o,width:l.width,height:l.height}))};(0,u.useEffect)((function(){return o.setElement(a.current),o.on({pointerdown:Me.bind(l),pointermove:Oe.bind(l),pointerup:Se.bind(l),pointerleave:Pe.bind(l,"onMouseOut"),click:Ae.bind(l),anyclick:Ae.bind(l),dblclick:Pe.bind(l,"onDblClick"),wheel:Pe.bind(l,"onWheel"),contextmenu:Pe.bind(l,"onContextMenu")}),function(){o.destroy()}}),[]),gt((function(){h&&p.apply(void 0,s(h)),f&&m(f)})),y();var v=t.width,b=t.height,_=t.style,w=t.getCursor,x=(0,u.useMemo)((function(){return be(be({position:"relative"},_),{},{width:v,height:b,cursor:w(l.state)})}),[_,v,b,w,l.state]);return h&&l._child||(l._child=u.createElement(dt,{value:g},u.createElement("div",{key:"event-canvas",ref:a,style:x},u.createElement(St,n({},t,{width:"100%",height:"100%",style:null,onResize:function(t){var e=t.width,r=t.height;l.width=e,l.height=r,y(),l.props.onResize({width:e,height:r})},ref:c}))))),d=!1,l._child}));Te.supported=St.supported,Te.propTypes=_e,Te.defaultProps=we;var ke=Te;function Ce(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!Ce(t[r],e[r]))return!1;return!0}if(Array.isArray(e))return!1;if("object"===It(t)&&"object"===It(e)){var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(var o=0,s=n;o<s.length;o++){var a=s[o];if(!e.hasOwnProperty(a))return!1;if(!Ce(t[a],e[a]))return!1}return!0}return!1}function je(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var Ie={type:c.string.isRequired,id:c.string},Re=0;function Le(t,e,r){if(t.style&&t.style._loaded){var n=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?je(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):je(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},r);return delete n.id,delete n.children,t.addSource(e,n),t.getSource(e)}return null}function De(t){var e=(0,u.useContext)(pt),r=(0,u.useRef)({id:t.id,type:t.type}),n=l((0,u.useState)(0),2)[1],i=(0,u.useMemo)((function(){return t.id||"jsx-source-".concat(Re++)}),[]),o=e.map;(0,u.useEffect)((function(){if(o){var t=function(){return n((function(t){return t+1}))};return o.on("styledata",t),function(){o.off("styledata",t),requestAnimationFrame((function(){o.style&&o.style._loaded&&o.getSource(i)&&o.removeSource(i)}))}}}),[o,i]);var s=o&&o.style&&o.getSource(i);return s?function(t,e,r){et(e.id===r.id,"source id changed"),et(e.type===r.type,"source type changed");var n="",i=0;for(var o in e)"children"===o||"id"===o||Ce(r[o],e[o])||(n=o,i++);if(i){var s=e.type;if("geojson"===s)t.setData(e.data);else if("image"===s)t.updateImage({url:e.url,coordinates:e.coordinates});else if("canvas"!==s&&"video"!==s||1!==i||"coordinates"!==n)if("vector"===s&&t.setUrl)switch(n){case"url":t.setUrl(e.url);break;case"tiles":t.setTiles(e.tiles)}else console.warn("Unable to update <Source> prop: ".concat(n));else t.setCoordinates(e.coordinates)}}(s,t,r.current):s=Le(o,i,t),r.current=t,s&&u.Children.map(t.children,(function(t){return t&&(0,u.cloneElement)(t,{source:i})}))||null}De.propTypes=Ie;var Fe=De;function Ne(t,e){if(null==t)return{};var r,n,i=function(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function Be(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ze(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Be(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Ue={type:c.oneOf(["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade","sky"]).isRequired,id:c.string,source:c.string,beforeId:c.string};function Ve(t,e,r,n){et(r.id===n.id,"layer id changed"),et(r.type===n.type,"layer type changed");try{!function(t,e,r,n){var i=r.layout,o=void 0===i?{}:i,s=r.paint,a=void 0===s?{}:s,u=r.filter,c=r.minzoom,l=r.maxzoom,h=r.beforeId,f=Ne(r,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(h!==n.beforeId&&t.moveLayer(e,h),o!==n.layout){var d=n.layout||{};for(var p in o)Ce(o[p],d[p])||t.setLayoutProperty(e,p,o[p]);for(var g in d)o.hasOwnProperty(g)||t.setLayoutProperty(e,g,void 0)}if(a!==n.paint){var m=n.paint||{};for(var y in a)Ce(a[y],m[y])||t.setPaintProperty(e,y,a[y]);for(var v in m)a.hasOwnProperty(v)||t.setPaintProperty(e,v,void 0)}for(var b in Ce(u,n.filter)||t.setFilter(e,u),c===n.minzoom&&l===n.maxzoom||t.setLayerZoomRange(e,c,l),f)Ce(f[b],n[b])||t.setLayerProperty(e,b,f[b])}(t,e,r,n)}catch(i){console.warn(i)}}var Ge=0;function We(t){var e=(0,u.useContext)(pt),r=(0,u.useRef)({id:t.id,type:t.type}),n=l((0,u.useState)(0),2)[1],i=(0,u.useMemo)((function(){return t.id||"jsx-layer-".concat(Ge++)}),[]),o=e.map;return(0,u.useEffect)((function(){if(o){var t=function(){return n((function(t){return t+1}))};return o.on("styledata",t),function(){o.off("styledata",t),o.style&&o.style._loaded&&o.removeLayer(i)}}}),[o]),o&&o.style&&o.getLayer(i)?Ve(o,i,t,r.current):function(t,e,r){if(t.style&&t.style._loaded){var n=ze(ze({},r),{},{id:e});delete n.beforeId,t.addLayer(n,r.beforeId)}}(o,i,t),r.current=t,null}We.propTypes=Ue;var Ze=We,$e={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},Xe={captureScroll:c.bool,captureDrag:c.bool,captureClick:c.bool,captureDoubleClick:c.bool,capturePointerMove:c.bool};function Ye(t){var e=t.containerRef.current,r=t.context.eventManager;if(e&&r){var n={wheel:function(e){var r=t.props;r.captureScroll&&e.stopPropagation(),r.onScroll&&r.onScroll(e,t)},panstart:function(e){var r=t.props;r.captureDrag&&e.stopPropagation(),r.onDragStart&&r.onDragStart(e,t)},anyclick:function(e){var r=t.props;r.captureClick&&e.stopPropagation(),r.onNativeClick&&r.onNativeClick(e,t)},click:function(e){var r=t.props;r.captureClick&&e.stopPropagation(),r.onClick&&r.onClick(e,t)},dblclick:function(e){var r=t.props;r.captureDoubleClick&&e.stopPropagation(),r.onDoubleClick&&r.onDoubleClick(e,t)},pointermove:function(e){var r=t.props;r.capturePointerMove&&e.stopPropagation(),r.onPointerMove&&r.onPointerMove(e,t)}};return r.watch(n,e),function(){r.off(n)}}}function He(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,u.useContext)(pt),r=(0,u.useRef)(null),n=(0,u.useRef)({props:t,state:{},context:e,containerRef:r}),i=n.current;return i.props=t,i.context=e,(0,u.useEffect)((function(){return Ye(i)}),[e.eventManager]),i}function qe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Lt(t);if(e){var i=Lt(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Rt(this,r)}}function Ke(t){var e=t.instance,r=He(t),n=r.context,i=r.containerRef;return e._context=n,e._containerRef=i,e._render()}var Qe=function(t){jt(r,t);var e=qe(r);function r(){var t;R(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),(0,a.Z)(kt(t),"_context",{}),(0,a.Z)(kt(t),"_containerRef",(0,u.createRef)()),(0,a.Z)(kt(t),"_onScroll",(function(t){})),(0,a.Z)(kt(t),"_onDragStart",(function(t){})),(0,a.Z)(kt(t),"_onDblClick",(function(t){})),(0,a.Z)(kt(t),"_onClick",(function(t){})),(0,a.Z)(kt(t),"_onPointerMove",(function(t){})),t}return D(r,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return u.createElement(Ke,n({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),r}(u.PureComponent);function Je(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function tr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Je(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Je(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}(0,a.Z)(Qe,"propTypes",Xe),(0,a.Z)(Qe,"defaultProps",$e);var er=Object.assign({},Xe,{draggable:c.bool,onDrag:c.func,onDragEnd:c.func,onDragStart:c.func,offsetLeft:c.number,offsetTop:c.number}),rr=Object.assign({},$e,{draggable:!1,offsetLeft:0,offsetTop:0});function nr(t){var e=t.offsetCenter;return[e.x,e.y]}function ir(t,e,r,n){var i=t[0]+e[0]-r.offsetLeft,o=t[1]+e[1]-r.offsetTop;return n.viewport.unproject([i,o])}function or(t,e){var r=e.props,n=e.callbacks,i=e.state,o=e.context,s=e.containerRef;if(r.draggable){t.stopPropagation();var a=nr(t),u=function(t,e){var r=t.center,n=r.x,i=r.y;if(e){var o=e.getBoundingClientRect();return[o.left-n,o.top-i]}return null}(t,s.current);if(i.setDragPos(a),i.setDragOffset(u),n.onDragStart&&u){var c=Object.assign({},t);c.lngLat=ir(a,u,r,o),n.onDragStart(c)}}}function sr(t){var e=t.context.eventManager;if(e&&t.state.dragPos){var r={panmove:function(e){return function(t,e){var r=e.props,n=e.callbacks,i=e.state,o=e.context;t.stopPropagation();var s=nr(t);i.setDragPos(s);var a=i.dragOffset;if(n.onDrag&&a){var u=Object.assign({},t);u.lngLat=ir(s,a,r,o),n.onDrag(u)}}(e,t)},panend:function(e){return function(t,e){var r=e.props,n=e.callbacks,i=e.state,o=e.context;t.stopPropagation();var s=i.dragPos,a=i.dragOffset;if(i.setDragPos(null),i.setDragOffset(null),n.onDragEnd&&s&&a){var u=Object.assign({},t);u.lngLat=ir(s,a,r,o),n.onDragEnd(u)}}(e,t)},pancancel:function(e){return function(t,e){var r=e.state;t.stopPropagation(),r.setDragPos(null),r.setDragOffset(null)}(e,t)}};return e.watch(r),function(){e.off(r)}}}var ar="undefined"!==typeof window&&window.devicePixelRatio||1,ur=function(t){return Math.round(t*ar)/ar},cr=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";if(null===t)return e;var n="x"===r?t.offsetWidth:t.offsetHeight;return ur(e/100*n)/n*100},lr=Object.assign({},er,{className:c.string,longitude:c.number.isRequired,latitude:c.number.isRequired}),hr=Object.assign({},rr,{className:""});function fr(t){var e=function(t){var e=l((0,u.useState)(null),2),r=e[0],n=e[1],i=l((0,u.useState)(null),2),o=i[0],s=i[1],a=He(tr(tr({},t),{},{onDragStart:or}));return a.callbacks=t,a.state.dragPos=r,a.state.setDragPos=n,a.state.dragOffset=o,a.state.setDragOffset=s,(0,u.useEffect)((function(){return sr(a)}),[a.context.eventManager,Boolean(r)]),a}(t),r=e.state,n=e.containerRef,i=t.children,o=t.className,s=t.draggable,a=r.dragPos,c=function(t){var e=t.props,r=t.state,n=t.context,i=e.longitude,o=e.latitude,s=e.offsetLeft,a=e.offsetTop,u=r.dragPos,c=r.dragOffset,h=n.viewport,f=n.map;if(u&&c)return[u[0]+c[0],u[1]+c[1]];var d=mt(f,{longitude:i,latitude:o}),p=l(h.project([i,o,d]),2),g=p[0],m=p[1];return[g+=s,m+=a]}(e),h=l(c,2),f=h[0],d=h[1],p="translate(".concat(ur(f),"px, ").concat(ur(d),"px)"),g=s?a?"grabbing":"grab":"auto",m=(0,u.useMemo)((function(){var t={position:"absolute",left:0,top:0,transform:p,cursor:g};return u.createElement("div",{className:"mapboxgl-marker ".concat(o),ref:e.containerRef,style:t},i)}),[i,o]),y=n.current;return y&&(y.style.transform=p,y.style.cursor=g),m}fr.defaultProps=hr,fr.propTypes=lr;u.memo(fr);var dr={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},pr=Object.keys(dr);var gr=Object.assign({},Xe,{className:c.string,longitude:c.number.isRequired,latitude:c.number.isRequired,altitude:c.number,offsetLeft:c.number,offsetTop:c.number,tipSize:c.number,closeButton:c.bool,closeOnClick:c.bool,anchor:c.oneOf(Object.keys(dr)),dynamicPosition:c.bool,sortByDepth:c.bool,onClose:c.func}),mr=Object.assign({},$e,{className:"",offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function yr(t,e,r,n){var i=l(n,2),o=i[0],s=i[1],a=t.anchor,u=t.dynamicPosition,c=t.tipSize;return r&&u?function(t){var e=t.x,r=t.y,n=t.width,i=t.height,o=t.selfWidth,s=t.selfHeight,a=t.anchor,u=t.padding,c=void 0===u?0:u,l=dr[a],h=l.x,f=l.y,d=r-f*s,p=d+s,g=Math.max(0,c-d)+Math.max(0,p-i+c);if(g>0){var m=f,y=g;for(f=0;f<=1;f+=.5)p=(d=r-f*s)+s,(g=Math.max(0,c-d)+Math.max(0,p-i+c))<y&&(y=g,m=f);f=m}var v=.5;.5===f&&(h=Math.floor(h),v=1);var b=e-h*o,_=b+o,w=Math.max(0,c-b)+Math.max(0,_-n+c);if(w>0){var x=h,E=w;for(h=0;h<=1;h+=v)_=(b=e-h*o)+o,(w=Math.max(0,c-b)+Math.max(0,_-n+c))<E&&(E=w,x=h);h=x}return pr.find((function(t){var e=dr[t];return e.x===h&&e.y===f}))||a}({x:o,y:s,anchor:a,padding:c,width:e.width,height:e.height,selfWidth:r.clientWidth,selfHeight:r.clientHeight}):a}function vr(t){var e=(0,u.useRef)(null),r=He(t),n=r.context,i=r.containerRef,o=l((0,u.useState)(!1),2)[1];(0,u.useEffect)((function(){o(!0)}),[e.current]),(0,u.useEffect)((function(){if(n.eventManager&&t.closeOnClick){var e=function(){return r.props.onClose()};return n.eventManager.on("anyclick",e),function(){n.eventManager.off("anyclick",e)}}}),[n.eventManager,t.closeOnClick]);var s=n.viewport,a=n.map,c=t.className,h=t.longitude,f=t.latitude,d=t.tipSize,p=t.closeButton,g=t.children,m=t.altitude;void 0===m&&(m=mt(a,{longitude:h,latitude:f}));var y=s.project([h,f,m]),v=yr(t,s,e.current,y),b=function(t,e,r,n,i){var o=l(n,3),s=o[0],a=o[1],u=o[2],c=t.offsetLeft,h=t.offsetTop,f=t.sortByDepth,d=dr[i],p=s+c,g=a+h,m=cr(r,100*-d.x),y=cr(r,100*-d.y,"y"),v={position:"absolute",transform:"\n      translate(".concat(m,"%, ").concat(y,"%)\n      translate(").concat(ur(p),"px, ").concat(ur(g),"px)\n    "),display:void 0,zIndex:void 0};return f?(u>1||u<-1||s<0||s>e.width||a<0||a>e.height?v.display="none":v.zIndex=Math.floor((1-u)/2*1e5),v):v}(t,s,i.current,y,v),_=(0,u.useCallback)((function(t){r.props.onClose();var e=r.context.eventManager;e&&e.once("click",(function(t){return t.stopPropagation()}),t.target)}),[]);return u.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(v," ").concat(c),style:b,ref:i},u.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:d}}),u.createElement("div",{key:"content",ref:e,className:"mapboxgl-popup-content"},p&&u.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:_},"\xd7"),g))}vr.propTypes=gr,vr.defaultProps=mr;u.memo(vr);function br(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var _r=Object.assign({},Xe,{toggleLabel:c.string,className:c.string,style:c.object,compact:c.bool,customAttribution:c.oneOfType([c.string,c.arrayOf(c.string)])}),wr=Object.assign({},$e,{className:"",toggleLabel:"Toggle Attribution"});function xr(t){var e=He(t),r=e.context,n=e.containerRef,i=(0,u.useRef)(null),o=l((0,u.useState)(!1),2),s=o[0],c=o[1];(0,u.useEffect)((function(){var e;return r.map&&(e=function(t,e,r,n){var i=new(q().AttributionControl)(t);return i._map=e,i._container=r,i._innerContainer=n,i._updateAttributions(),i._updateEditLink(),e.on("styledata",i._updateData),e.on("sourcedata",i._updateData),i}({customAttribution:t.customAttribution},r.map,n.current,i.current)),function(){return e&&function(t){t._map.off("styledata",t._updateData),t._map.off("sourcedata",t._updateData)}(e)}}),[r.map]);var h=void 0===t.compact?r.viewport.width<=640:t.compact;(0,u.useEffect)((function(){!h&&s&&c(!1)}),[h]);var f=(0,u.useCallback)((function(){return c((function(t){return!t}))}),[]),d=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?br(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return u.createElement("div",{style:d,className:t.className},u.createElement("div",{ref:n,"aria-pressed":s,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(h?"mapboxgl-compact":""," ").concat(s?"mapboxgl-compact-show":"")},u.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:t.toggleLabel,onClick:f}),u.createElement("div",{ref:i,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}xr.propTypes=_r,xr.defaultProps=wr;u.memo(xr);function Er(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var Pr=Object.assign({},Xe,{className:c.string,style:c.object,container:c.object,label:c.string}),Mr=Object.assign({},$e,{className:"",container:null,label:"Toggle fullscreen"});function Sr(t){var e=He(t),r=e.context,n=e.containerRef,i=l((0,u.useState)(!1),2),o=i[0],s=i[1],c=l((0,u.useState)(!1),2),h=c[0],f=c[1],d=l((0,u.useState)(null),2),p=d[0],g=d[1];(0,u.useEffect)((function(){var t=new(q().FullscreenControl);g(t),f(t._checkFullscreenSupport());var e=function(){var e=!t._fullscreen;t._fullscreen=e,s(e)};return F.addEventListener(t._fullscreenchange,e),function(){F.removeEventListener(t._fullscreenchange,e)}}),[]);var m=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Er(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Er(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);if(!h)return null;var y=t.className,v=t.label,b=o?"shrink":"fullscreen";return u.createElement("div",{style:m,className:y},u.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:n},u.createElement("button",{key:b,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(b),type:"button",title:v,onClick:function(){p&&(p._container=t.container||r.container,p._onClickFullscreen())}},u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}Sr.propTypes=Pr,Sr.defaultProps=Mr;var Or;u.memo(Sr);function Ar(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var Tr=function(){},kr=Object.assign({},Xe,{className:c.string,style:c.object,label:c.string,disabledLabel:c.string,auto:c.bool,positionOptions:c.object,fitBoundsOptions:c.object,trackUserLocation:c.bool,showUserLocation:c.bool,showAccuracyCircle:c.bool,showUserHeading:c.bool,onViewStateChange:c.func,onViewportChange:c.func,onGeolocate:c.func}),Cr=Object.assign({},$e,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showUserHeading:!1,showAccuracyCircle:!0,onGeolocate:function(){}});function jr(t,e){var r=e.context,n=e.props,i=function(t){var e=new(q().LngLat)(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy,n=e.toBounds(r);return[[n._ne.lng,n._ne.lat],[n._sw.lng,n._sw.lat]]}(t),o=r.viewport.fitBounds(i,n.fitBoundsOptions),s=o.longitude,a=o.latitude,u=o.zoom,c=Object.assign({},r.viewport,{longitude:s,latitude:a,zoom:u}),l=new ut(c),h=Object.assign({},l.getViewportProps(),ue),f=n.onViewportChange||r.onViewportChange||Tr;(n.onViewStateChange||r.onViewStateChange||Tr)({viewState:h}),f(h)}function Ir(t){var e=He(t),r=e.context,n=e.containerRef,i=(0,u.useRef)(null),o=l((0,u.useState)(null),2),s=o[0],c=o[1],h=l((0,u.useState)(!1),2),f=h[0],d=h[1];(0,u.useEffect)((function(){var n;return r.map&&(void 0!==Or?Promise.resolve(Or):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(t){return Or="denied"!==t.state})):(Or=Boolean(window.navigator.geolocation),Promise.resolve(Or))).then((function(o){d(o),i.current&&((n=function(t,e,r){var n=new(q().GeolocateControl)(e);n._container=F.createElement("div"),n._map={on:function(){},_getUIString:function(){return""}},n._setupUI(!0),n._map=t.map,n._geolocateButton=r;var i=t.eventManager;return n.options.trackUserLocation&&i&&i.on("panstart",(function(){"ACTIVE_LOCK"===n._watchState&&(n._watchState="BACKGROUND",r.classList.add("mapboxgl-ctrl-geolocate-background"),r.classList.remove("mapboxgl-ctrl-geolocate-active"))})),n.on("geolocate",e.onGeolocate),n}(r,t,i.current))._updateCamera=function(t){return jr(t,e)},c(n))})),function(){n&&n._clearWatch()}}),[r.map]);var p=(0,u.useCallback)((function(){s&&(s.options=e.props,s.trigger())}),[s]);(0,u.useEffect)((function(){t.auto&&p()}),[s,t.auto]),(0,u.useEffect)((function(){s&&s._onZoom()}),[r.viewport.zoom]);var g=t.className,m=t.label,y=t.disabledLabel,v=t.trackUserLocation,b=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ar(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ar(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return u.createElement("div",{style:b,className:g},u.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:n},u.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:i,disabled:!f,"aria-pressed":!v,type:"button",title:f?m:y,"aria-label":f?m:y,onClick:p},u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}Ir.propTypes=kr,Ir.defaultProps=Cr;u.memo(Ir);function Rr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var Lr=function(){},Dr=Object.assign({},Xe,{className:c.string,style:c.object,onViewStateChange:c.func,onViewportChange:c.func,showCompass:c.bool,showZoom:c.bool,zoomInLabel:c.string,zoomOutLabel:c.string,compassLabel:c.string}),Fr=Object.assign({},$e,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function Nr(t){return function(t,e){for(var r=(t||"").split(".").map(Number),n=(e||"").split(".").map(Number),i=0;i<3;i++){var o=r[i]||0,s=n[i]||0;if(o<s)return-1;if(o>s)return 1}return 0}(t,"1.6.0")>=0?2:1}function Br(t,e,r){var n=t.viewport,i=new ut(Object.assign({},n,r)),o=Object.assign({},i.getViewportProps(),ue),s=e.onViewportChange||t.onViewportChange||Lr;(e.onViewStateChange||t.onViewStateChange||Lr)({viewState:o}),s(o)}function zr(t,e,r,n){return u.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:r},n||u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function Ur(t){var e=He(t),r=e.context,n=e.containerRef,i=t.className,o=t.showCompass,s=t.showZoom,c=t.zoomInLabel,l=t.zoomOutLabel,h=t.compassLabel,f=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Rr(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return u.createElement("div",{style:f,className:i},u.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:n},s&&zr("zoom-in",c,(function(){Br(r,t,{zoom:r.viewport.zoom+1})})),s&&zr("zoom-out",l,(function(){Br(r,t,{zoom:r.viewport.zoom-1})})),o&&zr("compass",h,(function(){Br(r,t,{bearing:0,pitch:0})}),function(t){var e=(0,u.useMemo)((function(){return t.map?Nr(t.map.version):2}),[t.map]),r=t.viewport.bearing,n={transform:"rotate(".concat(-r,"deg)")};return 2===e?u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:n}):u.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:n})}(r))))}Ur.propTypes=Dr,Ur.defaultProps=Fr;u.memo(Ur);function Vr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var Gr=Object.assign({},Xe,{className:c.string,style:c.object,maxWidth:c.number,unit:c.oneOf(["imperial","metric","nautical"])}),Wr=Object.assign({},$e,{className:"",maxWidth:100,unit:"metric"});function Zr(t){var e=He(t),r=e.context,n=e.containerRef,i=l((0,u.useState)(null),2),o=i[0],s=i[1];(0,u.useEffect)((function(){if(r.map){var t=new(q().ScaleControl);t._map=r.map,t._container=n.current,s(t)}}),[r.map]),o&&(o.options=t,o._onMove());var c=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Vr(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return u.createElement("div",{style:c,className:t.className},u.createElement("div",{ref:n,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}Zr.propTypes=Gr,Zr.defaultProps=Wr;u.memo(Zr);var $r="undefined"!==typeof window&&window.devicePixelRatio||1,Xr=Object.assign({},Xe,{redraw:c.func.isRequired});function Yr(t){var e=He(t),r=e.context,n=e.containerRef,i=l((0,u.useState)(null),2),o=i[0],s=i[1];(0,u.useEffect)((function(){s(n.current.getContext("2d"))}),[]);var a=r.viewport,c=r.isDragging;return o&&(o.save(),o.scale($r,$r),t.redraw({width:a.width,height:a.height,ctx:o,isDragging:c,project:a.project,unproject:a.unproject}),o.restore()),u.createElement("canvas",{ref:n,width:a.width*$r,height:a.height*$r,style:{width:"".concat(a.width,"px"),height:"".concat(a.height,"px"),position:"absolute",left:0,top:0}})}Yr.propTypes=Xr,Yr.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function Hr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var qr=Object.assign({},Xe,{redraw:c.func.isRequired,style:c.object});function Kr(t){var e=He(t),r=e.context,n=e.containerRef,i=r.viewport,o=r.isDragging,s=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Hr(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Hr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({position:"absolute",left:0,top:0,width:i.width,height:i.height},t.style);return u.createElement("div",{ref:n,style:s},t.redraw({width:i.width,height:i.height,isDragging:o,project:i.project,unproject:i.unproject}))}Kr.propTypes=qr,Kr.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function Qr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}var Jr=Object.assign({},Xe,{redraw:c.func.isRequired,style:c.object});function tn(t){var e=He(t),r=e.context,n=e.containerRef,i=r.viewport,o=r.isDragging,s=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Qr(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({position:"absolute",left:0,top:0},t.style);return u.createElement("svg",{width:i.width,height:i.height,ref:n,style:s},t.redraw({width:i.width,height:i.height,isDragging:o,project:i.project,unproject:i.unproject}))}tn.propTypes=Jr,tn.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};q()&&q().setRTLTextPlugin},3697:function(t){"use strict";var e=Object,r=TypeError;t.exports=function(){if(null!=this&&this!==e(this))throw new r("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t}},2847:function(t,e,r){"use strict";var n=r(4289),i=r(5559),o=r(3697),s=r(1721),a=r(2753),u=i(o);n(u,{getPolyfill:s,implementation:o,shim:a}),t.exports=u},1721:function(t,e,r){"use strict";var n=r(3697),i=r(4289).supportsDescriptors,o=Object.getOwnPropertyDescriptor,s=TypeError;t.exports=function(){if(!i)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=o(RegExp.prototype,"flags");if(t&&"function"===typeof t.get&&"boolean"===typeof/a/.dotAll)return t.get}return n}},2753:function(t,e,r){"use strict";var n=r(4289).supportsDescriptors,i=r(1721),o=Object.getOwnPropertyDescriptor,s=Object.defineProperty,a=TypeError,u=Object.getPrototypeOf,c=/a/;t.exports=function(){if(!n||!u)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=i(),e=u(c),r=o(e,"flags");return r&&r.get===t||s(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},8639:function(t,e){!function(t){"use strict";const e=134217729,r=33306690738754706e-32;function n(t,e,r,n,i){let o,s,a,u,c=e[0],l=n[0],h=0,f=0;l>c==l>-c?(o=c,c=e[++h]):(o=l,l=n[++f]);let d=0;if(h<t&&f<r)for(l>c==l>-c?(a=o-((s=c+o)-c),c=e[++h]):(a=o-((s=l+o)-l),l=n[++f]),o=s,0!==a&&(i[d++]=a);h<t&&f<r;)l>c==l>-c?(a=o-((s=o+c)-(u=s-o))+(c-u),c=e[++h]):(a=o-((s=o+l)-(u=s-o))+(l-u),l=n[++f]),o=s,0!==a&&(i[d++]=a);for(;h<t;)a=o-((s=o+c)-(u=s-o))+(c-u),c=e[++h],o=s,0!==a&&(i[d++]=a);for(;f<r;)a=o-((s=o+l)-(u=s-o))+(l-u),l=n[++f],o=s,0!==a&&(i[d++]=a);return 0===o&&0!==d||(i[d++]=o),d}function i(t){return new Float64Array(t)}const o=33306690738754716e-32,s=22204460492503146e-32,a=11093356479670487e-47,u=i(4),c=i(8),l=i(12),h=i(16),f=i(4);t.orient2d=function(t,i,d,p,g,m){const y=(i-m)*(d-g),v=(t-g)*(p-m),b=y-v;if(0===y||0===v||y>0!=v>0)return b;const _=Math.abs(y+v);return Math.abs(b)>=o*_?b:-function(t,i,o,d,p,g,m){let y,v,b,_,w,x,E,P,M,S,O,A,T,k,C,j,I,R;const L=t-p,D=o-p,F=i-g,N=d-g;w=(C=(P=L-(E=(x=e*L)-(x-L)))*(S=N-(M=(x=e*N)-(x-N)))-((k=L*N)-E*M-P*M-E*S))-(O=C-(I=(P=F-(E=(x=e*F)-(x-F)))*(S=D-(M=(x=e*D)-(x-D)))-((j=F*D)-E*M-P*M-E*S))),u[0]=C-(O+w)+(w-I),w=(T=k-((A=k+O)-(w=A-k))+(O-w))-(O=T-j),u[1]=T-(O+w)+(w-j),w=(R=A+O)-A,u[2]=A-(R-w)+(O-w),u[3]=R;let B=function(t,e){let r=e[0];for(let n=1;n<t;n++)r+=e[n];return r}(4,u),z=s*m;if(B>=z||-B>=z)return B;if(y=t-(L+(w=t-L))+(w-p),b=o-(D+(w=o-D))+(w-p),v=i-(F+(w=i-F))+(w-g),_=d-(N+(w=d-N))+(w-g),0===y&&0===v&&0===b&&0===_)return B;if(z=a*m+r*Math.abs(B),(B+=L*_+N*y-(F*b+D*v))>=z||-B>=z)return B;w=(C=(P=y-(E=(x=e*y)-(x-y)))*(S=N-(M=(x=e*N)-(x-N)))-((k=y*N)-E*M-P*M-E*S))-(O=C-(I=(P=v-(E=(x=e*v)-(x-v)))*(S=D-(M=(x=e*D)-(x-D)))-((j=v*D)-E*M-P*M-E*S))),f[0]=C-(O+w)+(w-I),w=(T=k-((A=k+O)-(w=A-k))+(O-w))-(O=T-j),f[1]=T-(O+w)+(w-j),w=(R=A+O)-A,f[2]=A-(R-w)+(O-w),f[3]=R;const U=n(4,u,4,f,c);w=(C=(P=L-(E=(x=e*L)-(x-L)))*(S=_-(M=(x=e*_)-(x-_)))-((k=L*_)-E*M-P*M-E*S))-(O=C-(I=(P=F-(E=(x=e*F)-(x-F)))*(S=b-(M=(x=e*b)-(x-b)))-((j=F*b)-E*M-P*M-E*S))),f[0]=C-(O+w)+(w-I),w=(T=k-((A=k+O)-(w=A-k))+(O-w))-(O=T-j),f[1]=T-(O+w)+(w-j),w=(R=A+O)-A,f[2]=A-(R-w)+(O-w),f[3]=R;const V=n(U,c,4,f,l);w=(C=(P=y-(E=(x=e*y)-(x-y)))*(S=_-(M=(x=e*_)-(x-_)))-((k=y*_)-E*M-P*M-E*S))-(O=C-(I=(P=v-(E=(x=e*v)-(x-v)))*(S=b-(M=(x=e*b)-(x-b)))-((j=v*b)-E*M-P*M-E*S))),f[0]=C-(O+w)+(w-I),w=(T=k-((A=k+O)-(w=A-k))+(O-w))-(O=T-j),f[1]=T-(O+w)+(w-j),w=(R=A+O)-A,f[2]=A-(R-w)+(O-w),f[3]=R;const G=n(V,l,4,f,h);return h[G-1]}(t,i,d,p,g,m,_)},t.orient2dfast=function(t,e,r,n,i,o){return(e-o)*(r-i)-(t-i)*(n-o)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},6774:function(t){t.exports=function(t,e,r,n){var i=r?r.call(n,t,e):void 0;if(void 0!==i)return!!i;if(t===e)return!0;if("object"!==typeof t||!t||"object"!==typeof e||!e)return!1;var o=Object.keys(t),s=Object.keys(e);if(o.length!==s.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(e),u=0;u<o.length;u++){var c=o[u];if(!a(c))return!1;var l=t[c],h=e[c];if(!1===(i=r?r.call(n,l,h,c):void 0)||void 0===i&&l!==h)return!1}return!0}},5697:function(t){"use strict";t.exports={eudist:function(t,e,r){for(var n=t.length,i=0,o=0;o<n;o++){var s=(t[o]||0)-(e[o]||0);i+=s*s}return r?Math.sqrt(i):i},mandist:function(t,e,r){for(var n=t.length,i=0,o=0;o<n;o++)i+=Math.abs((t[o]||0)-(e[o]||0));return r?Math.sqrt(i):i},dist:function(t,e,r){var n=Math.abs(t-e);return r?n:n*n}}},7035:function(t,e,r){"use strict";var n=r(5697),i=n.eudist,o=n.dist;t.exports={kmrand:function(t,e){for(var r={},n=[],i=e<<2,o=t.length,s=t[0].length>0;n.length<e&&i-- >0;){var a=t[Math.floor(Math.random()*o)],u=s?a.join("_"):""+a;r[u]||(r[u]=!0,n.push(a))}if(n.length<e)throw new Error("Error initializating clusters");return n},kmpp:function(t,e){var r=t[0].length?i:o,n=[],s=t.length,a=t[0].length>0,u=t[Math.floor(Math.random()*s)];a&&u.join("_");for(n.push(u);n.length<e;){for(var c=[],l=n.length,h=0,f=[],d=0;d<s;d++){for(var p=1/0,g=0;g<l;g++){var m=r(t[d],n[g]);m<=p&&(p=m)}c[d]=p}for(var y=0;y<s;y++)h+=c[y];for(var v=0;v<s;v++)f[v]={i:v,v:t[v],pr:c[v]/h,cs:0};f.sort((function(t,e){return t.pr-e.pr})),f[0].cs=f[0].pr;for(var b=1;b<s;b++)f[b].cs=f[b-1].cs+f[b].pr;for(var _=Math.random(),w=0;w<s-1&&f[w++].cs<_;);n.push(f[w-1].v)}return n}}},1160:function(t,e,r){"use strict";var n=r(5697),i=r(7035),o=n.eudist,s=(n.mandist,n.dist,i.kmrand),a=i.kmpp;function u(t,e,r){r=r||[];for(var n=0;n<t;n++)r[n]=e;return r}t.exports=function(t,e,r,n){var i=[],c=[],l=[],h=[],f=!1,d=n||1e4,p=t.length,g=t[0].length,m=g>0,y=[];if(r)i="kmrand"==r?s(t,e):"kmpp"==r?a(t,e):r;else for(var v={};i.length<e;){var b=Math.floor(Math.random()*p);v[b]||(v[b]=!0,i.push(t[b]))}do{u(e,0,y);for(var _=0;_<p;_++){for(var w=1/0,x=0,E=0;E<e;E++){(h=m?o(t[_],i[E]):Math.abs(t[_]-i[E]))<=w&&(w=h,x=E)}l[_]=x,y[x]++}for(var P=[],M=(c=[],0);M<e;M++)P[M]=m?u(g,0,P[M]):0,c[M]=i[M];if(m){for(var S=0;S<e;S++)i[S]=[];for(var O=0;O<p;O++)for(var A=P[l[O]],T=t[O],k=0;k<g;k++)A[k]+=T[k];f=!0;for(var C=0;C<e;C++){for(var j=i[C],I=P[C],R=c[C],L=y[C],D=0;D<g;D++)j[D]=I[D]/L||0;if(f)for(var F=0;F<g;F++)if(R[F]!=j[F]){f=!1;break}}}else{for(var N=0;N<p;N++){P[l[N]]+=t[N]}for(var B=0;B<e;B++)i[B]=P[B]/y[B]||0;f=!0;for(var z=0;z<e;z++)if(c[z]!=i[z]){f=!1;break}}f=f||--d<=0}while(!f);return{it:1e4-d,k:e,idxs:l,centroids:i}}},9163:function(t,e,r){"use strict";r.d(e,{ZP:function(){return It}});var n=r(9864),i=r(7294),o=r(6774),s=r.n(o);var a=function(t){function e(t,n,u,c,f){for(var d,p,g,m,_,x=0,E=0,P=0,M=0,S=0,j=0,R=g=d=0,D=0,F=0,N=0,B=0,z=u.length,U=z-1,V="",G="",W="",Z="";D<z;){if(p=u.charCodeAt(D),D===U&&0!==E+M+P+x&&(0!==E&&(p=47===E?10:47),M=P=x=0,z++,U++),0===E+M+P+x){if(D===U&&(0<F&&(V=V.replace(h,"")),0<V.trim().length)){switch(p){case 32:case 9:case 59:case 13:case 10:break;default:V+=u.charAt(D)}p=59}switch(p){case 123:for(d=(V=V.trim()).charCodeAt(0),g=1,B=++D;D<z;){switch(p=u.charCodeAt(D)){case 123:g++;break;case 125:g--;break;case 47:switch(p=u.charCodeAt(D+1)){case 42:case 47:t:{for(R=D+1;R<U;++R)switch(u.charCodeAt(R)){case 47:if(42===p&&42===u.charCodeAt(R-1)&&D+2!==R){D=R+1;break t}break;case 10:if(47===p){D=R+1;break t}}D=R}}break;case 91:p++;case 40:p++;case 34:case 39:for(;D++<U&&u.charCodeAt(D)!==p;);}if(0===g)break;D++}switch(g=u.substring(B,D),0===d&&(d=(V=V.replace(l,"").trim()).charCodeAt(0)),d){case 64:switch(0<F&&(V=V.replace(h,"")),p=V.charCodeAt(1)){case 100:case 109:case 115:case 45:F=n;break;default:F=C}if(B=(g=e(n,F,g,p,f+1)).length,0<I&&(_=a(3,g,F=r(C,V,N),n,A,O,B,p,f,c),V=F.join(""),void 0!==_&&0===(B=(g=_.trim()).length)&&(p=0,g="")),0<B)switch(p){case 115:V=V.replace(w,s);case 100:case 109:case 45:g=V+"{"+g+"}";break;case 107:g=(V=V.replace(y,"$1 $2"))+"{"+g+"}",g=1===k||2===k&&o("@"+g,3)?"@-webkit-"+g+"@"+g:"@"+g;break;default:g=V+g,112===c&&(G+=g,g="")}else g="";break;default:g=e(n,r(n,V,N),g,c,f+1)}W+=g,g=N=F=R=d=0,V="",p=u.charCodeAt(++D);break;case 125:case 59:if(1<(B=(V=(0<F?V.replace(h,""):V).trim()).length))switch(0===R&&(d=V.charCodeAt(0),45===d||96<d&&123>d)&&(B=(V=V.replace(" ",":")).length),0<I&&void 0!==(_=a(1,V,n,t,A,O,G.length,c,f,c))&&0===(B=(V=_.trim()).length)&&(V="\0\0"),d=V.charCodeAt(0),p=V.charCodeAt(1),d){case 0:break;case 64:if(105===p||99===p){Z+=V+u.charAt(D);break}default:58!==V.charCodeAt(B-1)&&(G+=i(V,d,p,V.charCodeAt(2)))}N=F=R=d=0,V="",p=u.charCodeAt(++D)}}switch(p){case 13:case 10:47===E?E=0:0===1+d&&107!==c&&0<V.length&&(F=1,V+="\0"),0<I*L&&a(0,V,n,t,A,O,G.length,c,f,c),O=1,A++;break;case 59:case 125:if(0===E+M+P+x){O++;break}default:switch(O++,m=u.charAt(D),p){case 9:case 32:if(0===M+x+E)switch(S){case 44:case 58:case 9:case 32:m="";break;default:32!==p&&(m=" ")}break;case 0:m="\\0";break;case 12:m="\\f";break;case 11:m="\\v";break;case 38:0===M+E+x&&(F=N=1,m="\f"+m);break;case 108:if(0===M+E+x+T&&0<R)switch(D-R){case 2:112===S&&58===u.charCodeAt(D-3)&&(T=S);case 8:111===j&&(T=j)}break;case 58:0===M+E+x&&(R=D);break;case 44:0===E+P+M+x&&(F=1,m+="\r");break;case 34:case 39:0===E&&(M=M===p?0:0===M?p:M);break;case 91:0===M+E+P&&x++;break;case 93:0===M+E+P&&x--;break;case 41:0===M+E+x&&P--;break;case 40:if(0===M+E+x){if(0===d)switch(2*S+3*j){case 533:break;default:d=1}P++}break;case 64:0===E+P+M+x+R+g&&(g=1);break;case 42:case 47:if(!(0<M+x+P))switch(E){case 0:switch(2*p+3*u.charCodeAt(D+1)){case 235:E=47;break;case 220:B=D,E=42}break;case 42:47===p&&42===S&&B+2!==D&&(33===u.charCodeAt(B+2)&&(G+=u.substring(B,D+1)),m="",E=0)}}0===E&&(V+=m)}j=S,S=p,D++}if(0<(B=G.length)){if(F=n,0<I&&(void 0!==(_=a(2,G,F,t,A,O,B,c,f,c))&&0===(G=_).length))return Z+G+W;if(G=F.join(",")+"{"+G+"}",0!==k*T){switch(2!==k||o(G,2)||(T=0),T){case 111:G=G.replace(b,":-moz-$1")+G;break;case 112:G=G.replace(v,"::-webkit-input-$1")+G.replace(v,"::-moz-$1")+G.replace(v,":-ms-input-$1")+G}T=0}}return Z+G+W}function r(t,e,r){var i=e.trim().split(g);e=i;var o=i.length,s=t.length;switch(s){case 0:case 1:var a=0;for(t=0===s?"":t[0]+" ";a<o;++a)e[a]=n(t,e[a],r).trim();break;default:var u=a=0;for(e=[];a<o;++a)for(var c=0;c<s;++c)e[u++]=n(t[c]+" ",i[a],r).trim()}return e}function n(t,e,r){var n=e.charCodeAt(0);switch(33>n&&(n=(e=e.trim()).charCodeAt(0)),n){case 38:return e.replace(m,"$1"+t.trim());case 58:return t.trim()+e.replace(m,"$1"+t.trim());default:if(0<1*r&&0<e.indexOf("\f"))return e.replace(m,(58===t.charCodeAt(0)?"":"$1")+t.trim())}return t+e}function i(t,e,r,n){var s=t+";",a=2*e+3*r+4*n;if(944===a){t=s.indexOf(":",9)+1;var u=s.substring(t,s.length-1).trim();return u=s.substring(0,t).trim()+u+";",1===k||2===k&&o(u,1)?"-webkit-"+u+u:u}if(0===k||2===k&&!o(s,1))return s;switch(a){case 1015:return 97===s.charCodeAt(10)?"-webkit-"+s+s:s;case 951:return 116===s.charCodeAt(3)?"-webkit-"+s+s:s;case 963:return 110===s.charCodeAt(5)?"-webkit-"+s+s:s;case 1009:if(100!==s.charCodeAt(4))break;case 969:case 942:return"-webkit-"+s+s;case 978:return"-webkit-"+s+"-moz-"+s+s;case 1019:case 983:return"-webkit-"+s+"-moz-"+s+"-ms-"+s+s;case 883:if(45===s.charCodeAt(8))return"-webkit-"+s+s;if(0<s.indexOf("image-set(",11))return s.replace(S,"$1-webkit-$2")+s;break;case 932:if(45===s.charCodeAt(4))switch(s.charCodeAt(5)){case 103:return"-webkit-box-"+s.replace("-grow","")+"-webkit-"+s+"-ms-"+s.replace("grow","positive")+s;case 115:return"-webkit-"+s+"-ms-"+s.replace("shrink","negative")+s;case 98:return"-webkit-"+s+"-ms-"+s.replace("basis","preferred-size")+s}return"-webkit-"+s+"-ms-"+s+s;case 964:return"-webkit-"+s+"-ms-flex-"+s+s;case 1023:if(99!==s.charCodeAt(8))break;return"-webkit-box-pack"+(u=s.substring(s.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+s+"-ms-flex-pack"+u+s;case 1005:return d.test(s)?s.replace(f,":-webkit-")+s.replace(f,":-moz-")+s:s;case 1e3:switch(e=(u=s.substring(13).trim()).indexOf("-")+1,u.charCodeAt(0)+u.charCodeAt(e)){case 226:u=s.replace(_,"tb");break;case 232:u=s.replace(_,"tb-rl");break;case 220:u=s.replace(_,"lr");break;default:return s}return"-webkit-"+s+"-ms-"+u+s;case 1017:if(-1===s.indexOf("sticky",9))break;case 975:switch(e=(s=t).length-10,a=(u=(33===s.charCodeAt(e)?s.substring(0,e):s).substring(t.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|u.charCodeAt(7))){case 203:if(111>u.charCodeAt(8))break;case 115:s=s.replace(u,"-webkit-"+u)+";"+s;break;case 207:case 102:s=s.replace(u,"-webkit-"+(102<a?"inline-":"")+"box")+";"+s.replace(u,"-webkit-"+u)+";"+s.replace(u,"-ms-"+u+"box")+";"+s}return s+";";case 938:if(45===s.charCodeAt(5))switch(s.charCodeAt(6)){case 105:return u=s.replace("-items",""),"-webkit-"+s+"-webkit-box-"+u+"-ms-flex-"+u+s;case 115:return"-webkit-"+s+"-ms-flex-item-"+s.replace(E,"")+s;default:return"-webkit-"+s+"-ms-flex-line-pack"+s.replace("align-content","").replace(E,"")+s}break;case 973:case 989:if(45!==s.charCodeAt(3)||122===s.charCodeAt(4))break;case 931:case 953:if(!0===M.test(t))return 115===(u=t.substring(t.indexOf(":")+1)).charCodeAt(0)?i(t.replace("stretch","fill-available"),e,r,n).replace(":fill-available",":stretch"):s.replace(u,"-webkit-"+u)+s.replace(u,"-moz-"+u.replace("fill-",""))+s;break;case 962:if(s="-webkit-"+s+(102===s.charCodeAt(5)?"-ms-"+s:"")+s,211===r+n&&105===s.charCodeAt(13)&&0<s.indexOf("transform",10))return s.substring(0,s.indexOf(";",27)+1).replace(p,"$1-webkit-$2")+s}return s}function o(t,e){var r=t.indexOf(1===e?":":"{"),n=t.substring(0,3!==e?r:10);return r=t.substring(r+1,t.length-1),R(2!==e?n:n.replace(P,"$1"),r,e)}function s(t,e){var r=i(e,e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2));return r!==e+";"?r.replace(x," or ($1)").substring(4):"("+e+")"}function a(t,e,r,n,i,o,s,a,u,l){for(var h,f=0,d=e;f<I;++f)switch(h=j[f].call(c,t,d,r,n,i,o,s,a,u,l)){case void 0:case!1:case!0:case null:break;default:d=h}if(d!==e)return d}function u(t){return void 0!==(t=t.prefix)&&(R=null,t?"function"!==typeof t?k=1:(k=2,R=t):k=0),u}function c(t,r){var n=t;if(33>n.charCodeAt(0)&&(n=n.trim()),n=[n],0<I){var i=a(-1,r,n,n,A,O,0,0,0,0);void 0!==i&&"string"===typeof i&&(r=i)}var o=e(C,n,r,0,0);return 0<I&&(void 0!==(i=a(-2,o,n,n,A,O,o.length,0,0,0))&&(o=i)),"",T=0,O=A=1,o}var l=/^\0+/g,h=/[\0\r\f]/g,f=/: */g,d=/zoo|gra/,p=/([,: ])(transform)/g,g=/,\r+?/g,m=/([\t\r\n ])*\f?&/g,y=/@(k\w+)\s*(\S*)\s*/,v=/::(place)/g,b=/:(read-only)/g,_=/[svh]\w+-[tblr]{2}/,w=/\(\s*(.*)\s*\)/g,x=/([\s\S]*?);/g,E=/-self|flex-/g,P=/[^]*?(:[rp][el]a[\w-]+)[^]*/,M=/stretch|:\s*\w+\-(?:conte|avail)/,S=/([^-])(image-set\()/,O=1,A=1,T=0,k=1,C=[],j=[],I=0,R=null,L=0;return c.use=function t(e){switch(e){case void 0:case null:I=j.length=0;break;default:if("function"===typeof e)j[I++]=e;else if("object"===typeof e)for(var r=0,n=e.length;r<n;++r)t(e[r]);else L=0|!!e}return t},c.set=u,void 0!==t&&u(t),c},u={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var c=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|inert|itemProp|itemScope|itemType|itemID|itemRef|on|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,l=function(t){var e={};return function(r){return void 0===e[r]&&(e[r]=t(r)),e[r]}}((function(t){return c.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91})),h=r(8679),f=r.n(h),d=r(4155);function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var g=function(t,e){for(var r=[t[0]],n=0,i=e.length;n<i;n+=1)r.push(e[n],t[n+1]);return r},m=function(t){return null!==t&&"object"==typeof t&&"[object Object]"===(t.toString?t.toString():Object.prototype.toString.call(t))&&!(0,n.typeOf)(t)},y=Object.freeze([]),v=Object.freeze({});function b(t){return"function"==typeof t}function _(t){return t.displayName||t.name||"Component"}function w(t){return t&&"string"==typeof t.styledComponentId}var x="undefined"!=typeof d&&(d.env.REACT_APP_SC_ATTR||d.env.SC_ATTR)||"data-styled",E="undefined"!=typeof window&&"HTMLElement"in window,P=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof d&&void 0!==d.env.REACT_APP_SC_DISABLE_SPEEDY&&""!==d.env.REACT_APP_SC_DISABLE_SPEEDY?"false"!==d.env.REACT_APP_SC_DISABLE_SPEEDY&&d.env.REACT_APP_SC_DISABLE_SPEEDY:"undefined"!=typeof d&&void 0!==d.env.SC_DISABLE_SPEEDY&&""!==d.env.SC_DISABLE_SPEEDY&&("false"!==d.env.SC_DISABLE_SPEEDY&&d.env.SC_DISABLE_SPEEDY));function M(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw new Error("An error occurred. See https://git.io/JUIaE#"+t+" for more information."+(r.length>0?" Args: "+r.join(", "):""))}var S=function(){function t(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}var e=t.prototype;return e.indexOfGroup=function(t){for(var e=0,r=0;r<t;r++)e+=this.groupSizes[r];return e},e.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var r=this.groupSizes,n=r.length,i=n;t>=i;)(i<<=1)<0&&M(16,""+t);this.groupSizes=new Uint32Array(i),this.groupSizes.set(r),this.length=i;for(var o=n;o<i;o++)this.groupSizes[o]=0}for(var s=this.indexOfGroup(t+1),a=0,u=e.length;a<u;a++)this.tag.insertRule(s,e[a])&&(this.groupSizes[t]++,s++)},e.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],r=this.indexOfGroup(t),n=r+e;this.groupSizes[t]=0;for(var i=r;i<n;i++)this.tag.deleteRule(r)}},e.getGroup=function(t){var e="";if(t>=this.length||0===this.groupSizes[t])return e;for(var r=this.groupSizes[t],n=this.indexOfGroup(t),i=n+r,o=n;o<i;o++)e+=this.tag.getRule(o)+"/*!sc*/\n";return e},t}(),O=new Map,A=new Map,T=1,k=function(t){if(O.has(t))return O.get(t);for(;A.has(T);)T++;var e=T++;return O.set(t,e),A.set(e,t),e},C=function(t){return A.get(t)},j=function(t,e){e>=T&&(T=e+1),O.set(t,e),A.set(e,t)},I="style["+x+'][data-styled-version="5.3.1"]',R=new RegExp("^"+x+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),L=function(t,e,r){for(var n,i=r.split(","),o=0,s=i.length;o<s;o++)(n=i[o])&&t.registerName(e,n)},D=function(t,e){for(var r=(e.innerHTML||"").split("/*!sc*/\n"),n=[],i=0,o=r.length;i<o;i++){var s=r[i].trim();if(s){var a=s.match(R);if(a){var u=0|parseInt(a[1],10),c=a[2];0!==u&&(j(c,u),L(t,c,a[3]),t.getTag().insertRules(u,n)),n.length=0}else n.push(s)}}},F=function(){return"undefined"!=typeof window&&void 0!==window.__webpack_nonce__?window.__webpack_nonce__:null},N=function(t){var e=document.head,r=t||e,n=document.createElement("style"),i=function(t){for(var e=t.childNodes,r=e.length;r>=0;r--){var n=e[r];if(n&&1===n.nodeType&&n.hasAttribute(x))return n}}(r),o=void 0!==i?i.nextSibling:null;n.setAttribute(x,"active"),n.setAttribute("data-styled-version","5.3.1");var s=F();return s&&n.setAttribute("nonce",s),r.insertBefore(n,o),n},B=function(){function t(t){var e=this.element=N(t);e.appendChild(document.createTextNode("")),this.sheet=function(t){if(t.sheet)return t.sheet;for(var e=document.styleSheets,r=0,n=e.length;r<n;r++){var i=e[r];if(i.ownerNode===t)return i}M(17)}(e),this.length=0}var e=t.prototype;return e.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch(t){return!1}},e.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.getRule=function(t){var e=this.sheet.cssRules[t];return void 0!==e&&"string"==typeof e.cssText?e.cssText:""},t}(),z=function(){function t(t){var e=this.element=N(t);this.nodes=e.childNodes,this.length=0}var e=t.prototype;return e.insertRule=function(t,e){if(t<=this.length&&t>=0){var r=document.createTextNode(e),n=this.nodes[t];return this.element.insertBefore(r,n||null),this.length++,!0}return!1},e.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},t}(),U=function(){function t(t){this.rules=[],this.length=0}var e=t.prototype;return e.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},e.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.getRule=function(t){return t<this.length?this.rules[t]:""},t}(),V=E,G={isServer:!E,useCSSOMInjection:!P},W=function(){function t(t,e,r){void 0===t&&(t=v),void 0===e&&(e={}),this.options=p({},G,{},t),this.gs=e,this.names=new Map(r),this.server=!!t.isServer,!this.server&&E&&V&&(V=!1,function(t){for(var e=document.querySelectorAll(I),r=0,n=e.length;r<n;r++){var i=e[r];i&&"active"!==i.getAttribute(x)&&(D(t,i),i.parentNode&&i.parentNode.removeChild(i))}}(this))}t.registerId=function(t){return k(t)};var e=t.prototype;return e.reconstructWithOptions=function(e,r){return void 0===r&&(r=!0),new t(p({},this.options,{},e),this.gs,r&&this.names||void 0)},e.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.getTag=function(){return this.tag||(this.tag=(r=(e=this.options).isServer,n=e.useCSSOMInjection,i=e.target,t=r?new U(i):n?new B(i):new z(i),new S(t)));var t,e,r,n,i},e.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},e.registerName=function(t,e){if(k(t),this.names.has(t))this.names.get(t).add(e);else{var r=new Set;r.add(e),this.names.set(t,r)}},e.insertRules=function(t,e,r){this.registerName(t,e),this.getTag().insertRules(k(t),r)},e.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.clearRules=function(t){this.getTag().clearGroup(k(t)),this.clearNames(t)},e.clearTag=function(){this.tag=void 0},e.toString=function(){return function(t){for(var e=t.getTag(),r=e.length,n="",i=0;i<r;i++){var o=C(i);if(void 0!==o){var s=t.names.get(o),a=e.getGroup(i);if(s&&a&&s.size){var u=x+".g"+i+'[id="'+o+'"]',c="";void 0!==s&&s.forEach((function(t){t.length>0&&(c+=t+",")})),n+=""+a+u+'{content:"'+c+'"}/*!sc*/\n'}}}return n}(this)},t}(),Z=/(a)(d)/gi,$=function(t){return String.fromCharCode(t+(t>25?39:97))};function X(t){var e,r="";for(e=Math.abs(t);e>52;e=e/52|0)r=$(e%52)+r;return($(e%52)+r).replace(Z,"$1-$2")}var Y=function(t,e){for(var r=e.length;r;)t=33*t^e.charCodeAt(--r);return t},H=function(t){return Y(5381,t)};function q(t){for(var e=0;e<t.length;e+=1){var r=t[e];if(b(r)&&!w(r))return!1}return!0}var K=H("5.3.1"),Q=function(){function t(t,e,r){this.rules=t,this.staticRulesId="",this.isStatic=(void 0===r||r.isStatic)&&q(t),this.componentId=e,this.baseHash=Y(K,e),this.baseStyle=r,W.registerId(e)}return t.prototype.generateAndInjectStyles=function(t,e,r){var n=this.componentId,i=[];if(this.baseStyle&&i.push(this.baseStyle.generateAndInjectStyles(t,e,r)),this.isStatic&&!r.hash)if(this.staticRulesId&&e.hasNameForId(n,this.staticRulesId))i.push(this.staticRulesId);else{var o=mt(this.rules,t,e,r).join(""),s=X(Y(this.baseHash,o)>>>0);if(!e.hasNameForId(n,s)){var a=r(o,"."+s,void 0,n);e.insertRules(n,s,a)}i.push(s),this.staticRulesId=s}else{for(var u=this.rules.length,c=Y(this.baseHash,r.hash),l="",h=0;h<u;h++){var f=this.rules[h];if("string"==typeof f)l+=f;else if(f){var d=mt(f,t,e,r),p=Array.isArray(d)?d.join(""):d;c=Y(c,p+h),l+=p}}if(l){var g=X(c>>>0);if(!e.hasNameForId(n,g)){var m=r(l,"."+g,void 0,n);e.insertRules(n,g,m)}i.push(g)}}return i.join(" ")},t}(),J=/^\s*\/\/.*$/gm,tt=[":","[",".","#"];function et(t){var e,r,n,i,o=void 0===t?v:t,s=o.options,u=void 0===s?v:s,c=o.plugins,l=void 0===c?y:c,h=new a(u),f=[],d=function(t){function e(e){if(e)try{t(e+"}")}catch(t){}}return function(r,n,i,o,s,a,u,c,l,h){switch(r){case 1:if(0===l&&64===n.charCodeAt(0))return t(n+";"),"";break;case 2:if(0===c)return n+"/*|*/";break;case 3:switch(c){case 102:case 112:return t(i[0]+n),"";default:return n+(0===h?"/*|*/":"")}case-2:n.split("/*|*/}").forEach(e)}}}((function(t){f.push(t)})),p=function(t,n,o){return 0===n&&-1!==tt.indexOf(o[r.length])||o.match(i)?t:"."+e};function g(t,o,s,a){void 0===a&&(a="&");var u=t.replace(J,""),c=o&&s?s+" "+o+" { "+u+" }":u;return e=a,r=o,n=new RegExp("\\"+r+"\\b","g"),i=new RegExp("(\\"+r+"\\b){2,}"),h(s||!o?"":o,c)}return h.use([].concat(l,[function(t,e,i){2===t&&i.length&&i[0].lastIndexOf(r)>0&&(i[0]=i[0].replace(n,p))},d,function(t){if(-2===t){var e=f;return f=[],e}}])),g.hash=l.length?l.reduce((function(t,e){return e.name||M(15),Y(t,e.name)}),5381).toString():"",g}var rt=i.createContext(),nt=(rt.Consumer,i.createContext()),it=(nt.Consumer,new W),ot=et();function st(){return(0,i.useContext)(rt)||it}function at(){return(0,i.useContext)(nt)||ot}function ut(t){var e=(0,i.useState)(t.stylisPlugins),r=e[0],n=e[1],o=st(),a=(0,i.useMemo)((function(){var e=o;return t.sheet?e=t.sheet:t.target&&(e=e.reconstructWithOptions({target:t.target},!1)),t.disableCSSOMInjection&&(e=e.reconstructWithOptions({useCSSOMInjection:!1})),e}),[t.disableCSSOMInjection,t.sheet,t.target]),u=(0,i.useMemo)((function(){return et({options:{prefix:!t.disableVendorPrefixes},plugins:r})}),[t.disableVendorPrefixes,r]);return(0,i.useEffect)((function(){s()(r,t.stylisPlugins)||n(t.stylisPlugins)}),[t.stylisPlugins]),i.createElement(rt.Provider,{value:a},i.createElement(nt.Provider,{value:u},t.children))}var ct=function(){function t(t,e){var r=this;this.inject=function(t,e){void 0===e&&(e=ot);var n=r.name+e.hash;t.hasNameForId(r.id,n)||t.insertRules(r.id,n,e(r.rules,n,"@keyframes"))},this.toString=function(){return M(12,String(r.name))},this.name=t,this.id="sc-keyframes-"+t,this.rules=e}return t.prototype.getName=function(t){return void 0===t&&(t=ot),this.name+t.hash},t}(),lt=/([A-Z])/,ht=/([A-Z])/g,ft=/^ms-/,dt=function(t){return"-"+t.toLowerCase()};function pt(t){return lt.test(t)?t.replace(ht,dt).replace(ft,"-ms-"):t}var gt=function(t){return null==t||!1===t||""===t};function mt(t,e,r,n){if(Array.isArray(t)){for(var i,o=[],s=0,a=t.length;s<a;s+=1)""!==(i=mt(t[s],e,r,n))&&(Array.isArray(i)?o.push.apply(o,i):o.push(i));return o}return gt(t)?"":w(t)?"."+t.styledComponentId:b(t)?"function"!=typeof(c=t)||c.prototype&&c.prototype.isReactComponent||!e?t:mt(t(e),e,r,n):t instanceof ct?r?(t.inject(r,n),t.getName(n)):t:m(t)?function t(e,r){var n,i,o=[];for(var s in e)e.hasOwnProperty(s)&&!gt(e[s])&&(Array.isArray(e[s])&&e[s].isCss||b(e[s])?o.push(pt(s)+":",e[s],";"):m(e[s])?o.push.apply(o,t(e[s],s)):o.push(pt(s)+": "+(n=s,(null==(i=e[s])||"boolean"==typeof i||""===i?"":"number"!=typeof i||0===i||n in u?String(i).trim():i+"px")+";")));return r?[r+" {"].concat(o,["}"]):o}(t):t.toString();var c}var yt=function(t){return Array.isArray(t)&&(t.isCss=!0),t};function vt(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return b(t)||m(t)?yt(mt(g(y,[t].concat(r)))):0===r.length&&1===t.length&&"string"==typeof t[0]?t:yt(mt(g(t,r)))}new Set;var bt=function(t,e,r){return void 0===r&&(r=v),t.theme!==r.theme&&t.theme||e||r.theme},_t=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,wt=/(^-|-$)/g;function xt(t){return t.replace(_t,"-").replace(wt,"")}var Et=function(t){return X(H(t)>>>0)};function Pt(t){return"string"==typeof t&&!0}var Mt=function(t){return"function"==typeof t||"object"==typeof t&&null!==t&&!Array.isArray(t)},St=function(t){return"__proto__"!==t&&"constructor"!==t&&"prototype"!==t};function Ot(t,e,r){var n=t[r];Mt(e)&&Mt(n)?At(n,e):t[r]=e}function At(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];for(var i=0,o=r;i<o.length;i++){var s=o[i];if(Mt(s))for(var a in s)St(a)&&Ot(t,s[a],a)}return t}var Tt=i.createContext();Tt.Consumer;var kt={};function Ct(t,e,r){var n=w(t),o=!Pt(t),s=e.attrs,a=void 0===s?y:s,u=e.componentId,c=void 0===u?function(t,e){var r="string"!=typeof t?"sc":xt(t);kt[r]=(kt[r]||0)+1;var n=r+"-"+Et("5.3.1"+r+kt[r]);return e?e+"-"+n:n}(e.displayName,e.parentComponentId):u,h=e.displayName,d=void 0===h?function(t){return Pt(t)?"styled."+t:"Styled("+_(t)+")"}(t):h,g=e.displayName&&e.componentId?xt(e.displayName)+"-"+e.componentId:e.componentId||c,m=n&&t.attrs?Array.prototype.concat(t.attrs,a).filter(Boolean):a,x=e.shouldForwardProp;n&&t.shouldForwardProp&&(x=e.shouldForwardProp?function(r,n,i){return t.shouldForwardProp(r,n,i)&&e.shouldForwardProp(r,n,i)}:t.shouldForwardProp);var E,P=new Q(r,g,n?t.componentStyle:void 0),M=P.isStatic&&0===a.length,S=function(t,e){return function(t,e,r,n){var o=t.attrs,s=t.componentStyle,a=t.defaultProps,u=t.foldedComponentIds,c=t.shouldForwardProp,h=t.styledComponentId,f=t.target,d=function(t,e,r){void 0===t&&(t=v);var n=p({},e,{theme:t}),i={};return r.forEach((function(t){var e,r,o,s=t;for(e in b(s)&&(s=s(n)),s)n[e]=i[e]="className"===e?(r=i[e],o=s[e],r&&o?r+" "+o:r||o):s[e]})),[n,i]}(bt(e,(0,i.useContext)(Tt),a)||v,e,o),g=d[0],m=d[1],y=function(t,e,r,n){var i=st(),o=at();return e?t.generateAndInjectStyles(v,i,o):t.generateAndInjectStyles(r,i,o)}(s,n,g),_=r,w=m.$as||e.$as||m.as||e.as||f,x=Pt(w),E=m!==e?p({},e,{},m):e,P={};for(var M in E)"$"!==M[0]&&"as"!==M&&("forwardedAs"===M?P.as=E[M]:(c?c(M,l,w):!x||l(M))&&(P[M]=E[M]));return e.style&&m.style!==e.style&&(P.style=p({},e.style,{},m.style)),P.className=Array.prototype.concat(u,h,y!==h?y:null,e.className,m.className).filter(Boolean).join(" "),P.ref=_,(0,i.createElement)(w,P)}(E,t,e,M)};return S.displayName=d,(E=i.forwardRef(S)).attrs=m,E.componentStyle=P,E.displayName=d,E.shouldForwardProp=x,E.foldedComponentIds=n?Array.prototype.concat(t.foldedComponentIds,t.styledComponentId):y,E.styledComponentId=g,E.target=n?t.target:t,E.withComponent=function(t){var n=e.componentId,i=function(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}(e,["componentId"]),o=n&&n+"-"+(Pt(t)?t:xt(_(t)));return Ct(t,p({},i,{attrs:m,componentId:o}),r)},Object.defineProperty(E,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(e){this._foldedDefaultProps=n?At({},t.defaultProps,e):e}}),E.toString=function(){return"."+E.styledComponentId},o&&f()(E,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),E}var jt=function(t){return function t(e,r,i){if(void 0===i&&(i=v),!(0,n.isValidElementType)(r))return M(1,String(r));var o=function(){return e(r,i,vt.apply(void 0,arguments))};return o.withConfig=function(n){return t(e,r,p({},i,{},n))},o.attrs=function(n){return t(e,r,p({},i,{attrs:Array.prototype.concat(i.attrs,n).filter(Boolean)}))},o}(Ct,t)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach((function(t){jt[t]=jt(t)}));!function(){function t(t,e){this.rules=t,this.componentId=e,this.isStatic=q(t),W.registerId(this.componentId+1)}var e=t.prototype;e.createStyles=function(t,e,r,n){var i=n(mt(this.rules,e,r,n).join(""),""),o=this.componentId+t;r.insertRules(o,o,i)},e.removeStyles=function(t,e){e.clearRules(this.componentId+t)},e.renderStyles=function(t,e,r,n){t>2&&W.registerId(this.componentId+t),this.removeStyles(t,r),this.createStyles(t,e,r,n)}}();!function(){function t(){var t=this;this._emitSheetCSS=function(){var e=t.instance.toString();if(!e)return"";var r=F();return"<style "+[r&&'nonce="'+r+'"',x+'="true"','data-styled-version="5.3.1"'].filter(Boolean).join(" ")+">"+e+"</style>"},this.getStyleTags=function(){return t.sealed?M(2):t._emitSheetCSS()},this.getStyleElement=function(){var e;if(t.sealed)return M(2);var r=((e={})[x]="",e["data-styled-version"]="5.3.1",e.dangerouslySetInnerHTML={__html:t.instance.toString()},e),n=F();return n&&(r.nonce=n),[i.createElement("style",p({},r,{key:"sc-0-0"}))]},this.seal=function(){t.sealed=!0},this.instance=new W({isServer:!0}),this.sealed=!1}var e=t.prototype;e.collectStyles=function(t){return this.sealed?M(2):i.createElement(ut,{sheet:this.instance},t)},e.interleaveWithNodeStream=function(t){return M(3)}}();var It=jt},3842:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return n}});class n{constructor(t=[],e=i){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:r}=this,n=e[t];for(;t>0;){const i=t-1>>1,o=e[i];if(r(n,o)>=0)break;e[t]=o,t=i}e[t]=n}_down(t){const{data:e,compare:r}=this,n=this.length>>1,i=e[t];for(;t<n;){let n=1+(t<<1),o=e[n];const s=n+1;if(s<this.length&&r(e[s],o)<0&&(n=s,o=e[s]),r(o,i)>=0)break;e[t]=o,t=n}e[t]=i}}function i(t,e){return t<e?-1:t>e?1:0}},4942:function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{Z:function(){return n}})},6537:function(t,e,r){"use strict";r.d(e,{yue:function(){return a},QFx:function(){return At}});var n=6371008.8,i={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:250826616.45599997,kilometers:6371.0088,kilometres:6371.0088,meters:n,metres:n,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:3440.069546436285,radians:1,yards:6967335.223679999};function o(t,e,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function s(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!p(t[0])||!p(t[1]))throw new Error("coordinates must contain numbers");return o({type:"Point",coordinates:t},e,r)}function a(t,e,r){void 0===r&&(r={});for(var n=0,i=t;n<i.length;n++){var s=i[n];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return o({type:"Polygon",coordinates:t},e,r)}function u(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return o({type:"LineString",coordinates:t},e,r)}function c(t,e,r){return void 0===r&&(r={}),o({type:"MultiPoint",coordinates:t},e,r)}function l(t,e){void 0===e&&(e="kilometers");var r=i[e];if(!r)throw new Error(e+" units is invalid");return t/r}function h(t){return 180*(t%(2*Math.PI))/Math.PI}function f(t){return t%360*Math.PI/180}function d(t,e,r){if(void 0===e&&(e="kilometers"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("length must be a positive number");return function(t,e){void 0===e&&(e="kilometers");var r=i[e];if(!r)throw new Error(e+" units is invalid");return t*r}(l(t,e),r)}function p(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function g(t,e,r){if(null!==t)for(var n,i,o,s,a,u,c,l,h=0,f=0,d=t.type,p="FeatureCollection"===d,m="Feature"===d,y=p?t.features.length:1,v=0;v<y;v++){a=(l=!!(c=p?t.features[v].geometry:m?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var b=0;b<a;b++){var _=0,w=0;if(null!==(s=l?c.geometries[b]:c)){u=s.coordinates;var x=s.type;switch(h=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(u,f,v,_,w))return!1;f++,_++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],f,v,_,w))return!1;f++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(i=0;i<u[n].length-h;i++){if(!1===e(u[n][i],f,v,_,w))return!1;f++}"MultiLineString"===x&&_++,"Polygon"===x&&w++}"Polygon"===x&&_++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(w=0,i=0;i<u[n].length;i++){for(o=0;o<u[n][i].length-h;o++){if(!1===e(u[n][i][o],f,v,_,w))return!1;f++}w++}_++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===g(s.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function m(t,e){var r,n,i,o,s,a,u,c,l,h,f=0,d="FeatureCollection"===t.type,p="Feature"===t.type,g=d?t.features.length:1;for(r=0;r<g;r++){for(a=d?t.features[r].geometry:p?t.geometry:t,c=d?t.features[r].properties:p?t.properties:{},l=d?t.features[r].bbox:p?t.bbox:void 0,h=d?t.features[r].id:p?t.id:void 0,s=(u=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=u?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,c,l,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],f,c,l,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,c,l,h))return!1;f++}}function y(t,e){m(t,(function(t,r,n,i,s){var a,u=null===t?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==e(o(t,n,{bbox:i,id:s}),r,0)&&void 0}switch(u){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<t.coordinates.length;c++){var l=t.coordinates[c];if(!1===e(o({type:a,coordinates:l},n),r,c))return!1}}))}function v(t){var e=[1/0,1/0,-1/0,-1/0];return g(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}v.default=v;var b=v;function _(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}r(6086);r(2273);function w(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n,i=_(t),o="Feature"===(n=e).type?n.geometry:n,s=o.type,a=e.bbox,u=o.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,a))return!1;"Polygon"===s&&(u=[u]);for(var c=!1,l=0;l<u.length&&!c;l++)if(x(i,u[l][0],r.ignoreBoundary)){for(var h=!1,f=1;f<u[l].length&&!h;)x(i,u[l][f],!r.ignoreBoundary)&&(h=!0),f++;h||(c=!0)}return c}function x(t,e,r){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],u=e[o][0],c=e[o][1];if(t[1]*(s-u)+a*(u-t[0])+c*(t[0]-s)===0&&(s-t[0])*(u-t[0])<=0&&(a-t[1])*(c-t[1])<=0)return!r;a>t[1]!==c>t[1]&&t[0]<(u-s)*(t[1]-a)/(c-a)+s&&(n=!n)}return n}Object.prototype.hasOwnProperty;var E=new ArrayBuffer(16);new Float64Array(E),new Uint32Array(E);r(5510);!function(){function t(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var r=this.points[e],n=this.points[e+1];this.centers.push({x:(r.x+n.x)/2,y:(r.y+n.y)/2,z:(r.z+n.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(e=0;e<this.centers.length-1;e++){var i=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}t.prototype.cacheSteps=function(t){var e=[],r=this.pos(0);e.push(0);for(var n=0;n<this.duration;n+=10){var i=this.pos(n);Math.sqrt((i.x-r.x)*(i.x-r.x)+(i.y-r.y)*(i.y-r.y)+(i.z-r.z)*(i.z-r.z))>t&&(e.push(n),r=i)}return e},t.prototype.vector=function(t){var e=this.pos(t+10),r=this.pos(t-10);return{angle:180*Math.atan2(e.y-r.y,e.x-r.x)/3.14,speed:Math.sqrt((r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y)+(r.z-e.z)*(r.z-e.z))}},t.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var r=e/this.duration;if(r>=1)return this.points[this.length-1];var n=Math.floor((this.points.length-1)*r);return function(t,e,r,n,i){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:i.x*o[0]+n.x*o[1]+r.x*o[2]+e.x*o[3],y:i.y*o[0]+n.y*o[1]+r.y*o[2]+e.y*o[3],z:i.z*o[0]+n.z*o[1]+r.z*o[2]+e.z*o[3]}}((this.length-1)*r-n,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1])}}();var P=function(t){return function(t,e){void 0===e&&(e={});var r=Number(t[0]),n=Number(t[1]),i=Number(t[2]),o=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[r,n];return a([[s,[i,n],[i,o],[r,o],s]],e.properties,{bbox:t,id:e.id})}(b(t))};var M=function(t,e){void 0===e&&(e={});var r=0,n=0,i=0;return g(t,(function(t){r+=t[0],n+=t[1],i++}),!0),s([r/i,n/i],e.properties)};r(9187);r(1787);var S=function(t,e,r){void 0===r&&(r={});var i=_(t),o=_(e);return o[0]+=o[0]-i[0]>180?-360:i[0]-o[0]>180?360:0,d(function(t,e,r){var i=r=void 0===r?n:Number(r),o=t[1]*Math.PI/180,s=e[1]*Math.PI/180,a=s-o,u=Math.abs(e[0]-t[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);var c=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),l=Math.abs(c)>1e-11?a/c:Math.cos(o);return Math.sqrt(a*a+l*l*u*u)*i}(i,o),"meters",r.units)};var O=Math.PI/180,A=180/Math.PI,T=function(t,e){this.lon=t,this.lat=e,this.x=O*t,this.y=O*e};T.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},T.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new T(e,t)};var k=function(){this.coords=[],this.length=0};k.prototype.move_to=function(t){this.length++,this.coords.push(t)};var C=function(t){this.properties=t||{},this.geometries=[]};C.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},C.prototype.wkt=function(){for(var t="",e="LINESTRING(",r=function(t){e+=t[0]+" "+t[1]+","},n=0;n<this.geometries.length;n++){if(0===this.geometries[n].coords.length)return"LINESTRING(empty)";this.geometries[n].coords.forEach(r),t+=e.substring(0,e.length-1)+")"}return t};var j=function(t,e,r){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new T(t.x,t.y),this.end=new T(e.x,e.y),this.properties=r||{};var n=this.start.x-this.end.x,i=this.start.y-this.end.y,o=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(n/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};j.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),r=Math.sin(t*this.g)/Math.sin(this.g),n=e*Math.cos(this.start.y)*Math.cos(this.start.x)+r*Math.cos(this.end.y)*Math.cos(this.end.x),i=e*Math.cos(this.start.y)*Math.sin(this.start.x)+r*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+r*Math.sin(this.end.y),s=A*Math.atan2(o,Math.sqrt(Math.pow(n,2)+Math.pow(i,2)));return[A*Math.atan2(i,n),s]},j.prototype.Arc=function(t,e){var r=[];if(!t||t<=2)r.push([this.start.lon,this.start.lat]),r.push([this.end.lon,this.end.lat]);else for(var n=1/(t-1),i=0;i<t;++i){var o=n*i,s=this.interpolate(o);r.push(s)}for(var a=!1,u=0,c=e&&e.offset?e.offset:10,l=180-c,h=-180+c,f=360-c,d=1;d<r.length;++d){var p=r[d-1][0],g=r[d][0],m=Math.abs(g-p);m>f&&(g>l&&p<h||p>l&&g<h)?a=!0:m>u&&(u=m)}var y=[];if(a&&u<c){var v=[];y.push(v);for(var b=0;b<r.length;++b){var _=parseFloat(r[b][0]);if(b>0&&Math.abs(_-r[b-1][0])>f){var w=parseFloat(r[b-1][0]),x=parseFloat(r[b-1][1]),E=parseFloat(r[b][0]),P=parseFloat(r[b][1]);if(w>-180&&w<h&&180===E&&b+1<r.length&&r[b-1][0]>-180&&r[b-1][0]<h){v.push([-180,r[b][1]]),b++,v.push([r[b][0],r[b][1]]);continue}if(w>l&&w<180&&-180===E&&b+1<r.length&&r[b-1][0]>l&&r[b-1][0]<180){v.push([180,r[b][1]]),b++,v.push([r[b][0],r[b][1]]);continue}if(w<h&&E>l){var M=w;w=E,E=M;var S=x;x=P,P=S}if(w>l&&E<h&&(E+=360),w<=180&&E>=180&&w<E){var O=(180-w)/(E-w),A=O*P+(1-O)*x;v.push([r[b-1][0]>l?180:-180,A]),(v=[]).push([r[b-1][0]>l?-180:180,A]),y.push(v)}else v=[],y.push(v);v.push([_,r[b][1]])}else v.push([r[b][0],r[b][1]])}}else{var T=[];y.push(T);for(var j=0;j<r.length;++j)T.push([r[j][0],r[j][1]])}for(var I=new C(this.properties),R=0;R<y.length;++R){var L=new k;I.geometries.push(L);for(var D=y[R],F=0;F<D.length;++F)L.move_to(D[F])}return I};r(251);function I(t,e){var r=f(t[1]),n=f(e[1]),i=f(e[0]-t[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var o=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(r/2+Math.PI/4));return(h(Math.atan2(i,o))+360)%360}var R=function(t,e,r){var n;return void 0===r&&(r={}),(n=r.final?I(_(e),_(t)):I(_(t),_(e)))>180?-(360-n):n};var L=function(t,e,r,i){void 0===i&&(i={});var o=e<0,a=d(Math.abs(e),i.units,"meters");o&&(a=-Math.abs(a));var u=_(t),c=function(t,e,r,i){i=void 0===i?n:Number(i);var o=e/i,s=t[0]*Math.PI/180,a=f(t[1]),u=f(r),c=o*Math.cos(u),l=a+c;Math.abs(l)>Math.PI/2&&(l=l>0?Math.PI-l:-Math.PI-l);var h=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),d=Math.abs(h)>1e-11?c/h:Math.cos(a),p=o*Math.sin(u)/d;return[(180*(s+p)/Math.PI+540)%360-180,180*l/Math.PI]}(u,a,r);return c[0]+=c[0]-u[0]>180?-360:u[0]-c[0]>180?360:0,s(c,i.properties)};var D=[],F=[],N=[],B=[],z=[],U=[],V=[],G=[],W=[],Z=[],$=[],X=[],Y=[],H=[],q=[],K=[],Q=[],J=[],tt=[],et=[],rt=[],nt=[],it=[],ot=[];V[85]=Z[85]=-1,G[85]=$[85]=0,W[85]=X[85]=1,tt[85]=nt[85]=1,et[85]=it[85]=0,rt[85]=ot[85]=1,D[85]=B[85]=0,F[85]=z[85]=-1,N[85]=q[85]=0,K[85]=Y[85]=0,Q[85]=H[85]=1,U[85]=J[85]=1,nt[1]=nt[169]=0,it[1]=it[169]=-1,ot[1]=ot[169]=0,Y[1]=Y[169]=-1,H[1]=H[169]=0,q[1]=q[169]=0,Z[4]=Z[166]=0,$[4]=$[166]=-1,X[4]=X[166]=1,K[4]=K[166]=1,Q[4]=Q[166]=0,J[4]=J[166]=0,V[16]=V[154]=0,G[16]=G[154]=1,W[16]=W[154]=1,B[16]=B[154]=1,z[16]=z[154]=0,U[16]=U[154]=1,tt[64]=tt[106]=0,et[64]=et[106]=1,rt[64]=rt[106]=0,D[64]=D[106]=-1,F[64]=F[106]=0,N[64]=N[106]=1,tt[2]=tt[168]=0,et[2]=et[168]=-1,rt[2]=rt[168]=1,nt[2]=nt[168]=0,it[2]=it[168]=-1,ot[2]=ot[168]=0,Y[2]=Y[168]=-1,H[2]=H[168]=0,q[2]=q[168]=0,K[2]=K[168]=-1,Q[2]=Q[168]=0,J[2]=J[168]=1,V[8]=V[162]=0,G[8]=G[162]=-1,W[8]=W[162]=0,Z[8]=Z[162]=0,$[8]=$[162]=-1,X[8]=X[162]=1,Y[8]=Y[162]=1,H[8]=H[162]=0,q[8]=q[162]=1,K[8]=K[162]=1,Q[8]=Q[162]=0,J[8]=J[162]=0,V[32]=V[138]=0,G[32]=G[138]=1,W[32]=W[138]=1,Z[32]=Z[138]=0,$[32]=$[138]=1,X[32]=X[138]=0,D[32]=D[138]=1,F[32]=F[138]=0,N[32]=N[138]=0,B[32]=B[138]=1,z[32]=z[138]=0,U[32]=U[138]=1,nt[128]=nt[42]=0,it[128]=it[42]=1,ot[128]=ot[42]=1,tt[128]=tt[42]=0,et[128]=et[42]=1,rt[128]=rt[42]=0,D[128]=D[42]=-1,F[128]=F[42]=0,N[128]=N[42]=1,B[128]=B[42]=-1,z[128]=z[42]=0,U[128]=U[42]=0,Z[5]=Z[165]=-1,$[5]=$[165]=0,X[5]=X[165]=0,nt[5]=nt[165]=1,it[5]=it[165]=0,ot[5]=ot[165]=0,K[20]=K[150]=0,Q[20]=Q[150]=1,J[20]=J[150]=1,B[20]=B[150]=0,z[20]=z[150]=-1,U[20]=U[150]=1,V[80]=V[90]=-1,G[80]=G[90]=0,W[80]=W[90]=1,tt[80]=tt[90]=1,et[80]=et[90]=0,rt[80]=rt[90]=1,Y[65]=Y[105]=0,H[65]=H[105]=1,q[65]=q[105]=0,D[65]=D[105]=0,F[65]=F[105]=-1,N[65]=N[105]=0,V[160]=V[10]=-1,G[160]=G[10]=0,W[160]=W[10]=1,Z[160]=Z[10]=-1,$[160]=$[10]=0,X[160]=X[10]=0,nt[160]=nt[10]=1,it[160]=it[10]=0,ot[160]=ot[10]=0,tt[160]=tt[10]=1,et[160]=et[10]=0,rt[160]=rt[10]=1,K[130]=K[40]=0,Q[130]=Q[40]=1,J[130]=J[40]=1,Y[130]=Y[40]=0,H[130]=H[40]=1,q[130]=q[40]=0,D[130]=D[40]=0,F[130]=F[40]=-1,N[130]=N[40]=0,B[130]=B[40]=0,z[130]=z[40]=-1,U[130]=U[40]=1,Z[37]=Z[133]=0,$[37]=$[133]=1,X[37]=X[133]=1,nt[37]=nt[133]=0,it[37]=it[133]=1,ot[37]=ot[133]=0,D[37]=D[133]=-1,F[37]=F[133]=0,N[37]=N[133]=0,B[37]=B[133]=1,z[37]=z[133]=0,U[37]=U[133]=0,K[148]=K[22]=-1,Q[148]=Q[22]=0,J[148]=J[22]=0,nt[148]=nt[22]=0,it[148]=it[22]=-1,ot[148]=ot[22]=1,tt[148]=tt[22]=0,et[148]=et[22]=1,rt[148]=rt[22]=1,B[148]=B[22]=-1,z[148]=z[22]=0,U[148]=U[22]=1,V[82]=V[88]=0,G[82]=G[88]=-1,W[82]=W[88]=1,K[82]=K[88]=1,Q[82]=Q[88]=0,J[82]=J[88]=1,Y[82]=Y[88]=-1,H[82]=H[88]=0,q[82]=q[88]=1,tt[82]=tt[88]=0,et[82]=et[88]=-1,rt[82]=rt[88]=0,V[73]=V[97]=0,G[73]=G[97]=1,W[73]=W[97]=0,Z[73]=Z[97]=0,$[73]=$[97]=-1,X[73]=X[97]=0,Y[73]=Y[97]=1,H[73]=H[97]=0,q[73]=q[97]=0,D[73]=D[97]=1,F[73]=F[97]=0,N[73]=N[97]=1,V[145]=V[25]=0,G[145]=G[25]=-1,W[145]=W[25]=0,Y[145]=Y[25]=1,H[145]=H[25]=0,q[145]=q[25]=1,nt[145]=nt[25]=0,it[145]=it[25]=1,ot[145]=ot[25]=1,B[145]=B[25]=-1,z[145]=z[25]=0,U[145]=U[25]=0,Z[70]=Z[100]=0,$[70]=$[100]=1,X[70]=X[100]=0,K[70]=K[100]=-1,Q[70]=Q[100]=0,J[70]=J[100]=1,tt[70]=tt[100]=0,et[70]=et[100]=-1,rt[70]=rt[100]=1,D[70]=D[100]=1,F[70]=F[100]=0,N[70]=N[100]=0,Z[101]=Z[69]=0,$[101]=$[69]=1,X[101]=X[69]=0,D[101]=D[69]=1,F[101]=F[69]=0,N[101]=N[69]=0,nt[149]=nt[21]=0,it[149]=it[21]=1,ot[149]=ot[21]=1,B[149]=B[21]=-1,z[149]=z[21]=0,U[149]=U[21]=0,K[86]=K[84]=-1,Q[86]=Q[84]=0,J[86]=J[84]=1,tt[86]=tt[84]=0,et[86]=et[84]=-1,rt[86]=rt[84]=1,V[89]=V[81]=0,G[89]=G[81]=-1,W[89]=W[81]=0,Y[89]=Y[81]=1,H[89]=H[81]=0,q[89]=q[81]=1,V[96]=V[74]=0,G[96]=G[74]=1,W[96]=W[74]=0,Z[96]=Z[74]=-1,$[96]=$[74]=0,X[96]=X[74]=1,tt[96]=tt[74]=1,et[96]=et[74]=0,rt[96]=rt[74]=0,D[96]=D[74]=1,F[96]=F[74]=0,N[96]=N[74]=1,V[24]=V[146]=0,G[24]=G[146]=-1,W[24]=W[146]=1,K[24]=K[146]=1,Q[24]=Q[146]=0,J[24]=J[146]=1,Y[24]=Y[146]=0,H[24]=H[146]=1,q[24]=q[146]=1,B[24]=B[146]=0,z[24]=z[146]=-1,U[24]=U[146]=0,Z[6]=Z[164]=-1,$[6]=$[164]=0,X[6]=X[164]=1,K[6]=K[164]=-1,Q[6]=Q[164]=0,J[6]=J[164]=0,nt[6]=nt[164]=0,it[6]=it[164]=-1,ot[6]=ot[164]=1,tt[6]=tt[164]=1,et[6]=et[164]=0,rt[6]=rt[164]=0,Y[129]=Y[41]=0,H[129]=H[41]=1,q[129]=q[41]=1,nt[129]=nt[41]=0,it[129]=it[41]=1,ot[129]=ot[41]=0,D[129]=D[41]=-1,F[129]=F[41]=0,N[129]=N[41]=0,B[129]=B[41]=0,z[129]=z[41]=-1,U[129]=U[41]=0,K[66]=K[104]=0,Q[66]=Q[104]=1,J[66]=J[104]=0,Y[66]=Y[104]=-1,H[66]=H[104]=0,q[66]=q[104]=1,tt[66]=tt[104]=0,et[66]=et[104]=-1,rt[66]=rt[104]=0,D[66]=D[104]=0,F[66]=F[104]=-1,N[66]=N[104]=1,V[144]=V[26]=-1,G[144]=G[26]=0,W[144]=W[26]=0,nt[144]=nt[26]=1,it[144]=it[26]=0,ot[144]=ot[26]=1,tt[144]=tt[26]=0,et[144]=et[26]=1,rt[144]=rt[26]=1,B[144]=B[26]=-1,z[144]=z[26]=0,U[144]=U[26]=1,Z[36]=Z[134]=0,$[36]=$[134]=1,X[36]=X[134]=1,K[36]=K[134]=0,Q[36]=Q[134]=1,J[36]=J[134]=0,D[36]=D[134]=0,F[36]=F[134]=-1,N[36]=N[134]=1,B[36]=B[134]=1,z[36]=z[134]=0,U[36]=U[134]=0,V[9]=V[161]=-1,G[9]=G[161]=0,W[9]=W[161]=0,Z[9]=Z[161]=0,$[9]=$[161]=-1,X[9]=X[161]=0,Y[9]=Y[161]=1,H[9]=H[161]=0,q[9]=q[161]=0,nt[9]=nt[161]=1,it[9]=it[161]=0,ot[9]=ot[161]=1,V[136]=0,G[136]=1,W[136]=1,Z[136]=0,$[136]=1,X[136]=0,K[136]=-1,Q[136]=0,J[136]=1,Y[136]=-1,H[136]=0,q[136]=0,nt[136]=0,it[136]=-1,ot[136]=0,tt[136]=0,et[136]=-1,rt[136]=1,D[136]=1,F[136]=0,N[136]=0,B[136]=1,z[136]=0,U[136]=1,V[34]=0,G[34]=-1,W[34]=0,Z[34]=0,$[34]=-1,X[34]=1,K[34]=1,Q[34]=0,J[34]=0,Y[34]=1,H[34]=0,q[34]=1,nt[34]=0,it[34]=1,ot[34]=1,tt[34]=0,et[34]=1,rt[34]=0,D[34]=-1,F[34]=0,N[34]=1,B[34]=-1,z[34]=0,U[34]=0,V[35]=0,G[35]=1,W[35]=1,Z[35]=0,$[35]=-1,X[35]=1,K[35]=1,Q[35]=0,J[35]=0,Y[35]=-1,H[35]=0,q[35]=0,nt[35]=0,it[35]=-1,ot[35]=0,tt[35]=0,et[35]=1,rt[35]=0,D[35]=-1,F[35]=0,N[35]=1,B[35]=1,z[35]=0,U[35]=1,V[153]=0,G[153]=1,W[153]=1,Y[153]=-1,H[153]=0,q[153]=0,nt[153]=0,it[153]=-1,ot[153]=0,B[153]=1,z[153]=0,U[153]=1,Z[102]=0,$[102]=-1,X[102]=1,K[102]=1,Q[102]=0,J[102]=0,tt[102]=0,et[102]=1,rt[102]=0,D[102]=-1,F[102]=0,N[102]=1,V[155]=0,G[155]=-1,W[155]=0,Y[155]=1,H[155]=0,q[155]=1,nt[155]=0,it[155]=1,ot[155]=1,B[155]=-1,z[155]=0,U[155]=0,Z[103]=0,$[103]=1,X[103]=0,K[103]=-1,Q[103]=0,J[103]=1,tt[103]=0,et[103]=-1,rt[103]=1,D[103]=1,F[103]=0,N[103]=0,V[152]=0,G[152]=1,W[152]=1,K[152]=-1,Q[152]=0,J[152]=1,Y[152]=-1,H[152]=0,q[152]=0,nt[152]=0,it[152]=-1,ot[152]=0,tt[152]=0,et[152]=-1,rt[152]=1,B[152]=1,z[152]=0,U[152]=1,V[156]=0,G[156]=-1,W[156]=1,K[156]=1,Q[156]=0,J[156]=1,Y[156]=-1,H[156]=0,q[156]=0,nt[156]=0,it[156]=-1,ot[156]=0,tt[156]=0,et[156]=1,rt[156]=1,B[156]=-1,z[156]=0,U[156]=1,V[137]=0,G[137]=1,W[137]=1,Z[137]=0,$[137]=1,X[137]=0,Y[137]=-1,H[137]=0,q[137]=0,nt[137]=0,it[137]=-1,ot[137]=0,D[137]=1,F[137]=0,N[137]=0,B[137]=1,z[137]=0,U[137]=1,V[139]=0,G[139]=1,W[139]=1,Z[139]=0,$[139]=-1,X[139]=0,Y[139]=1,H[139]=0,q[139]=0,nt[139]=0,it[139]=1,ot[139]=0,D[139]=-1,F[139]=0,N[139]=0,B[139]=1,z[139]=0,U[139]=1,V[98]=0,G[98]=-1,W[98]=0,Z[98]=0,$[98]=-1,X[98]=1,K[98]=1,Q[98]=0,J[98]=0,Y[98]=1,H[98]=0,q[98]=1,tt[98]=0,et[98]=1,rt[98]=0,D[98]=-1,F[98]=0,N[98]=1,V[99]=0,G[99]=1,W[99]=0,Z[99]=0,$[99]=-1,X[99]=1,K[99]=1,Q[99]=0,J[99]=0,Y[99]=-1,H[99]=0,q[99]=1,tt[99]=0,et[99]=-1,rt[99]=0,D[99]=1,F[99]=0,N[99]=1,Z[38]=0,$[38]=-1,X[38]=1,K[38]=1,Q[38]=0,J[38]=0,nt[38]=0,it[38]=1,ot[38]=1,tt[38]=0,et[38]=1,rt[38]=0,D[38]=-1,F[38]=0,N[38]=1,B[38]=-1,z[38]=0,U[38]=0,Z[39]=0,$[39]=1,X[39]=1,K[39]=-1,Q[39]=0,J[39]=0,nt[39]=0,it[39]=-1,ot[39]=1,tt[39]=0,et[39]=1,rt[39]=0,D[39]=-1,F[39]=0,N[39]=1,B[39]=1,z[39]=0,U[39]=0;var st=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},at=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},ut=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},ct=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},lt=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},ht=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},ft=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},dt=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},pt=[],gt=[],mt=[],yt=[],vt=[],bt=[],_t=[],wt=[];yt[1]=vt[1]=18,yt[169]=vt[169]=18,mt[4]=gt[4]=12,mt[166]=gt[166]=12,pt[16]=wt[16]=4,pt[154]=wt[154]=4,bt[64]=_t[64]=22,bt[106]=_t[106]=22,mt[2]=bt[2]=17,yt[2]=vt[2]=18,mt[168]=bt[168]=17,yt[168]=vt[168]=18,pt[8]=yt[8]=9,gt[8]=mt[8]=12,pt[162]=yt[162]=9,gt[162]=mt[162]=12,pt[32]=wt[32]=4,gt[32]=_t[32]=1,pt[138]=wt[138]=4,gt[138]=_t[138]=1,vt[128]=wt[128]=21,bt[128]=_t[128]=22,vt[42]=wt[42]=21,bt[42]=_t[42]=22,gt[5]=vt[5]=14,gt[165]=vt[165]=14,mt[20]=wt[20]=6,mt[150]=wt[150]=6,pt[80]=bt[80]=11,pt[90]=bt[90]=11,yt[65]=_t[65]=3,yt[105]=_t[105]=3,pt[160]=bt[160]=11,gt[160]=vt[160]=14,pt[10]=bt[10]=11,gt[10]=vt[10]=14,mt[130]=wt[130]=6,yt[130]=_t[130]=3,mt[40]=wt[40]=6,yt[40]=_t[40]=3,gt[101]=_t[101]=1,gt[69]=_t[69]=1,vt[149]=wt[149]=21,vt[21]=wt[21]=21,mt[86]=bt[86]=17,mt[84]=bt[84]=17,pt[89]=yt[89]=9,pt[81]=yt[81]=9,pt[96]=_t[96]=0,gt[96]=bt[96]=15,pt[74]=_t[74]=0,gt[74]=bt[74]=15,pt[24]=mt[24]=8,yt[24]=wt[24]=7,pt[146]=mt[146]=8,yt[146]=wt[146]=7,gt[6]=bt[6]=15,mt[6]=vt[6]=16,gt[164]=bt[164]=15,mt[164]=vt[164]=16,yt[129]=wt[129]=7,vt[129]=_t[129]=20,yt[41]=wt[41]=7,vt[41]=_t[41]=20,mt[66]=_t[66]=2,yt[66]=bt[66]=19,mt[104]=_t[104]=2,yt[104]=bt[104]=19,pt[144]=vt[144]=10,bt[144]=wt[144]=23,pt[26]=vt[26]=10,bt[26]=wt[26]=23,gt[36]=wt[36]=5,mt[36]=_t[36]=2,gt[134]=wt[134]=5,mt[134]=_t[134]=2,pt[9]=vt[9]=10,gt[9]=yt[9]=13,pt[161]=vt[161]=10,gt[161]=yt[161]=13,gt[37]=wt[37]=5,vt[37]=_t[37]=20,gt[133]=wt[133]=5,vt[133]=_t[133]=20,mt[148]=vt[148]=16,bt[148]=wt[148]=23,mt[22]=vt[22]=16,bt[22]=wt[22]=23,pt[82]=mt[82]=8,yt[82]=bt[82]=19,pt[88]=mt[88]=8,yt[88]=bt[88]=19,pt[73]=_t[73]=0,gt[73]=yt[73]=13,pt[97]=_t[97]=0,gt[97]=yt[97]=13,pt[145]=yt[145]=9,vt[145]=wt[145]=21,pt[25]=yt[25]=9,vt[25]=wt[25]=21,gt[70]=_t[70]=1,mt[70]=bt[70]=17,gt[100]=_t[100]=1,mt[100]=bt[100]=17,pt[34]=yt[34]=9,gt[34]=mt[34]=12,vt[34]=wt[34]=21,bt[34]=_t[34]=22,pt[136]=wt[136]=4,gt[136]=_t[136]=1,mt[136]=bt[136]=17,yt[136]=vt[136]=18,pt[35]=wt[35]=4,gt[35]=mt[35]=12,yt[35]=vt[35]=18,bt[35]=_t[35]=22,pt[153]=wt[153]=4,yt[153]=vt[153]=18,gt[102]=mt[102]=12,bt[102]=_t[102]=22,pt[155]=yt[155]=9,vt[155]=wt[155]=23,gt[103]=_t[103]=1,mt[103]=bt[103]=17,pt[152]=wt[152]=4,mt[152]=bt[152]=17,yt[152]=vt[152]=18,pt[156]=mt[156]=8,yt[156]=vt[156]=18,bt[156]=wt[156]=23,pt[137]=wt[137]=4,gt[137]=_t[137]=1,yt[137]=vt[137]=18,pt[139]=wt[139]=4,gt[139]=yt[139]=13,vt[139]=_t[139]=20,pt[98]=yt[98]=9,gt[98]=mt[98]=12,bt[98]=_t[98]=22,pt[99]=_t[99]=0,gt[99]=mt[99]=12,yt[99]=bt[99]=19,gt[38]=mt[38]=12,vt[38]=wt[38]=21,bt[38]=_t[38]=22,gt[39]=wt[39]=5,mt[39]=vt[39]=16,bt[39]=_t[39]=22;var xt=[];xt[1]=xt[169]=st,xt[4]=xt[166]=at,xt[16]=xt[154]=ut,xt[64]=xt[106]=ct,xt[168]=xt[2]=lt,xt[162]=xt[8]=ht,xt[138]=xt[32]=ft,xt[42]=xt[128]=dt,xt[5]=xt[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},xt[20]=xt[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},xt[80]=xt[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},xt[65]=xt[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},xt[160]=xt[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},xt[130]=xt[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},xt[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},xt[101]=xt[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},xt[149]=xt[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},xt[86]=xt[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},xt[89]=xt[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},xt[96]=xt[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},xt[24]=xt[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},xt[6]=xt[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},xt[129]=xt[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},xt[66]=xt[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},xt[144]=xt[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},xt[36]=xt[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},xt[9]=xt[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},xt[37]=xt[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},xt[148]=xt[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},xt[82]=xt[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},xt[73]=xt[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},xt[145]=xt[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},xt[70]=xt[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},xt[34]=function(t){return[dt(t),ht(t)]},xt[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},xt[136]=function(t){return[ft(t),lt(t)]},xt[153]=function(t){return[ut(t),st(t)]},xt[102]=function(t){return[at(t),ct(t)]},xt[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},xt[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},xt[152]=function(t){return[ut(t),lt(t)]},xt[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},xt[137]=function(t){return[ft(t),st(t)]},xt[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},xt[98]=function(t){return[ht(t),ct(t)]},xt[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},xt[38]=function(t){return[at(t),dt(t)]},xt[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};function Et(t){var e={type:"Feature"};return Object.keys(t).forEach((function(r){switch(r){case"type":case"properties":case"geometry":return;default:e[r]=t[r]}})),e.properties=Pt(t.properties),e.geometry=Mt(t.geometry),e}function Pt(t){var e={};return t?(Object.keys(t).forEach((function(r){var n=t[r];"object"===typeof n?null===n?e[r]=null:Array.isArray(n)?e[r]=n.map((function(t){return t})):e[r]=Pt(n):e[r]=n})),e):e}function Mt(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return Mt(t)})),e):(e.coordinates=St(t.coordinates),e)}function St(t){var e=t;return"object"!==typeof e[0]?e.slice():e.map((function(t){return St(t)}))}var Ot=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return Et(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(r){switch(r){case"type":case"features":return;default:e[r]=t[r]}})),e.features=t.features.map((function(t){return Et(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Mt(t);default:throw new Error("unknown GeoJSON type")}};var At=function(t,e,r){if(!(n=r=r||{})||n.constructor!==Object)throw new Error("options is invalid");var n,i=r.pivot,o=r.mutate;if(!t)throw new Error("geojson is required");if(void 0===e||null===e||isNaN(e))throw new Error("angle is required");return 0===e||(i||(i=M(t)),!1!==o&&void 0!==o||(t=Ot(t)),g(t,(function(t){var r=R(i,t)+e,n=S(i,t),o=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(L(i,n,r));t[0]=o[0],t[1]=o[1]}))),t};function Tt(t,e,r){var n,i=e[0]-t[0],o=e[1]-t[1],s=r[0]-e[0],a=r[1]-e[1];return((n=i*a-s*o)>0)-(n<0)||+n}function kt(t,e){return e.geometry.coordinates[0].every((function(e){return w(s(e),t)}))}var Ct=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return t.buildId=function(t){return t.join(",")},t.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},t.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},t.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,r){var n=e.to,i=r.to;if(n.coordinates[0]-t.coordinates[0]>=0&&i.coordinates[0]-t.coordinates[0]<0)return 1;if(n.coordinates[0]-t.coordinates[0]<0&&i.coordinates[0]-t.coordinates[0]>=0)return-1;if(n.coordinates[0]-t.coordinates[0]===0&&i.coordinates[0]-t.coordinates[0]===0)return n.coordinates[1]-t.coordinates[1]>=0||i.coordinates[1]-t.coordinates[1]>=0?n.coordinates[1]-i.coordinates[1]:i.coordinates[1]-n.coordinates[1];var o=Tt(t.coordinates,n.coordinates,i.coordinates);return o<0?1:o>0?-1:Math.pow(n.coordinates[0]-t.coordinates[0],2)+Math.pow(n.coordinates[1]-t.coordinates[1],2)-(Math.pow(i.coordinates[0]-t.coordinates[0],2)+Math.pow(i.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},t.prototype.addInnerEdge=function(t){this.innerEdges.push(t)},t}(),jt=function(){function t(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return u([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(t){return Tt(t.from.coordinates,t.to.coordinates,this.to.coordinates)},t}(),It=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return t.prototype.push=function(t){this.edges.push(t),this.polygon=this.envelope=void 0},t.prototype.get=function(t){return this.edges[t]},Object.defineProperty(t.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.edges.forEach(t)},t.prototype.map=function(t){return this.edges.map(t)},t.prototype.some=function(t){return this.edges.some(t)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,r,n){return r.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=n),e}),0),r=(0===e?this.length:e)-1,n=(e+1)%this.length,i=Tt(this.edges[r].from.coordinates,this.edges[e].from.coordinates,this.edges[n].from.coordinates);return 0===i?this.edges[r].from.coordinates[0]>this.edges[n].from.coordinates[0]:i>0},t.prototype.toMultiPoint=function(){return c(this.edges.map((function(t){return t.from.coordinates})))},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=a([t])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=P(this.toPolygon())},t.findEdgeRingContaining=function(t,e){var r,n,i=t.getEnvelope();return e.forEach((function(e){var o=e.getEnvelope();if(n&&(r=n.getEnvelope()),!function(t,e){var r=t.geometry.coordinates[0].map((function(t){return t[0]})),n=t.geometry.coordinates[0].map((function(t){return t[1]})),i=e.geometry.coordinates[0].map((function(t){return t[0]})),o=e.geometry.coordinates[0].map((function(t){return t[1]}));return Math.max.apply(null,r)===Math.max.apply(null,i)&&Math.max.apply(null,n)===Math.max.apply(null,o)&&Math.min.apply(null,r)===Math.min.apply(null,i)&&Math.min.apply(null,n)===Math.min.apply(null,o)}(o,i)&&kt(o,i)){for(var a=t.map((function(t){return t.from.coordinates})),u=void 0,c=function(t){e.some((function(e){return r=t,n=e.from.coordinates,r[0]===n[0]&&r[1]===n[1];var r,n}))||(u=t)},l=0,h=a;l<h.length;l++){c(h[l])}u&&e.inside(s(u))&&(n&&!kt(r,o)||(n=e))}})),n},t.prototype.inside=function(t){return w(t,this.toPolygon())},t}();!function(){function t(){this.edges=[],this.nodes={}}t.fromGeoJson=function(e){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var r=new t;return y(e,(function(t){!function(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)}(t,"LineString","Graph::fromGeoJson"),function(t,e,r,n){var i=r;g(t,(function(t,n,o,s,a){i=0===n&&void 0===r?t:e(i,t,n,o,s,a)}),n)}(t,(function(t,e){if(t){var n=r.getNode(t),i=r.getNode(e);r.addEdge(n,i)}return e}))})),r},t.prototype.getNode=function(t){var e=Ct.buildId(t),r=this.nodes[e];return r||(r=this.nodes[e]=new Ct(t)),r},t.prototype.addEdge=function(t,e){var r=new jt(t,e),n=r.getSymetric();this.edges.push(r),this.edges.push(n)},t.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},t.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var r=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),r.forEach((function(t){return e._removeIfDangle(t)}))}},t.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},t.prototype._computeNextCWEdges=function(t){var e=this;"undefined"===typeof t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,r){t.getOuterEdge((0===r?t.getOuterEdges().length:r)-1).symetric.next=e}))},t.prototype._computeNextCCWEdges=function(t,e){for(var r,n,i=t.getOuterEdges(),o=i.length-1;o>=0;--o){var s=i[o],a=s.symetric,u=void 0,c=void 0;s.label===e&&(u=s),a.label===e&&(c=a),u&&c&&(c&&(n=c),u&&(n&&(n.next=u,n=void 0),r||(r=u)))}n&&(n.next=r)},t.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(r){if(!(r.label>=0)){t.push(r);var n=r;do{n.label=e,n=n.next}while(!r.isEqual(n));e++}})),t},t.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(r){t._computeNextCCWEdges(r,e.label)}))}));var e=[];return this.edges.forEach((function(r){r.ring||e.push(t._findEdgeRing(r))})),e},t.prototype._findIntersectionNodes=function(t){var e=[],r=t,n=function(){var n=0;r.from.getOuterEdges().forEach((function(e){e.label===t.label&&++n})),n>1&&e.push(r.from),r=r.next};do{n()}while(!t.isEqual(r));return e},t.prototype._findEdgeRing=function(t){var e=t,r=new It;do{r.push(e),e.ring=r,e=e.next}while(!t.isEqual(e));return r},t.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},t.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()}}();r(9657);r(2606);r(1160);function Rt(t){for(var e=t,r=[];e.parent;)r.unshift(e),e=e.parent;return r}var Lt={search:function(t,e,r,n){t.cleanDirty();var i=(n=n||{}).heuristic||Lt.heuristics.manhattan,o=n.closest||!1,s=new Nt((function(t){return t.f})),a=e;for(e.h=i(e,r),s.push(e);s.size()>0;){var u=s.pop();if(u===r)return Rt(u);u.closed=!0;for(var c=t.neighbors(u),l=0,h=c.length;l<h;++l){var f=c[l];if(!f.closed&&!f.isWall()){var d=u.g+f.getCost(u),p=f.visited;(!p||d<f.g)&&(f.visited=!0,f.parent=u,f.h=f.h||i(f,r),f.g=d,f.f=f.g+f.h,t.markDirty(f),o&&(f.h<a.h||f.h===a.h&&f.g<a.g)&&(a=f),p?s.rescoreElement(f):s.push(f))}}}return o?Rt(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var r=Math.sqrt(2),n=Math.abs(e.x-t.x),i=Math.abs(e.y-t.y);return 1*(n+i)+(r-2)*Math.min(n,i)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function Dt(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var r=0;r<t.length;r++){this.grid[r]=[];for(var n=0,i=t[r];n<i.length;n++){var o=new Ft(r,n,i[n]);this.grid[r][n]=o,this.nodes.push(o)}}this.init()}function Ft(t,e,r){this.x=t,this.y=e,this.weight=r}function Nt(t){this.content=[],this.scoreFunction=t}Dt.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)Lt.cleanNode(this.nodes[t])},Dt.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)Lt.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},Dt.prototype.markDirty=function(t){this.dirtyNodes.push(t)},Dt.prototype.neighbors=function(t){var e=[],r=t.x,n=t.y,i=this.grid;return i[r-1]&&i[r-1][n]&&e.push(i[r-1][n]),i[r+1]&&i[r+1][n]&&e.push(i[r+1][n]),i[r]&&i[r][n-1]&&e.push(i[r][n-1]),i[r]&&i[r][n+1]&&e.push(i[r][n+1]),this.diagonal&&(i[r-1]&&i[r-1][n-1]&&e.push(i[r-1][n-1]),i[r+1]&&i[r+1][n-1]&&e.push(i[r+1][n-1]),i[r-1]&&i[r-1][n+1]&&e.push(i[r-1][n+1]),i[r+1]&&i[r+1][n+1]&&e.push(i[r+1][n+1])),e},Dt.prototype.toString=function(){for(var t,e,r,n,i=[],o=this.grid,s=0,a=o.length;s<a;s++){for(t=[],r=0,n=(e=o[s]).length;r<n;r++)t.push(e[r].weight);i.push(t.join(" "))}return i.join("\n")},Ft.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Ft.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},Ft.prototype.isWall=function(){return 0===this.weight},Nt.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),r=this.content.pop();e!==this.content.length-1&&(this.content[e]=r,this.scoreFunction(r)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var r=(t+1>>1)-1,n=this.content[r];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[r]=e,this.content[t]=n,t=r}},bubbleUp:function(t){for(var e=this.content.length,r=this.content[t],n=this.scoreFunction(r);;){var i,o=t+1<<1,s=o-1,a=null;if(s<e){var u=this.content[s];(i=this.scoreFunction(u))<n&&(a=s)}if(o<e){var c=this.content[o];this.scoreFunction(c)<(null===a?n:i)&&(a=o)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=r,t=a}}};function Bt(){this._=null}function zt(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Ut(t,e){var r=e,n=e.R,i=r.U;i?i.L===r?i.L=n:i.R=n:t._=n,n.U=i,r.U=n,r.R=n.L,r.R&&(r.R.U=r),n.L=r}function Vt(t,e){var r=e,n=e.L,i=r.U;i?i.L===r?i.L=n:i.R=n:t._=n,n.U=i,r.U=n,r.L=n.R,r.L&&(r.L.U=r),n.R=r}function Gt(t){for(;t.L;)t=t.L;return t}Bt.prototype={constructor:Bt,insert:function(t,e){var r,n,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;r=t}else this._?(t=Gt(this._),e.P=null,e.N=t,t.P=t.L=e,r=t):(e.P=e.N=null,this._=e,r=null);for(e.L=e.R=null,e.U=r,e.C=!0,t=e;r&&r.C;)r===(n=r.U).L?(i=n.R)&&i.C?(r.C=i.C=!1,n.C=!0,t=n):(t===r.R&&(Ut(this,r),r=(t=r).U),r.C=!1,n.C=!0,Vt(this,n)):(i=n.L)&&i.C?(r.C=i.C=!1,n.C=!0,t=n):(t===r.L&&(Vt(this,r),r=(t=r).U),r.C=!1,n.C=!0,Ut(this,n)),r=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,r,n,i=t.U,o=t.L,s=t.R;if(r=o?s?Gt(s):o:s,i?i.L===t?i.L=r:i.R=r:this._=r,o&&s?(n=r.C,r.C=t.C,r.L=o,o.U=r,r!==s?(i=r.U,r.U=t.U,t=r.R,i.L=t,r.R=s,s.U=r):(r.U=i,i=r,t=r.R)):(n=t.C,t=r),t&&(t.U=i),!n)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,Ut(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Vt(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Ut(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,Vt(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Ut(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,Vt(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var Wt=Bt;function Zt(t,e,r,n){var i=[null,null],o=ge.push(i)-1;return i.left=t,i.right=e,r&&Xt(i,t,e,r),n&&Xt(i,e,t,n),de[t.index].halfedges.push(o),de[e.index].halfedges.push(o),i}function $t(t,e,r){var n=[e,r];return n.left=t,n}function Xt(t,e,r,n){t[0]||t[1]?t.left===r?t[1]=n:t[0]=n:(t[0]=n,t.left=e,t.right=r)}function Yt(t,e,r,n,i){var o,s=t[0],a=t[1],u=s[0],c=s[1],l=0,h=1,f=a[0]-u,d=a[1]-c;if(o=e-u,f||!(o>0)){if(o/=f,f<0){if(o<l)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>l&&(l=o)}if(o=n-u,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>l&&(l=o)}else if(f>0){if(o<l)return;o<h&&(h=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<l)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>l&&(l=o)}if(o=i-c,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>l&&(l=o)}else if(d>0){if(o<l)return;o<h&&(h=o)}return!(l>0||h<1)||(l>0&&(t[0]=[u+l*f,c+l*d]),h<1&&(t[1]=[u+h*f,c+h*d]),!0)}}}}}function Ht(t,e,r,n,i){var o=t[1];if(o)return!0;var s,a,u=t[0],c=t.left,l=t.right,h=c[0],f=c[1],d=l[0],p=l[1],g=(h+d)/2,m=(f+p)/2;if(p===f){if(g<e||g>=n)return;if(h>d){if(u){if(u[1]>=i)return}else u=[g,r];o=[g,i]}else{if(u){if(u[1]<r)return}else u=[g,i];o=[g,r]}}else if(a=m-(s=(h-d)/(p-f))*g,s<-1||s>1)if(h>d){if(u){if(u[1]>=i)return}else u=[(r-a)/s,r];o=[(i-a)/s,i]}else{if(u){if(u[1]<r)return}else u=[(i-a)/s,i];o=[(r-a)/s,r]}else if(f<p){if(u){if(u[0]>=n)return}else u=[e,s*e+a];o=[n,s*n+a]}else{if(u){if(u[0]<e)return}else u=[n,s*n+a];o=[e,s*e+a]}return t[0]=u,t[1]=o,!0}function qt(t,e){var r=t.site,n=e.left,i=e.right;return r===i&&(i=n,n=r),i?Math.atan2(i[1]-n[1],i[0]-n[0]):(r===n?(n=e[1],i=e[0]):(n=e[0],i=e[1]),Math.atan2(n[0]-i[0],i[1]-n[1]))}function Kt(t,e){return e[+(e.left!==t.site)]}function Qt(t,e){return e[+(e.left===t.site)]}var Jt,te=[];function ee(){zt(this),this.x=this.y=this.arc=this.site=this.cy=null}function re(t){var e=t.P,r=t.N;if(e&&r){var n=e.site,i=t.site,o=r.site;if(n!==o){var s=i[0],a=i[1],u=n[0]-s,c=n[1]-a,l=o[0]-s,h=o[1]-a,f=2*(u*h-c*l);if(!(f>=-ye)){var d=u*u+c*c,p=l*l+h*h,g=(h*d-c*p)/f,m=(u*p-l*d)/f,y=te.pop()||new ee;y.arc=t,y.site=i,y.x=g+s,y.y=(y.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=y;for(var v=null,b=pe._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(!b.L){v=b.P;break}b=b.L}else{if(!b.R){v=b;break}b=b.R}pe.insert(v,y),v||(Jt=y)}}}}function ne(t){var e=t.circle;e&&(e.P||(Jt=e.N),pe.remove(e),te.push(e),zt(e),t.circle=null)}var ie=[];function oe(){zt(this),this.edge=this.site=this.circle=null}function se(t){var e=ie.pop()||new oe;return e.site=t,e}function ae(t){ne(t),fe.remove(t),ie.push(t),zt(t)}function ue(t){var e=t.circle,r=e.x,n=e.cy,i=[r,n],o=t.P,s=t.N,a=[t];ae(t);for(var u=o;u.circle&&Math.abs(r-u.circle.x)<me&&Math.abs(n-u.circle.cy)<me;)o=u.P,a.unshift(u),ae(u),u=o;a.unshift(u),ne(u);for(var c=s;c.circle&&Math.abs(r-c.circle.x)<me&&Math.abs(n-c.circle.cy)<me;)s=c.N,a.push(c),ae(c),c=s;a.push(c),ne(c);var l,h=a.length;for(l=1;l<h;++l)c=a[l],u=a[l-1],Xt(c.edge,u.site,c.site,i);u=a[0],(c=a[h-1]).edge=Zt(u.site,c.site,null,i),re(u),re(c)}function ce(t){for(var e,r,n,i,o=t[0],s=t[1],a=fe._;a;)if((n=le(a,s)-o)>me)a=a.L;else{if(!((i=o-he(a,s))>me)){n>-me?(e=a.P,r=a):i>-me?(e=a,r=a.N):e=r=a;break}if(!a.R){e=a;break}a=a.R}!function(t){de[t.index]={site:t,halfedges:[]}}(t);var u=se(t);if(fe.insert(e,u),e||r){if(e===r)return ne(e),r=se(e.site),fe.insert(u,r),u.edge=r.edge=Zt(e.site,u.site),re(e),void re(r);if(r){ne(e),ne(r);var c=e.site,l=c[0],h=c[1],f=t[0]-l,d=t[1]-h,p=r.site,g=p[0]-l,m=p[1]-h,y=2*(f*m-d*g),v=f*f+d*d,b=g*g+m*m,_=[(m*v-d*b)/y+l,(f*b-g*v)/y+h];Xt(r.edge,c,p,_),u.edge=Zt(c,t,null,_),r.edge=Zt(t,p,null,_),re(e),re(r)}else u.edge=Zt(e.site,u.site)}}function le(t,e){var r=t.site,n=r[0],i=r[1],o=i-e;if(!o)return n;var s=t.P;if(!s)return-1/0;var a=(r=s.site)[0],u=r[1],c=u-e;if(!c)return a;var l=a-n,h=1/o-1/c,f=l/c;return h?(-f+Math.sqrt(f*f-2*h*(l*l/(-2*c)-u+c/2+i-o/2)))/h+n:(n+a)/2}function he(t,e){var r=t.N;if(r)return le(r,e);var n=t.site;return n[1]===e?n[0]:1/0}var fe,de,pe,ge,me=1e-6,ye=1e-12;function ve(t,e,r){return(t[0]-r[0])*(e[1]-t[1])-(t[0]-e[0])*(r[1]-t[1])}function be(t,e){return e[1]-t[1]||e[0]-t[0]}function _e(t,e){var r,n,i,o=t.sort(be).pop();for(ge=[],de=new Array(t.length),fe=new Wt,pe=new Wt;;)if(i=Jt,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===r&&o[1]===n||(ce(o),r=o[0],n=o[1]),o=t.pop();else{if(!i)break;ue(i.arc)}if(function(){for(var t,e,r,n,i=0,o=de.length;i<o;++i)if((t=de[i])&&(n=(e=t.halfedges).length)){var s=new Array(n),a=new Array(n);for(r=0;r<n;++r)s[r]=r,a[r]=qt(t,ge[e[r]]);for(s.sort((function(t,e){return a[e]-a[t]})),r=0;r<n;++r)a[r]=e[s[r]];for(r=0;r<n;++r)e[r]=a[r]}}(),e){var s=+e[0][0],a=+e[0][1],u=+e[1][0],c=+e[1][1];!function(t,e,r,n){for(var i,o=ge.length;o--;)Ht(i=ge[o],t,e,r,n)&&Yt(i,t,e,r,n)&&(Math.abs(i[0][0]-i[1][0])>me||Math.abs(i[0][1]-i[1][1])>me)||delete ge[o]}(s,a,u,c),function(t,e,r,n){var i,o,s,a,u,c,l,h,f,d,p,g,m=de.length,y=!0;for(i=0;i<m;++i)if(o=de[i]){for(s=o.site,a=(u=o.halfedges).length;a--;)ge[u[a]]||u.splice(a,1);for(a=0,c=u.length;a<c;)p=(d=Qt(o,ge[u[a]]))[0],g=d[1],h=(l=Kt(o,ge[u[++a%c]]))[0],f=l[1],(Math.abs(p-h)>me||Math.abs(g-f)>me)&&(u.splice(a,0,ge.push($t(s,d,Math.abs(p-t)<me&&n-g>me?[t,Math.abs(h-t)<me?f:n]:Math.abs(g-n)<me&&r-p>me?[Math.abs(f-n)<me?h:r,n]:Math.abs(p-r)<me&&g-e>me?[r,Math.abs(h-r)<me?f:e]:Math.abs(g-e)<me&&p-t>me?[Math.abs(f-e)<me?h:t,e]:null))-1),++c);c&&(y=!1)}if(y){var v,b,_,w=1/0;for(i=0,y=null;i<m;++i)(o=de[i])&&(_=(v=(s=o.site)[0]-t)*v+(b=s[1]-e)*b)<w&&(w=_,y=o);if(y){var x=[t,e],E=[t,n],P=[r,n],M=[r,e];y.halfedges.push(ge.push($t(s=y.site,x,E))-1,ge.push($t(s,E,P))-1,ge.push($t(s,P,M))-1,ge.push($t(s,M,x))-1)}}for(i=0;i<m;++i)(o=de[i])&&(o.halfedges.length||delete de[i])}(s,a,u,c)}this.edges=ge,this.cells=de,fe=pe=ge=de=null}_e.prototype={constructor:_e,polygons:function(){var t=this.edges;return this.cells.map((function(e){var r=e.halfedges.map((function(r){return Kt(e,t[r])}));return r.data=e.site.data,r}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(r,n){if(o=(i=r.halfedges).length)for(var i,o,s,a=r.site,u=-1,c=e[i[o-1]],l=c.left===a?c.right:c.left;++u<o;)s=l,l=(c=e[i[u]]).left===a?c.right:c.left,s&&l&&n<s.index&&n<l.index&&ve(a,s,l)<0&&t.push([a.data,s.data,l.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,r){for(var n,i,o=this,s=o._found||0,a=o.cells.length;!(i=o.cells[s]);)if(++s>=a)return null;var u=t-i.site[0],c=e-i.site[1],l=u*u+c*c;do{i=o.cells[n=s],s=null,i.halfedges.forEach((function(r){var n=o.edges[r],a=n.left;if(a!==i.site&&a||(a=n.right)){var u=t-a[0],c=e-a[1],h=u*u+c*c;h<l&&(l=h,s=a.index)}}))}while(null!==s);return o._found=n,null==r||l<=r*r?i.site:null}};r(2676);r(675);function we(){return new xe}function xe(){this.reset()}xe.prototype={constructor:xe,reset:function(){this.s=this.t=0},add:function(t){Pe(Ee,t,this.t),Pe(this,Ee.s,this.s),this.s?this.t+=Ee.t:this.s=Ee.t},valueOf:function(){return this.s}};var Ee=new xe;function Pe(t,e,r){var n=t.s=e+r,i=n-e,o=n-i;t.t=e-o+(r-i)}var Me=1e-6,Se=Math.PI,Oe=Se/2,Ae=Se/4,Te=2*Se,ke=Se/180,Ce=Math.abs,je=Math.atan,Ie=Math.atan2,Re=Math.cos,Le=(Math.ceil,Math.exp),De=(Math.floor,Math.log),Fe=(Math.pow,Math.sin),Ne=(Math.sign,Math.sqrt),Be=Math.tan;function ze(t){return t>1?Oe:t<-1?-Oe:Math.asin(t)}function Ue(){}we(),we();function Ve(t){var e=t[0],r=t[1],n=Re(r);return[n*Re(e),n*Fe(e),Fe(r)]}function Ge(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function We(t){var e=Ne(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}we();function Ze(t,e){return[t>Se?t-Te:t<-Se?t+Te:t,e]}function $e(t,e,r,n){this.x=t,this.z=e,this.o=r,this.e=n,this.v=!1,this.n=this.p=null}function Xe(t,e,r,n,i){var o,s,a=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,r,n=t[0],s=t[e];if(l=s,Ce((c=n)[0]-l[0])<Me&&Ce(c[1]-l[1])<Me){for(i.lineStart(),o=0;o<e;++o)i.point((n=t[o])[0],n[1]);i.lineEnd()}else{var c,l;a.push(r=new $e(n,t,null,!0)),u.push(r.o=new $e(n,null,r,!1)),a.push(r=new $e(s,t,null,!1)),u.push(r.o=new $e(s,null,r,!0))}}})),a.length){for(u.sort(e),Ye(a),Ye(u),o=0,s=u.length;o<s;++o)u[o].e=r=!r;for(var c,l,h=a[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(o=0,s=c.length;o<s;++o)i.point((l=c[o])[0],l[1]);else n(f.x,f.n.x,1,i);f=f.n}else{if(d)for(c=f.p.z,o=c.length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else n(f.x,f.p.x,-1,i);f=f.p}c=(f=f.o).z,d=!d}while(!f.v);i.lineEnd()}}}function Ye(t){if(e=t.length){for(var e,r,n=0,i=t[0];++n<e;)i.n=r=t[n],r.p=i,i=r;i.n=r=t[0],r.p=i}}function He(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Ze.invert=Ze;var qe=function(t){var e;return 1===t.length&&(e=t,t=function(t,r){return He(e(t),r)}),{left:function(e,r,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){var o=n+i>>>1;t(e[o],r)<0?n=o+1:i=o}return n},right:function(e,r,n,i){for(null==n&&(n=0),null==i&&(i=e.length);n<i;){var o=n+i>>>1;t(e[o],r)>0?i=o:n=o+1}return n}}}(He),Ke=(qe.right,qe.left,Array.prototype);Ke.slice,Ke.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var Qe=we();function Je(t,e){var r=e[0],n=e[1],i=[Fe(r),-Re(r),0],o=0,s=0;Qe.reset();for(var a=0,u=t.length;a<u;++a)if(l=(c=t[a]).length)for(var c,l,h=c[l-1],f=h[0],d=h[1]/2+Ae,p=Fe(d),g=Re(d),m=0;m<l;++m,f=v,p=_,g=w,h=y){var y=c[m],v=y[0],b=y[1]/2+Ae,_=Fe(b),w=Re(b),x=v-f,E=x>=0?1:-1,P=E*x,M=P>Se,S=p*_;if(Qe.add(Ie(S*E*Fe(P),g*w+S*Re(P))),o+=M?x+E*Te:x,M^f>=r^v>=r){var O=Ge(Ve(h),Ve(y));We(O);var A=Ge(i,O);We(A);var T=(M^x>=0?-1:1)*ze(A[2]);(n>T||n===T&&(O[0]||O[1]))&&(s+=M^x>=0?1:-1)}}return(o<-1e-6||o<Me&&Qe<-1e-6)^1&s}we();we(),we();we();function tr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function er(t){return t.length>1}function rr(t,e){return((t=t.x)[0]<0?t[1]-Oe-Me:Oe-t[1])-((e=e.x)[0]<0?e[1]-Oe-Me:Oe-e[1])}tr(4.5);function nr(t){return function(e){var r=new ir;for(var n in t)r[n]=t[n];return r.stream=e,r}}function ir(){}ir.prototype={constructor:ir,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};Re(30*ke);nr({point:function(t,e){this.stream.point(t*ke,e*ke)}});function or(t){return function(e,r){var n=Re(e),i=Re(r),o=t(n*i);return[o*i*Fe(e),o*Fe(r)]}}function sr(t){return function(e,r){var n=Ne(e*e+r*r),i=t(n),o=Fe(i),s=Re(i);return[Ie(e*o,n*s),ze(n&&r*o/n)]}}var ar=or((function(t){return Ne(2/(1+t))}));ar.invert=sr((function(t){return 2*ze(t/2)}));var ur=or((function(t){return(t=(e=t)>1?0:e<-1?Se:Math.acos(e))&&t/Fe(t);var e}));function cr(t,e){return[t,De(Be((Oe+e)/2))]}function lr(t,e){return[t,e]}function hr(t,e){var r=Re(e),n=Re(t)*r;return[r*Fe(t)/n,Fe(e)/n]}function fr(t,e){var r=e*e,n=r*r;return[t*(.8707-.131979*r+n*(n*(.003971*r-.001529*n)-.013791)),e*(1.007226+r*(.015085+n*(.028874*r-.044475-.005916*n)))]}function dr(t,e){return[Re(e)*Fe(t),Fe(e)]}function pr(t,e){var r=Re(e),n=1+Re(t)*r;return[r*Fe(t)/n,Fe(e)/n]}function gr(t,e){return[De(Be((Oe+e)/2)),-t]}ur.invert=sr((function(t){return t})),cr.invert=function(t,e){return[t,2*je(Le(e))-Oe]},lr.invert=lr,hr.invert=sr(je),fr.invert=function(t,e){var r,n=e,i=25;do{var o=n*n,s=o*o;n-=r=(n*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(Ce(r)>Me&&--i>0);return[t/(.8707+(o=n*n)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),n]},dr.invert=sr(ze),pr.invert=sr((function(t){return 2*je(t)})),gr.invert=function(t,e){return[-e,2*je(Le(t))-Oe]}},6586:function(t,e,r){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.d(e,{Z:function(){return n}})},318:function(t,e,r){"use strict";r.d(e,{Z:function(){return i}});var n=r(6988);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(t);!(s=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);s=!0);}catch(u){a=!0,i=u}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}(t,e)||(0,n.Z)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},3789:function(t,e,r){"use strict";r.d(e,{Z:function(){return o}});var n=r(6586);var i=r(6988);function o(t){return function(t){if(Array.isArray(t))return(0,n.Z)(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||(0,i.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},6988:function(t,e,r){"use strict";r.d(e,{Z:function(){return i}});var n=r(6586);function i(t,e){if(t){if("string"===typeof t)return(0,n.Z)(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(t,e):void 0}}}}]);