(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{6665:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return k}});var n=o(9008),i=o(9163),r=o(318),a=o(2809),s=o(3789),c=o(9636),l=o(6537),u=o(7698),p=(o(724),o(7294)),d=o(8782),f=o(5893);function m(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function h(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?m(Object(o),!0).forEach((function(t){(0,a.Z)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):m(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var g=15,y=function(){var e=(0,p.useState)(),t=e[0],o=e[1],n=(0,p.useState)({type:"FeatureCollection",features:[]}),i=n[0],a=n[1],m=(0,p.useState)({type:"FeatureCollection",features:[]}),y=m[0],x=m[1],b=(0,p.useState)({type:"FeatureCollection",features:[]}),w=b[0],j=b[1],P=(0,p.useState)({type:"FeatureCollection",features:[]}),v=P[0],_=P[1],C=(0,p.useState)({latitude:35.610493335927146,longitude:139.70963079522326,zoom:11.548058916916952,pitch:56.12617658004021,maxPitch:70}),F=C[0],z=C[1],D=(0,p.useMemo)((function(){return[{id:"sky",type:"sky",paint:{"sky-type":"atmosphere","sky-atmosphere-sun":[0,0],"sky-atmosphere-sun-intensity":15}},{id:"add-3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:g,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],g,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],g,0,15.05,["get","min_height"]]}}]}),[]),k="vector-road",O=(0,p.useMemo)((function(){return[{id:k,source:{type:"vector",url:"mapbox://mapbox.mapbox-streets-v8"},layer:{"source-layer":"road",type:"line",filter:["in","class","trunk","primary"],paint:{"line-width":0}}},{id:"cars-shadow",source:{type:"geojson",data:v},layer:{type:"fill-extrusion",minzoom:g,paint:{"fill-extrusion-color":"#888","fill-extrusion-height":0}}},{id:"cars",source:{type:"geojson",data:w},layer:{type:"fill-extrusion",minzoom:g,paint:{"fill-extrusion-color":"red","fill-extrusion-height":["interpolate",["linear"],["zoom"],g,3,20,.75]}}},{id:"cars-point",source:{type:"geojson",data:w},layer:{type:"circle",maxzoom:g,paint:{"circle-radius":2,"circle-stroke-color":"red","circle-color":"white","circle-stroke-width":1}}},{id:"people-shadow",source:{type:"geojson",data:y},layer:{type:"fill-extrusion",minzoom:g,paint:{"fill-extrusion-color":"#888","fill-extrusion-height":0}}},{id:"people",source:{type:"geojson",data:i},layer:{type:"fill-extrusion",minzoom:g,paint:{"fill-extrusion-color":"#0084ff","fill-extrusion-height":["interpolate",["linear"],["zoom"],g,3,20,.75]}}},{id:"people-point",source:{type:"geojson",data:i},layer:{type:"circle",maxzoom:g,paint:{"circle-radius":2,"circle-stroke-color":"#0084ff","circle-color":"white","circle-stroke-width":1}}}]}),[i]);return(0,p.useEffect)((function(){var e=4e3/3600/1e3,o=4e4/3600/1e3,n=0;return n=requestAnimationFrame((function i(){if(t){var c=Date.now(),p=t.queryRenderedFeatures(void 0,{layers:[k]}).map((function(e){return"MultiLineString"===e.geometry.type?e.geometry.coordinates.map((function(e){return e.slice(1).map((function(t,o){return{startPos:e[o],distance:(0,u.getDistance)(e[o],t),bearing:(0,u.getRhumbLineBearing)({lon:e[o][0],lat:e[o][1]},{lon:t[0],lat:t[1]})}}))})):e.geometry.coordinates.slice(1).map((function(t,o){if("LineString"!==e.geometry.type)throw new Error("");return{startPos:e.geometry.coordinates[o],distance:(0,u.getDistance)(e.geometry.coordinates[o],t),bearing:(0,u.getRhumbLineBearing)({lon:e.geometry.coordinates[o][0],lat:e.geometry.coordinates[o][1]},{lon:t[0],lat:t[1]})}}))})).flat(2).reduce((function(e,t){var o=e.distanceFrom,n=e.lines;return{distanceFrom:o+t.distance,lines:[].concat((0,s.Z)(n),[h(h({},t),{},{distanceFrom:o,distanceTo:o+t.distance})])}}),{distanceFrom:0,lines:[]}).lines,d=p.reduce((function(e,t){return e+t.distance}),0),f=Math.max(1,Math.floor(d/250)),m=t.getZoom(),y=m>=g?2:4,b=p.map((function(t){for(var o=t.distanceFrom%f,n=[],i=[[.25,0],[.25,90],[.25*Math.sqrt(2),135],[0,0],[.25*Math.sqrt(2),225],[.25,270]],a=0;t.distanceFrom+f*a-o<t.distanceTo;){var p=(0,u.computeDestinationPoint)((0,u.computeDestinationPoint)(t.startPos,(f*a-o+e*c)%t.distance,t.bearing),(Math.sin(a+1)+3.2)*y,t.bearing+90*(a%2?1:-1)),d=(0,u.computeDestinationPoint)((0,u.computeDestinationPoint)(t.startPos,(f*a-o+e*(1e13-c))%t.distance,t.bearing),(Math.sin(a)+3.3)*y,t.bearing-90*(a%2?1:-1));try{n.push.apply(n,(0,s.Z)([p,d].map((function(e,o){if(m<g)return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[e.longitude,e.latitude]}};var n=i.map((function(t){var o=(0,r.Z)(t,2),n=o[0],i=o[1];return(0,u.computeDestinationPoint)(e,n*y,i)})).map((function(e){return[e.longitude,e.latitude]}));return(0,l.QFx)((0,l.yue)([[].concat((0,s.Z)(n),[n[0]])]),t.bearing+(o%2?180:0))}))))}catch(h){h instanceof Error&&console.log(h.message)}a+=1}return{peopleList:n,shadowList:[]}}));a({type:"FeatureCollection",features:b.flatMap((function(e){return e.peopleList}))}),x({type:"FeatureCollection",features:b.flatMap((function(e){return e.shadowList}))});var w=20*f,P=p.map((function(e){for(var t=e.distanceFrom%w,n=[],i=[[.5,0],[.5,90],[1,150],[.5,180],[1,210],[.5,270]],a=0;e.distanceFrom+w*a-t<e.distanceTo;){var p=(0,u.computeDestinationPoint)((0,u.computeDestinationPoint)(e.startPos,(w*a-t+o*c)%e.distance,e.bearing),.75*y,e.bearing-90),d=(0,u.computeDestinationPoint)((0,u.computeDestinationPoint)(e.startPos,(w*a-t+o*(1e13-c))%e.distance,e.bearing),.75*y,e.bearing+90);try{n.push.apply(n,(0,s.Z)([p,d].map((function(t,o){if(m<g)return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[t.longitude,t.latitude]}};var n=i.map((function(e){var o=(0,r.Z)(e,2),n=o[0],i=o[1];return(0,u.computeDestinationPoint)(t,n*y,i)})).map((function(e){return[e.longitude,e.latitude]}));return(0,l.QFx)((0,l.yue)([[].concat((0,s.Z)(n),[n[0]])]),e.bearing+(o%2?180:0))}))))}catch(f){f instanceof Error&&console.log(f.message)}a+=1}return{carsList:n,shadowList:[]}}));j({type:"FeatureCollection",features:P.flatMap((function(e){return e.carsList}))}),_({type:"FeatureCollection",features:P.flatMap((function(e){return e.shadowList}))}),n=requestAnimationFrame(i)}})),function(){cancelAnimationFrame(n)}}),[t]),(0,f.jsx)(c.Z,{initialViewState:F,controller:!0,width:"100%",height:"100%",onViewStateChange:function(e){return z(e.viewState)},children:(0,f.jsxs)(d.ZP,h(h({},F),{},{mapStyle:"mapbox://styles/mapbox/streets-v10",width:"100%",height:"100%",mapboxApiAccessToken:"pk.eyJ1Ijoic29sdWZhIiwiYSI6ImNreHc4ZDFoazhwb3Iydm11Nm1pNDhjZHUifQ.xbD9zzpipgotzFP0-PXnSQ",onLoad:function(e){return o(e.target)},children:[D.map((function(e){return(0,f.jsx)(d.mh,h({},e),e.id)})),O.map((function(e){var t=e.id,o=e.source,n=e.layer;return(0,f.jsx)(d.Hw,h(h({id:"".concat(t,"-source")},o),{},{children:(0,f.jsx)(d.mh,h({id:t},n))}),t)}))]}))})},x=i.ZP.i.withConfig({displayName:"Logo__StyledChevronDoubleLeft",componentId:"sc-4jz4df-0"})(["&{position:relative;box-sizing:border-box;display:inline-block;width:22px;height:22px;transform:translate(-15%,-50%) scale(4.5);}&::after,&::before{position:absolute;top:7px;left:6px;box-sizing:border-box;display:block;width:8px;height:8px;content:'';border-bottom:2px solid;border-left:2px solid;transform:rotate(45deg);}&::after{left:11px;}"]),b=i.ZP.i.withConfig({displayName:"Logo__StyledChevronDoubleRight",componentId:"sc-4jz4df-1"})(["&{position:relative;box-sizing:border-box;display:inline-block;width:22px;height:22px;transform:translate(20%,-50%) scale(4.5);}&::after,&::before{position:absolute;top:7px;right:6px;box-sizing:border-box;display:block;width:8px;height:8px;content:'';border-top:2px solid;border-right:2px solid;transform:rotate(45deg);}&::after{right:11px;}"]),w=i.ZP.span.withConfig({displayName:"Logo__BoldText",componentId:"sc-4jz4df-2"})(["font-weight:bold;"]),j=i.ZP.span.withConfig({displayName:"Logo__LargeText",componentId:"sc-4jz4df-3"})(["font-size:120%;color:#06c;"]),P=function(){return(0,f.jsxs)(w,{children:[(0,f.jsx)(x,{})," CHE",(0,f.jsx)(j,{children:"V"}),"RON ",(0,f.jsx)(b,{})]})},v=i.ZP.main.withConfig({displayName:"TextsArea__Texts",componentId:"sc-15upua-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 0 16px;"]),_=i.ZP.div.withConfig({displayName:"TextsArea__Title",componentId:"sc-15upua-1"})(["font-size:4rem;line-height:1.15;transform:scale(1.5);"]),C=i.ZP.p.withConfig({displayName:"TextsArea__Description",componentId:"sc-15upua-2"})(["font-size:2.5rem;font-weight:bold;line-height:1.5;text-align:center;"]),F=function(){return(0,f.jsxs)(v,{children:[(0,f.jsx)(_,{children:(0,f.jsx)(P,{})}),(0,f.jsx)(C,{children:"\u4eba\u6d41\u30c7\u30fc\u30bf\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0"})]})},z=i.ZP.div.withConfig({displayName:"pages__Container",componentId:"sc-m21y1v-0"})(["display:flex;flex-direction:column;height:100vh;background:center/cover url('images/background.png');"]),D=i.ZP.div.withConfig({displayName:"pages__MainContainer",componentId:"sc-m21y1v-1"})(["position:relative;flex:1;"]),k=function(){return(0,f.jsxs)(z,{onContextMenu:function(e){return e.preventDefault()},children:[(0,f.jsxs)(n.default,{children:[(0,f.jsx)("title",{children:"<< CHEVRON >> | People Flow OpenData Platform"}),(0,f.jsx)("meta",{name:"description",content:"<< CHEVRON >> | People Flow OpenData Platform"}),(0,f.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,f.jsx)(F,{}),(0,f.jsx)(D,{children:(0,f.jsx)(y,{})})]})}},5301:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return o(6665)}])},9521:function(){},9214:function(){}},function(e){e.O(0,[774,715,634,610,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);